"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8319],{2224:function(Re,le,e){var ie=e(90228),Y=e.n(ie),de=e(87999),ue=e.n(de),ve=e(48305),Z=e.n(ve),F=e(42400),y=e(66830),V=e(51009),_e=e(62057),ce=e(43718),X=e(70576),w=e(75271),fe=e(75122),z=e(81399),D=e(52676),q={color:"#42526e",fontSize:16,lineHeight:"16px",fontWeight:"bold",marginBottom:8};function p(_){var t=_.job,ee=_.role,s=ee===void 0?"pm":ee,te=(0,X.useIntl)(),O=te.formatMessage,S=(0,w.useState)(null),B=Z()(S,2),T=B[0],ae=B[1],$=(0,w.useState)(!1),C=Z()($,2),N=C[0],oe=C[1],c=t||{},re=c.id,x=c.jobType,A=T||{},se=A.totalWorkerNum,me=se===void 0?0:se,j=A.avgRecordByWorker,E=j===void 0?0:j,b=A.nrPassRatio,I=b===void 0?0:b,f=A.totalWorkHour,l=f===void 0?0:f,m=A.avgWorkHourByWorker,K=m===void 0?0:m,i=A.avgNumByWorker,L=i===void 0?0:i,G=[{key:"total-num",title:O({id:"workflow.detail.job.statistic.total-num"}),value:me},{key:"average-num",title:O({id:"workflow.detail.job.statistic.average-".concat(x==null?void 0:x.toLowerCase(),"-num")}),value:(+E||+L||0).toFixed(3)},{key:"pass-rate",title:O({id:"workflow.detail.job.statistic.nr-pass-rate"}),value:(0,z.gt)(I)},{key:"total-cost",title:O({id:"workflow.detail.job.statistic.total-cost"}),value:(l||0).toFixed(3)},{key:"average-cost",title:O({id:"workflow.detail.job.statistic.average-cost"}),value:(+K||0).toFixed(3)}],R=function(){var h=ue()(Y()().mark(function U(){var M;return Y()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,oe(!0),a.next=6,(0,fe._i)(re,x,s);case 6:M=a.sent,ae(M.data),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(2),F.ZP.error((0,z.R$)(a.t0));case 13:return a.prev=13,oe(!1),a.finish(13);case 16:case"end":return a.stop()}},U,null,[[2,10,13,16]])}));return function(){return h.apply(this,arguments)}}();return(0,w.useEffect)(function(){R()},[t]),(0,w.useEffect)(function(){},[t]),(0,D.jsxs)(y.Z,{spinning:N,children:[(0,D.jsx)(V.Z,{title:(0,D.jsx)("span",{style:q,children:O({id:"workflow.detail.job.statistic.average-".concat(x.toLowerCase(),"-effect")})}),value:(Number.parseFloat(T==null?void 0:T.avgEfficiency.toString())||0).toFixed(3),style:{marginBottom:40},valueStyle:{color:"#42526e",fontSize:24,lineHeight:"24px"}}),(0,D.jsx)(_e.Z,{gutter:[24,24],children:G.map(function(h){return(0,D.jsx)(ce.Z,{span:8,children:(0,D.jsx)(V.Z,{title:(0,D.jsx)("span",{style:{color:"#7a869a",fontSize:14,lineHeight:"14px",marginBottom:8},children:h.title}),value:h.value,valueStyle:{color:"#3e5270",fontSize:20,lineHeight:"20px",fontWeight:"bold"}})},h.key)})})]})}le.Z=p},59242:function(Re,le,e){e.d(le,{Z:function(){return me}});var ie=e(90228),Y=e.n(ie),de=e(87999),ue=e.n(de),ve=e(15558),Z=e.n(ve),F=e(48305),y=e.n(F),V=e(42400),_e=e(51009),ce=e(93579),X=e(9891),w=e(61234),fe=e(21103),z=e(70576),D=e(11333),q=e.n(D),p=e(75271),_=e(45269),t=e(52676),ee=[_.gp.DAY7,_.gp.DAY30,_.gp.DAYNOW];function s(j){var E=j.onDateChange,b=j.dateTypes,I=b===void 0?ee:b,f=j.defaultType,l=f===void 0?_.gp.DAY7:f,m=(0,z.useIntl)(),K=m.formatMessage,i=(0,p.useState)(l),L=y()(i,2),G=L[0],R=L[1],h=(0,p.useState)([]),U=y()(h,2),M=U[0],P=U[1],a=function(r){var n=r?_.gp.DATERANGE:I[0];P(r),R(n),E(n,r)},he=function(r){R(r.target.value),P([]),E(r.target.value,[])};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.ZP.Group,{value:G,size:"small",onChange:he,children:I.map(function(W){return(0,t.jsx)(w.ZP.Button,{value:W,children:K({id:"common.date.filter.".concat(W)})},W)})}),(0,t.jsx)(fe.Z.RangePicker,{value:M,onChange:a,style:{width:240},className:"margin-left-5",disabledDate:function(r){return r&&r>q()().endOf("day")}})]})}var te=e(25670),O=e(36343),S=e(3011),B=e(40720),T=e(97693),ae=e(91496),$=e(99970),C=e(27668),N=e(30964),oe=e(45831),c=e(23563),re=e(79266),x=e(75122),A=e(81399);function se(j){var E=j.job,b=j.role,I=b===void 0?"pm":b,f=(0,z.useIntl)(),l=f.formatMessage,m=(0,p.useState)(null),K=y()(m,2),i=K[0],L=K[1],G=(0,p.useState)(_.gp.THIS_WEEK),R=y()(G,2),h=R[0],U=R[1],M=(0,p.useState)([]),P=y()(M,2),a=P[0],he=P[1],W=(0,p.useState)("0"),r=y()(W,2),n=r[0],J=r[1],ge=(0,p.useState)(!1),d=y()(ge,2),Ee=d[0],pe=d[1],be=E||{},ye=be.jobType,Me=ye===void 0?re.O4.LABEL:ye,je=Me===re.O4.QA,ne=(i==null?void 0:i.data)||[],Pe=[{title:l({id:"workflow.detail.job.statistic.qaNum"}),value:(i==null?void 0:i.totalSampleNum)||0},{title:l({id:"workflow.detail.job.statistic.passNum"}),value:(i==null?void 0:i.totalPassNum)||0},{title:l({id:"workflow.detail.job.statistic.rejectNum"}),value:(i==null?void 0:i.totalRejectNum)||0}],De=[{label:l({id:je?"workflow.detail.job.statistic.tabs.qa":"workflow.detail.job.statistic.tabs.rows"}),value:"0",dataKey:je?"":"labelRecords"}].concat(Z()(je?[{label:l({id:"workflow.detail.job.statistic.tabs.qa-statistics"}),value:"3",dataKey:"statistics"}]:[]),[{label:l({id:"workflow.detail.job.statistic.tabs.average-cost"}),value:"1",dataKey:"avgWorkHourByWorker"},{label:l({id:"workflow.detail.job.statistic.tabs.num"}),value:"2",dataKey:"workerNum"}]),Oe=function(v){var o=v.payload,g=v.label;if(!(o!=null&&o.length))return null;var Q=o.reduce(function(H,u){return H.value+u.value});return(0,t.jsxs)("div",{style:{background:"#fff",opacity:.7,border:"1px solid #f5f7f9",padding:8},children:[(0,c.tZ)(g,"YYYY-MM-DD"),o.map(function(H){return(0,t.jsxs)("p",{style:{margin:0,color:"#42526e"},children:[l({id:"workflow.detail.job.statistic.".concat(H.dataKey)}),":",(0,t.jsx)("span",{style:{marginLeft:4},children:H.value})]})}),(0,t.jsxs)("p",{style:{margin:0,color:"#42526e"},children:[l({id:"workflow.detail.job.statistic.qaNum"}),":",(0,t.jsx)("span",{style:{marginLeft:4},children:Q})]})]})},Te=function(v){var o=v.payload,g=v.label;return o!=null&&o.length?(0,t.jsxs)("div",{style:{background:"#fff",opacity:.7,border:"1px solid #f5f7f9",padding:8},children:[(0,c.tZ)(g,"YYYY-MM-DD"),o.map(function(Q){var H;return(0,t.jsxs)("p",{style:{margin:0,color:"#42526e"},children:[(H=De.find(function(u){return u.value===n}))===null||H===void 0?void 0:H.label,":",(0,t.jsx)("span",{style:{marginLeft:4},children:Q.value.toFixed(2)})]},Q.dataKey)})]}):null},Ce=function(){var k=ue()(Y()().mark(function v(){var o,g,Q;return Y()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(E){u.next=2;break}return u.abrupt("return");case 2:return u.prev=2,pe(!0),u.next=6,(0,x.xd)({jobId:E.id,histogramType:h,dateStart:a==null||(o=a[0])===null||o===void 0||(o=o.startOf("day"))===null||o===void 0?void 0:o.format("YYYY-MM-DD HH:mm:ss"),dateTo:a==null||(g=a[1])===null||g===void 0||(g=g.endOf("day"))===null||g===void 0?void 0:g.format("YYYY-MM-DD HH:mm:ss"),jobType:Me,role:I});case 6:Q=u.sent,L(Q.data),u.next=13;break;case 10:u.prev=10,u.t0=u.catch(2),V.ZP.error((0,A.R$)(u.t0));case 13:return u.prev=13,pe(!1),u.finish(13);case 16:case"end":return u.stop()}},v,null,[[2,10,13,16]])}));return function(){return k.apply(this,arguments)}}(),xe=function(){var v;return n==="0"&&je?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{float:"left",width:128,marginRight:32},children:Pe.map(function(o){return(0,t.jsx)(_e.Z,{title:(0,t.jsx)("span",{style:{color:"#7a869a",lineHeight:"14px"},children:o.title}),value:o.value,style:{background:"#F6F7F9",borderRadius:8,marginBottom:20,padding:"20px 12px"},valueStyle:{color:"#3e5270",fontSize:20,lineHeight:"20px"}},o.title)})}),(0,t.jsx)("div",{style:{overflow:"hidden",height:"100%"},children:(0,t.jsx)(te.h,{width:"100%",height:"100%",children:(0,t.jsxs)(O.v,{width:500,height:300,data:ne,maxBarSize:50,margin:{top:20,right:30,left:20,bottom:5},children:[(0,t.jsx)(S.q,{strokeDasharray:"3 3"}),(0,t.jsx)(B.K,{dataKey:"collectDate",hide:ne.length===0,tickFormatter:function(g){return(0,c.tZ)(g,"YYYY-MM-DD")}}),(0,t.jsx)(T.B,{hide:ne.length===0}),(0,t.jsx)(ae.u,{content:Oe}),(0,t.jsx)($.$,{dataKey:"passNum",stackId:"a",fill:"#01b97f"}),(0,t.jsx)($.$,{dataKey:"rejectNum",stackId:"a",fill:"#f56c6c"})]})})})]}):n==="3"?(0,t.jsx)("div",{children:l({id:"common.empty.with-label"},{label:l({id:"workflow.detail.job.statistic.tabs.qa-statistics"})})}):(0,t.jsx)(te.h,{children:(0,t.jsxs)(C.w,{width:260,height:150,style:{marginTop:12},data:ne,margin:{top:5,right:30,left:45,bottom:5},children:[(0,t.jsx)(S.q,{strokeDasharray:"3 3"}),(0,t.jsx)(B.K,{hide:ne.length===0,dataKey:"collectDate",tickFormatter:function(g){return(0,c.tZ)(g,"YYYY-MM-DD")},padding:{left:40,right:40}}),(0,t.jsx)(T.B,{hide:ne.length===0,allowDecimals:!1,width:1}),(0,t.jsx)(ae.u,{wrapperStyle:{width:"auto",backgroundColor:"#fff",padding:"4px 8px"},allowEscapeViewBox:{x:!1,y:!1},content:Te},"tooltip-day"),(0,t.jsx)(N.D,{wrapperStyle:{bottom:0},align:"left"}),(0,t.jsx)(oe.x,{name:(v=De.find(function(o){return o.value===n}))===null||v===void 0?void 0:v.label,type:"monotone",dataKey:De.find(function(o){return o.value===n}).dataKey,stroke:"#01B97F",strokeWidth:2})]})})};return(0,p.useEffect)(function(){Ce()},[E,h,a]),(0,t.jsx)(ce.Z,{title:(0,t.jsx)(X.Z,{onChange:function(v){J(v)},activeKey:n,style:{width:"fit-content"},children:De.map(function(k){return(0,t.jsx)(X.Z.TabPane,{tab:k.label},k.value)})}),extra:(0,t.jsx)(s,{defaultType:h,onDateChange:function(v,o){U(v),he(o)},dateTypes:[_.gp.THIS_WEEK,_.gp.THIS_MONTH,_.gp.THIS_YEAR,_.gp.SO_FAR]}),loading:Ee,children:(0,t.jsx)("div",{style:{width:"100%",height:300},children:xe()})})}var me=se},30996:function(Re,le,e){var ie=e(90228),Y=e.n(ie),de=e(87999),ue=e.n(de),ve=e(48305),Z=e.n(ve),F=e(75271),y=e(70576),V=e(42400),_e=e(66830),ce=e(51009),X=e(25670),w=e(48340),fe=e(17201),z=e(12485),D=e(35288),q=e(81399),p=e(79266),_=e(75122),t=e(48111),ee=e(75903),s=e(52676),te={color:"#42526e",fontSize:16,lineHeight:"16px",fontWeight:"bold",marginBottom:8};function O(S){var B=S.job,T=S.role,ae=T===void 0?"pm":T,$=S.projectId,C=S.flowId,N=(0,y.useDispatch)(),oe=(0,y.useIntl)(),c=oe.formatMessage,re=(0,F.useState)(),x=Z()(re,2),A=x[0],se=x[1],me=(0,F.useState)(!1),j=Z()(me,2),E=j[0],b=j[1],I=B||{},f=I.id,l=I.jobType,m=A||{},K=m.canGetRows,i=m.haltRows,L=m.needReWorkRows,G=m.processedRows,R=m.totalRows,h=m.unCommittedRows,U=m.finishedRows,M=G||U||0,P=function(n){!$||!C||(N({type:"dataCenter/updateProject",payload:{projectId:$}}),N({type:"dataCenter/updateFilters",payload:n}),ee.m8.push({pathname:"/projects/".concat($,"/data-center")}))},a=[{key:"acquirable",title:c({id:"project.detail.data-center.data-state.acquirable"}),render:(0,s.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return P({state:l===p.O4.QA?[t.an.ACQUIRABLE,t.an.TO_REWORK]:[t.an.ACQUIRABLE],flowJob:[[C,f]]})},children:K}),value:K,color:"#7a869a"},{key:"failed",title:c({id:"project.detail.data-center.data-state.to_rework"}),render:(0,s.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return P({state:[t.an.TO_REWORK],flowJob:[[C,f]]})},children:L}),value:L,color:"#f56c6c"},{key:"working",title:c({id:"project.detail.data-center.data-state.working"}),render:(0,s.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return P({state:[t.an.WORKING],flowJob:[[C,f]]})},children:h}),value:h,color:"#fdb314"},{key:"halted",title:c({id:"project.detail.data-center.data-state.halted"}),render:(0,s.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return P({state:[t.an.HALTED],flowJob:[[C,f]]})},children:i}),value:i,color:"#6b5be5"},{key:"passed",title:c({id:"project.detail.data-center.data-state.completed"}),render:(0,s.jsx)("span",{children:M}),value:M,color:"#01b97f"}],he=(0,q.gt)(R&&M/R);l===p.O4.QA&&a.splice(1,1);var W=function(){var r=ue()(Y()().mark(function n(){var J;return Y()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(B){d.next=2;break}return d.abrupt("return");case 2:return d.prev=2,b(!0),d.next=6,(0,_.$V)(f,l,ae);case 6:J=d.sent,se(J.data),N({type:"flowCreation/updateProgressInfo",payload:{jobType:l,jobId:f,progress:J.data}}),d.next=14;break;case 11:d.prev=11,d.t0=d.catch(2),V.ZP.error((0,q.R$)(d.t0));case 14:return d.prev=14,b(!1),d.finish(14);case 17:case"end":return d.stop()}},n,null,[[2,11,14,17]])}));return function(){return r.apply(this,arguments)}}();return(0,F.useEffect)(function(){W()},[B]),(0,s.jsxs)(_e.Z,{spinning:E,children:[(0,s.jsx)(ce.Z,{title:(0,s.jsx)("span",{style:te,children:c({id:"workflow.detail.job.statistic.progress"})}),value:he,suffix:(0,s.jsx)("span",{style:{marginLeft:4,fontSize:14,fontWeight:"normal"},children:c({id:"workflow.detail.job.statistic.progress.remain"},{num:R-M})}),style:{marginBottom:24},valueStyle:{color:"#42526e",fontSize:24,lineHeight:"24px"}}),(0,s.jsx)("div",{style:{width:150,height:150,float:"left",marginRight:40},children:(0,s.jsx)(X.h,{children:(0,s.jsx)(w.u,{children:(0,s.jsx)(fe.b,{dataKey:"value",data:a,innerRadius:40,outerRadius:72,activeShape:function(n){var J=n.cx,ge=n.cy,d=n.innerRadius,Ee=n.outerRadius,pe=n.startAngle,be=n.endAngle,ye=n.fill;return(0,s.jsx)("g",{children:(0,s.jsx)(z.L,{cx:J,cy:ge,innerRadius:d,outerRadius:Ee,startAngle:pe,endAngle:be,fill:ye})})},activeIndex:1,children:a.map(function(r){return(0,s.jsx)(D.b,{fill:r.color},r.key)})})})})}),(0,s.jsx)("div",{style:{paddingTop:16,display:"grid",gridGap:20,gridAutoFlow:"column",gridTemplateRows:"repeat(3, 24px)"},children:a.map(function(r){return(0,s.jsxs)("p",{style:{color:"#7a869a",position:"relative"},children:[(0,s.jsx)("i",{style:{position:"absolute",top:6,left:-16,width:8,height:8,borderRadius:"50%",background:r.color}}),r.title," ",(0,s.jsx)("span",{style:{color:"#42526e"},children:r.render})]},r.key)})})]})}le.Z=O}}]);
