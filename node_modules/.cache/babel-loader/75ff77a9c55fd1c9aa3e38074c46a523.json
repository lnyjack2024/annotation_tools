{"ast":null,"code":"import React,{useRef,useState}from'react';import{observer}from'mobx-react';import{Collapse}from'antd';import{CaretRightOutlined}from'@ant-design/icons';import cx from'classnames';import Modal from'src/components/common/modal/Modal';import localMessage from'../../locale';import{Warning,Sync}from'../../../common/icons';import store from'../../store/RootStore';import{ReviewMode,ValidationType}from'../../types';import ValidationPanelReviews from'./validationPanelReviews';import ValidationItem from'./ValidationItem';const ValidationPanel=observer(()=>{const[activeKey,setActiveKey]=useState([ValidationType.SCRIPT]);const[isModalVisibile,setIsModalVisibile]=useState(false);const[deleteItemsAmount,setDeleteItemsAmount]=useState(null);const ValidationPanelReviewsRef=useRef(null);const titles={[ValidationType.SCRIPT]:localMessage('VALIDATION_TYPE_SCRIPT')};const showConfirmModal=amount=>{setIsModalVisibile(true);setDeleteItemsAmount(amount);};const handleDeleteOk=()=>{if(ValidationPanelReviewsRef&&ValidationPanelReviewsRef.current){ValidationPanelReviewsRef.current.deleteItemsBySelected();}setIsModalVisibile(false);};const handleDeleteCancel=()=>{setIsModalVisibile(false);};const renderWarnings=type=>{const warnings=store.validation.warnings.filter(w=>w.type===type);if(warnings.length<=0){return null;}return/*#__PURE__*/React.createElement(Collapse.Panel,{key:type,header:titles[type],extra:/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:\"result-count\"},warnings.length))},warnings.map(warning=>/*#__PURE__*/React.createElement(ValidationItem,{key:warning.id,warning:warning})));};return/*#__PURE__*/React.createElement(\"div\",{className:\"scroller\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-validation-header\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Warning,null),/*#__PURE__*/React.createElement(\"span\",{style:{paddingLeft:8}},localMessage('VALIDATION_TITLE',{values:{count:store.validation.warningCount}}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:cx('icon-button',{spinning:store.validation.checking}),onClick:store.validation.sync},/*#__PURE__*/React.createElement(Sync,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-validation-content\"},/*#__PURE__*/React.createElement(Collapse,{activeKey:activeKey,onChange:activeKeys=>setActiveKey(activeKeys),ghost:true,expandIcon:_ref=>{let{isActive}=_ref;return/*#__PURE__*/React.createElement(CaretRightOutlined,{style:{...(isActive?{top:11,transform:'rotate(90deg)'}:{color:'rgba(255, 255, 255, 0.6)'})}});}},store.review.unPassedCount>0&&/*#__PURE__*/React.createElement(Collapse.Panel,{forceRender:true,key:\"reviews\",className:\"collapse-panel-reviews\",header:/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-header-customer-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-header-customer\"},localMessage('VALIDATION_REVIEWS'),/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex'}},/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-title-extra\"},/*#__PURE__*/React.createElement(\"span\",{className:\"result-count\"},store.review.unPassedCount)))))},/*#__PURE__*/React.createElement(ValidationPanelReviews,{ref:ValidationPanelReviewsRef,showConfirmModal:showConfirmModal})),Object.values(ValidationType).map(type=>renderWarnings(type)))),store.config.reviewMode===ReviewMode.REVIEW&&store.reviewable&&/*#__PURE__*/React.createElement(Modal,{title:localMessage('VALIDATION_REVIEW_DELETE_TITLE'),maskClosable:false,visible:isModalVisibile,className:\"reviews-delete-modal\",draggable:false,onClose:handleDeleteCancel},/*#__PURE__*/React.createElement(\"p\",{style:{padding:12}},/*#__PURE__*/React.createElement(\"span\",null,localMessage('VALIDATION_REVIEW_DELETE_SELECTED_ITEMS'),localMessage('VALIDATION_REVIEW_DELETE_AMOUNT',{values:{deleteItemsAmount}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"review-action\"},/*#__PURE__*/React.createElement(\"div\",{className:\"review-btn cancel\",onClick:handleDeleteCancel},localMessage('cancel')),/*#__PURE__*/React.createElement(\"div\",{className:\"review-btn confirm\",onClick:handleDeleteOk},localMessage('confirm')))));});export default ValidationPanel;","map":{"version":3,"names":["React","useRef","useState","observer","Collapse","CaretRightOutlined","cx","Modal","localMessage","Warning","Sync","store","ReviewMode","ValidationType","ValidationPanelReviews","ValidationItem","ValidationPanel","activeKey","setActiveKey","SCRIPT","isModalVisibile","setIsModalVisibile","deleteItemsAmount","setDeleteItemsAmount","ValidationPanelReviewsRef","titles","showConfirmModal","amount","handleDeleteOk","current","deleteItemsBySelected","handleDeleteCancel","renderWarnings","type","warnings","validation","filter","w","length","createElement","Panel","key","header","extra","className","map","warning","id","style","paddingLeft","values","count","warningCount","spinning","checking","onClick","sync","onChange","activeKeys","ghost","expandIcon","_ref","isActive","top","transform","color","review","unPassedCount","forceRender","display","ref","Object","config","reviewMode","REVIEW","reviewable","title","maskClosable","visible","draggable","onClose","padding"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/editable-text/components/validationPanel/index.tsx"],"sourcesContent":["import React, { useRef, useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Collapse } from 'antd';\nimport { CaretRightOutlined } from '@ant-design/icons';\nimport cx from 'classnames';\nimport Modal from 'src/components/common/modal/Modal';\nimport localMessage from '../../locale';\nimport { Warning, Sync } from '../../../common/icons';\nimport store from '../../store/RootStore';\nimport { ReviewMode, ValidationType } from '../../types';\nimport ValidationPanelReviews, { ValidationPanelReviewsHandle } from './validationPanelReviews';\nimport ValidationItem from './ValidationItem';\n\nconst ValidationPanel = observer(() => {\n  const [activeKey, setActiveKey] = useState<ValidationType | ValidationType[]>([ValidationType.SCRIPT]);\n  const [isModalVisibile, setIsModalVisibile] = useState(false);\n  const [deleteItemsAmount, setDeleteItemsAmount] = useState<number | null>(null);\n\n  const ValidationPanelReviewsRef = useRef<ValidationPanelReviewsHandle>(null);\n\n  const titles = {\n    [ValidationType.SCRIPT]: localMessage('VALIDATION_TYPE_SCRIPT'),\n  };\n\n  const showConfirmModal = (amount: number) => {\n    setIsModalVisibile(true);\n    setDeleteItemsAmount(amount);\n  };\n\n  const handleDeleteOk = () => {\n    if (ValidationPanelReviewsRef && ValidationPanelReviewsRef.current) {\n      ValidationPanelReviewsRef.current.deleteItemsBySelected();\n    }\n    setIsModalVisibile(false);\n  };\n\n  const handleDeleteCancel = () => {\n    setIsModalVisibile(false);\n  };\n\n  const renderWarnings = (type: ValidationType) => {\n    const warnings = store.validation.warnings.filter((w) => w.type === type);\n    if (warnings.length <= 0) {\n      return null;\n    }\n    return (\n      <Collapse.Panel\n        key={type}\n        header={titles[type]}\n        extra={(\n          <div>\n            <span className=\"result-count\">\n              {warnings.length}\n            </span>\n          </div>\n        )}\n      >\n        {warnings.map((warning) => <ValidationItem key={warning.id} warning={warning} />)}\n      </Collapse.Panel>\n    );\n  };\n  return (\n    <div className=\"scroller\">\n      <div className=\"sidebar-validation-header\">\n        <div>\n          <Warning />\n          <span style={{ paddingLeft: 8 }}>\n            {localMessage('VALIDATION_TITLE', { values: { count: store.validation.warningCount } })}\n          </span>\n        </div>\n        <div>\n          <div\n            className={cx('icon-button', {\n              spinning: store.validation.checking,\n            })}\n            onClick={store.validation.sync}\n          >\n            <Sync />\n          </div>\n        </div>\n      </div>\n      <div className=\"sidebar-validation-content\">\n        <Collapse\n          activeKey={activeKey}\n          onChange={(activeKeys) => setActiveKey(activeKeys as (ValidationType | ValidationType[]))}\n          ghost\n          expandIcon={({ isActive }) => (\n            <CaretRightOutlined\n              style={{\n                ...isActive ? {\n                  top: 11,\n                  transform: 'rotate(90deg)',\n                } : {\n                  color: 'rgba(255, 255, 255, 0.6)',\n                },\n              }}\n            />\n          )}\n        >\n          {store.review.unPassedCount > 0 && (\n            <Collapse.Panel\n              forceRender\n              key=\"reviews\"\n              className=\"collapse-panel-reviews\"\n              header={(\n                <div className=\"collapse-header-customer-wrapper\">\n                  <div\n                    className=\"collapse-header-customer\"\n                  >\n                    {localMessage('VALIDATION_REVIEWS')}\n                    <div style={{ display: 'flex' }}>\n                      <div className=\"collapse-title-extra\">\n                        <span className=\"result-count\">\n                          {store.review.unPassedCount}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            >\n              <ValidationPanelReviews\n                ref={ValidationPanelReviewsRef}\n                showConfirmModal={showConfirmModal}\n              />\n            </Collapse.Panel>\n          )}\n          {Object.values(ValidationType).map((type) => renderWarnings(type))}\n        </Collapse>\n      </div>\n      {store.config.reviewMode === ReviewMode.REVIEW && store.reviewable && (\n        <Modal\n          title={localMessage('VALIDATION_REVIEW_DELETE_TITLE')}\n          maskClosable={false}\n          visible={isModalVisibile}\n          className=\"reviews-delete-modal\"\n          draggable={false}\n          onClose={handleDeleteCancel}\n        >\n          <p style={{ padding: 12 }}>\n            <span>\n              {localMessage('VALIDATION_REVIEW_DELETE_SELECTED_ITEMS')}\n              {localMessage('VALIDATION_REVIEW_DELETE_AMOUNT', { values: { deleteItemsAmount } })}\n            </span>\n          </p>\n\n          <div className=\"review-action\">\n            <div\n              className=\"review-btn cancel\"\n              onClick={handleDeleteCancel}\n            >\n              {localMessage('cancel')}\n            </div>\n            <div\n              className=\"review-btn confirm\"\n              onClick={handleDeleteOk}\n            >\n              {localMessage('confirm')}\n            </div>\n          </div>\n        </Modal>\n      )}\n    </div>\n  );\n});\n\nexport default ValidationPanel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}