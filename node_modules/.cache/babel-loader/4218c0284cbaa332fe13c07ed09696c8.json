{"ast":null,"code":"import _applyDecoratedDescriptor from \"/Users/qzheng/Documents/webroot/annotation_tools/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nvar _class;\nimport { observable, computed, action, makeObservable } from 'mobx';\nlet UndoStore = (_class = class UndoStore {\n  constructor(rootStore) {\n    this.rootStore = void 0;\n    this.savedStatus = [];\n    this.pointer = 0;\n    makeObservable(this, {\n      pointer: observable,\n      undo: action,\n      redo: action,\n      saveStatus: action\n    });\n    this.rootStore = rootStore;\n  }\n  get undoDisabled() {\n    return this.pointer <= 0;\n  }\n  get redoDisabled() {\n    return this.pointer >= this.savedStatus.length;\n  }\n  undo() {\n    if (this.pointer > 0) {\n      this.pointer -= 1;\n      return this.savedStatus[this.pointer];\n    }\n    return null;\n  }\n  redo() {\n    if (this.pointer < this.savedStatus.length) {\n      this.pointer += 1;\n      return this.savedStatus[this.pointer - 1];\n    }\n    return null;\n  }\n  saveStatus(before, after) {\n    this.savedStatus = this.savedStatus.slice(0, this.pointer);\n    this.savedStatus.push({\n      before,\n      after\n    });\n    if (this.savedStatus.length > 30) {\n      this.savedStatus.shift();\n    } else {\n      this.pointer += 1;\n    }\n  }\n}, _applyDecoratedDescriptor(_class.prototype, \"undoDisabled\", [computed], Object.getOwnPropertyDescriptor(_class.prototype, \"undoDisabled\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"redoDisabled\", [computed], Object.getOwnPropertyDescriptor(_class.prototype, \"redoDisabled\"), _class.prototype), _class);\nexport default UndoStore;","map":{"version":3,"names":["observable","computed","action","makeObservable","UndoStore","_class","constructor","rootStore","savedStatus","pointer","undo","redo","saveStatus","undoDisabled","redoDisabled","length","before","after","slice","push","shift","_applyDecoratedDescriptor","prototype","Object","getOwnPropertyDescriptor"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/multi-channel/store/UndoStore.ts"],"sourcesContent":["import { observable, computed, action, makeObservable } from 'mobx';\nimport { RootStoreType } from './RootStore';\nimport { Review, Instance } from '../types';\n\nexport interface StatusItem {\n  before: Status[];\n  after: Status[];\n}\n\nexport type Status =\n  { type: 'review'; status: { [id:string]: Review | undefined; }; } |\n  { type: 'instance'; status: { [id: string]: Instance | null; }; };\n\nclass UndoStore {\n  rootStore: RootStoreType;\n\n  savedStatus: StatusItem[] = [];\n\n  pointer = 0;\n\n  constructor(rootStore: RootStoreType) {\n    makeObservable(this, {\n      pointer: observable,\n      undo: action,\n      redo: action,\n      saveStatus: action\n    });\n    this.rootStore = rootStore;\n  }\n\n  @computed get undoDisabled() {\n    return this.pointer <= 0;\n  }\n\n  @computed get redoDisabled() {\n    return this.pointer >= this.savedStatus.length;\n  }\n\n  undo() {\n    if (this.pointer > 0) {\n      this.pointer -= 1;\n      return this.savedStatus[this.pointer];\n    }\n    return null;\n  }\n\n  redo() {\n    if (this.pointer < this.savedStatus.length) {\n      this.pointer += 1;\n      return this.savedStatus[this.pointer - 1];\n    }\n    return null;\n  }\n\n  saveStatus(before: Status[], after: Status[]) {\n    this.savedStatus = this.savedStatus.slice(0, this.pointer);\n    this.savedStatus.push({ before, after });\n    if (this.savedStatus.length > 30) {\n      this.savedStatus.shift();\n    } else {\n      this.pointer += 1;\n    }\n  }\n}\n\nexport default UndoStore;\n"],"mappings":";;AAAA,SAASA,UAAU,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,cAAc,QAAQ,MAAM;AAAC,IAa9DC,SAAS,IAAAC,MAAA,GAAf,MAAMD,SAAS,CAAC;EAOdE,WAAWA,CAACC,SAAwB,EAAE;IAAA,KANtCA,SAAS;IAAA,KAETC,WAAW,GAAiB,EAAE;IAAA,KAE9BC,OAAO,GAAG,CAAC;IAGTN,cAAc,CAAC,IAAI,EAAE;MACnBM,OAAO,EAAET,UAAU;MACnBU,IAAI,EAAER,MAAM;MACZS,IAAI,EAAET,MAAM;MACZU,UAAU,EAAEV;IACd,CAAC,CAAC;IACF,IAAI,CAACK,SAAS,GAAGA,SAAS;EAC5B;EAEA,IAAcM,YAAYA,CAAA,EAAG;IAC3B,OAAO,IAAI,CAACJ,OAAO,IAAI,CAAC;EAC1B;EAEA,IAAcK,YAAYA,CAAA,EAAG;IAC3B,OAAO,IAAI,CAACL,OAAO,IAAI,IAAI,CAACD,WAAW,CAACO,MAAM;EAChD;EAEAL,IAAIA,CAAA,EAAG;IACL,IAAI,IAAI,CAACD,OAAO,GAAG,CAAC,EAAE;MACpB,IAAI,CAACA,OAAO,IAAI,CAAC;MACjB,OAAO,IAAI,CAACD,WAAW,CAAC,IAAI,CAACC,OAAO,CAAC;IACvC;IACA,OAAO,IAAI;EACb;EAEAE,IAAIA,CAAA,EAAG;IACL,IAAI,IAAI,CAACF,OAAO,GAAG,IAAI,CAACD,WAAW,CAACO,MAAM,EAAE;MAC1C,IAAI,CAACN,OAAO,IAAI,CAAC;MACjB,OAAO,IAAI,CAACD,WAAW,CAAC,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC;IAC3C;IACA,OAAO,IAAI;EACb;EAEAG,UAAUA,CAACI,MAAgB,EAAEC,KAAe,EAAE;IAC5C,IAAI,CAACT,WAAW,GAAG,IAAI,CAACA,WAAW,CAACU,KAAK,CAAC,CAAC,EAAE,IAAI,CAACT,OAAO,CAAC;IAC1D,IAAI,CAACD,WAAW,CAACW,IAAI,CAAC;MAAEH,MAAM;MAAEC;IAAM,CAAC,CAAC;IACxC,IAAI,IAAI,CAACT,WAAW,CAACO,MAAM,GAAG,EAAE,EAAE;MAChC,IAAI,CAACP,WAAW,CAACY,KAAK,CAAC,CAAC;IAC1B,CAAC,MAAM;MACL,IAAI,CAACX,OAAO,IAAI,CAAC;IACnB;EACF;AACF,CAAC,EAAAY,yBAAA,CAAAhB,MAAA,CAAAiB,SAAA,mBAjCErB,QAAQ,GAAAsB,MAAA,CAAAC,wBAAA,CAAAnB,MAAA,CAAAiB,SAAA,mBAAAjB,MAAA,CAAAiB,SAAA,GAAAD,yBAAA,CAAAhB,MAAA,CAAAiB,SAAA,mBAIRrB,QAAQ,GAAAsB,MAAA,CAAAC,wBAAA,CAAAnB,MAAA,CAAAiB,SAAA,mBAAAjB,MAAA,CAAAiB,SAAA,GAAAjB,MAAA;AA+BX,eAAeD,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module"}