{"ast":null,"code":"import{setStyle}from'../../../../utils';export default class ScrollControl{constructor(_ref){let{container,height,barColor,trackStyle,displayRange,onScroll}=_ref;this.container=void 0;this.displayRange={start:0,end:1};this.scrollTrack=void 0;this.trackStyle=void 0;this.scrollBar=void 0;this.params=void 0;this.isDragging=false;this.startX=0;this.stop=void 0;this.onScroll=void 0;this.mouseDown=e=>{this.isDragging=true;this.startX=e.clientX;};this.mouseLeave=()=>{if(this.isDragging){this.isDragging=false;}};this.mouseMove=e=>{const{start,end}=this.displayRange;const precent=end-start;if(this.isDragging&&precent<1){const movePrecent=(e.clientX-this.startX)*(1-precent)/(this.scrollTrack.clientWidth-this.scrollBar.clientWidth);let left=movePrecent+start;if(left<0){left=0;}else if(left+precent>1){left=1-precent;}this.displayRange={start:left,end:left+precent};this.startX=e.clientX;this.onScroll(left,left+precent);this.resize();}};this.container=container;this.params={height:height||20,barColor:barColor||'#777B82',trackColor:(trackStyle===null||trackStyle===void 0?void 0:trackStyle.color)||'#eee'};if(displayRange){this.displayRange=displayRange;}this.trackStyle=trackStyle;this.scrollTrack=document.createElement('div');this.scrollBar=document.createElement('div');this.onScroll=onScroll;this.init();}init(){const{height,barColor,trackColor}=this.params;this.scrollTrack.className='wave-scroll';setStyle(this.scrollTrack,{position:'relative',width:'100%',height:\"\".concat(height,\"px\"),padding:'2px 0',backgroundColor:trackColor,borderRadius:'2px',overflow:'hidden',...this.trackStyle});this.scrollBar.className='wave-scroll-bar';setStyle(this.scrollBar,{position:'absolute',width:'100%',minWidth:'20px',height:\"\".concat(height-4,\"px\"),backgroundColor:barColor,borderRadius:'2px',cursor:'pointer'});this.scrollTrack.appendChild(this.scrollBar);this.container.appendChild(this.scrollTrack);this.listen();this.resize();}resize(){if(this.scrollTrack&&this.scrollBar){const{clientWidth}=this.scrollTrack;const{start,end}=this.displayRange;const precent=end-start;let barWidth=precent*clientWidth;barWidth=Math.max(barWidth,20);const left=start?start/(1-precent)*(clientWidth-barWidth):0;setStyle(this.scrollBar,{width:\"\".concat(barWidth/clientWidth*100,\"%\"),left:\"\".concat(left,\"px\")});}}setScroll(displayRange){this.displayRange=displayRange;this.resize();}listen(){this.scrollBar.addEventListener('mousedown',this.mouseDown);window.addEventListener('mousemove',this.mouseMove);window.addEventListener('mouseup',this.mouseLeave);}destory(){this.scrollBar.removeEventListener('mousedown',this.mouseDown);window.removeEventListener('mousemove',this.mouseMove);window.removeEventListener('mouseup',this.mouseLeave);}}","map":{"version":3,"names":["setStyle","ScrollControl","constructor","_ref","container","height","barColor","trackStyle","displayRange","onScroll","start","end","scrollTrack","scrollBar","params","isDragging","startX","stop","mouseDown","e","clientX","mouseLeave","mouseMove","precent","movePrecent","clientWidth","left","resize","trackColor","color","document","createElement","init","className","position","width","concat","padding","backgroundColor","borderRadius","overflow","minWidth","cursor","appendChild","listen","barWidth","Math","max","setScroll","addEventListener","window","destory","removeEventListener"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/long-audio/components/XScroll/index.ts"],"sourcesContent":["import { setStyle } from '../../../../utils';\n\ninterface ScrollOptions {\n  container: HTMLElement;\n  height?: number;\n  barColor?: string;\n  trackStyle?: {[key: string]: any};\n  displayRange?: { start: number; end: number; };\n  onScroll: (start: number, end: number) => void;\n}\n\nexport default class ScrollControl {\n  container: HTMLElement;\n\n  displayRange: {start: number; end: number;} = { start: 0, end: 1 };\n\n  scrollTrack: HTMLElement;\n\n  trackStyle?: {[key: string]: any};\n\n  scrollBar: HTMLElement;\n\n  params: {\n    height: number;\n    barColor: string;\n    trackColor: string;\n  };\n\n  isDragging = false;\n\n  startX = 0;\n\n  stop: any;\n\n  onScroll: (start: number, end: number) => void;\n\n  constructor({ container, height, barColor, trackStyle, displayRange, onScroll }: ScrollOptions) {\n    this.container = container;\n    this.params = {\n      height: height || 20,\n      barColor: barColor || '#777B82',\n      trackColor: trackStyle?.color || '#eee',\n    };\n    if (displayRange) {\n      this.displayRange = displayRange;\n    }\n    this.trackStyle = trackStyle;\n    this.scrollTrack = document.createElement('div');\n    this.scrollBar = document.createElement('div');\n    this.onScroll = onScroll;\n    this.init();\n  }\n\n  init() {\n    const { height, barColor, trackColor } = this.params;\n    this.scrollTrack.className = 'wave-scroll';\n    setStyle(this.scrollTrack, {\n      position: 'relative',\n      width: '100%',\n      height: `${height}px`,\n      padding: '2px 0',\n      backgroundColor: trackColor,\n      borderRadius: '2px',\n      overflow: 'hidden',\n      ...this.trackStyle\n    });\n    this.scrollBar.className = 'wave-scroll-bar';\n    setStyle(this.scrollBar, {\n      position: 'absolute',\n      width: '100%',\n      minWidth: '20px',\n      height: `${height - 4}px`,\n      backgroundColor: barColor,\n      borderRadius: '2px',\n      cursor: 'pointer',\n    });\n\n    this.scrollTrack.appendChild(this.scrollBar);\n    this.container.appendChild(this.scrollTrack);\n    this.listen();\n    this.resize();\n  }\n\n  resize() {\n    if (this.scrollTrack && this.scrollBar) {\n      const { clientWidth } = this.scrollTrack;\n      const { start, end } = this.displayRange;\n      const precent = end - start;\n      let barWidth = precent * clientWidth;\n      barWidth = Math.max(barWidth, 20);\n      const left = start ? (start / (1 - precent)) * (clientWidth - barWidth) : 0;\n      setStyle(this.scrollBar, {\n        width: `${(barWidth / clientWidth) * 100}%`,\n        left: `${left}px`\n      });\n    }\n  }\n\n  setScroll(displayRange: { start: number; end: number }) {\n    this.displayRange = displayRange;\n    this.resize();\n  }\n\n  listen() {\n    this.scrollBar.addEventListener('mousedown', this.mouseDown);\n    window.addEventListener('mousemove', this.mouseMove);\n    window.addEventListener('mouseup', this.mouseLeave);\n  }\n\n  destory() {\n    this.scrollBar.removeEventListener('mousedown', this.mouseDown);\n    window.removeEventListener('mousemove', this.mouseMove);\n    window.removeEventListener('mouseup', this.mouseLeave);\n  }\n\n  mouseDown = (e: MouseEvent) => {\n    this.isDragging = true;\n    this.startX = e.clientX;\n  };\n\n  mouseLeave = () => {\n    if (this.isDragging) {\n      this.isDragging = false;\n    }\n  };\n\n  mouseMove = (e: MouseEvent) => {\n    const { start, end } = this.displayRange;\n    const precent = end - start;\n    if (this.isDragging && precent < 1) {\n      const movePrecent = ((e.clientX - this.startX) * (1 - precent)) / (this.scrollTrack.clientWidth - this.scrollBar.clientWidth);\n      let left = movePrecent + start;\n      if (left < 0) {\n        left = 0;\n      } else if (left + precent > 1) {\n        left = 1 - precent;\n      }\n      this.displayRange = {\n        start: left,\n        end: left + precent,\n      };\n      this.startX = e.clientX;\n      this.onScroll(left, left + precent);\n      this.resize();\n    }\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}