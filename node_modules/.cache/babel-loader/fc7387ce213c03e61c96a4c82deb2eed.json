{"ast":null,"code":"import React,{useState,useEffect}from'react';import cx from'classnames';import{Tooltip,Slider,Row,Col,Modal,InputNumber,Radio,Space}from'antd';import{RedoOutlined}from'@ant-design/icons';import{connect}from'react-redux';import{setVideoSpeed,setPlayMode}from'../../redux/action';import{playMode}from'../../constants';import{Setting}from'../../../common/icons';import i18n from'../../locales';import'./index.scss';const catchPreferencesKey='long_audio_preferences';export const playModeMessage={regionPlay:()=>i18n.translate('PLAY_MODE_TIP_REGION_PLAY'),regionLoop:()=>i18n.translate('PLAY_MODE_TIP_REGION_LOOP'),overallLoop:()=>i18n.translate('PLAY_MODE_TIP_OVERALL')};const PreferencesPanel=props=>{const[visible,setVisible]=useState(false);const[preferences,setPreferences]=useState({speed:1,playMode:'regionPlay'});const{setVideoSpeedFun,setPlayModeFun}=props;useEffect(()=>{const catchData=localStorage.getItem(catchPreferencesKey);if(catchData){handlePreferences(JSON.parse(catchData));}},[]);const handlePreferences=data=>{const newPreferences={...preferences,...data};setVideoSpeedFun({speed:newPreferences.speed||1});setPlayModeFun({value:newPreferences.playMode||'regionPlay'});setPreferences(newPreferences);localStorage.setItem(catchPreferencesKey,JSON.stringify(newPreferences));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Tooltip,{placement:\"bottom\",title:i18n.translate('PREFERENCES_TITLE')},/*#__PURE__*/React.createElement(\"div\",{className:cx('icon-button',{'icon-button--active':visible}),onClick:()=>setVisible(true)},/*#__PURE__*/React.createElement(Setting,null))),/*#__PURE__*/React.createElement(Modal,{title:i18n.translate('PREFERENCES_TITLE'),visible:visible,width:480,onOk:()=>setVisible(false),onCancel:()=>setVisible(false),wrapClassName:\"preferences_modal\",footer:null},/*#__PURE__*/React.createElement(\"div\",{className:\"preferences-settings\"},/*#__PURE__*/React.createElement(\"div\",{className:\"preferences-settings-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"preferences-settings-item-title\"},/*#__PURE__*/React.createElement(\"div\",null,i18n.translate('PREFERENCES_PLAY')),/*#__PURE__*/React.createElement(\"div\",{className:\"reset\",onClick:()=>handlePreferences({speed:1,playMode:'regionPlay'})},/*#__PURE__*/React.createElement(RedoOutlined,null))),/*#__PURE__*/React.createElement(\"div\",{className:\"preferences-settings-item-content\"},/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:6}},i18n.translate('PREFERENCES_PLAY_SPEED')),/*#__PURE__*/React.createElement(Row,{gutter:12,align:\"middle\"},/*#__PURE__*/React.createElement(Col,{span:10},/*#__PURE__*/React.createElement(Slider,{min:0.25,max:4,step:0.25,value:preferences.speed,onChange:v=>handlePreferences({speed:v})})),/*#__PURE__*/React.createElement(Col,{span:6},/*#__PURE__*/React.createElement(InputNumber,{min:0.25,max:4,step:0.25,value:preferences.speed,onChange:v=>handlePreferences({speed:v}),onFocus:()=>{window.disableLongAudioHotKeys=true;},onBlur:()=>{window.disableLongAudioHotKeys=false;}}))),/*#__PURE__*/React.createElement(\"div\",{style:{margin:'20px 0 6px'}},i18n.translate('PREFERENCES_PLAY_MODE')),/*#__PURE__*/React.createElement(Radio.Group,{size:\"small\",className:\"preferences-play-mode\",value:preferences.playMode,onChange:e=>{handlePreferences({playMode:e.target.value});}},/*#__PURE__*/React.createElement(Space,{direction:\"vertical\"},playMode.map(m=>/*#__PURE__*/React.createElement(Radio,{key:m,value:m},playModeMessage[m]())))))))));};const mapDispatchToProps={setVideoSpeedFun:setVideoSpeed,setPlayModeFun:setPlayMode};export default connect(null,mapDispatchToProps)(PreferencesPanel);","map":{"version":3,"names":["React","useState","useEffect","cx","Tooltip","Slider","Row","Col","Modal","InputNumber","Radio","Space","RedoOutlined","connect","setVideoSpeed","setPlayMode","playMode","Setting","i18n","catchPreferencesKey","playModeMessage","regionPlay","translate","regionLoop","overallLoop","PreferencesPanel","props","visible","setVisible","preferences","setPreferences","speed","setVideoSpeedFun","setPlayModeFun","catchData","localStorage","getItem","handlePreferences","JSON","parse","data","newPreferences","value","setItem","stringify","createElement","Fragment","placement","title","className","onClick","width","onOk","onCancel","wrapClassName","footer","style","marginBottom","gutter","align","span","min","max","step","onChange","v","onFocus","window","disableLongAudioHotKeys","onBlur","margin","Group","size","e","target","direction","map","m","key","mapDispatchToProps"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/long-audio/components/Preferences/index.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport cx from 'classnames';\nimport { Tooltip, Slider, Row, Col, Modal, InputNumber, Radio, Space } from 'antd';\nimport { RedoOutlined } from '@ant-design/icons';\nimport { connect } from 'react-redux';\nimport { setVideoSpeed, setPlayMode } from '../../redux/action';\nimport { playMode } from '../../constants';\nimport { Setting } from '../../../common/icons';\nimport i18n from '../../locales';\nimport './index.scss';\n\nconst catchPreferencesKey = 'long_audio_preferences';\n\ninterface PreferencesProps {\n  setVideoSpeedFun: (data: {speed: number}) => void;\n  setPlayModeFun: (data: {value: string}) => void;\n}\n\ninterface Preferences {\n  speed?: number;\n  playMode?: string;\n}\n\nexport const playModeMessage:{[key:string]: () => string} = {\n  regionPlay: () => i18n.translate('PLAY_MODE_TIP_REGION_PLAY'),\n  regionLoop: () => i18n.translate('PLAY_MODE_TIP_REGION_LOOP'),\n  overallLoop: () => i18n.translate('PLAY_MODE_TIP_OVERALL'),\n};\n\nconst PreferencesPanel = (props: PreferencesProps) => {\n  const [visible, setVisible] = useState(false);\n  const [preferences, setPreferences] = useState<Preferences>({\n    speed: 1,\n    playMode: 'regionPlay'\n  });\n\n  const { setVideoSpeedFun, setPlayModeFun } = props;\n\n  useEffect(() => {\n    const catchData = localStorage.getItem(catchPreferencesKey);\n    if (catchData) {\n      handlePreferences(JSON.parse(catchData));\n    }\n  }, []);\n\n  const handlePreferences = (data: Preferences) => {\n    const newPreferences = {\n      ...preferences,\n      ...data,\n    };\n    setVideoSpeedFun({ speed: newPreferences.speed || 1 });\n    setPlayModeFun({ value: newPreferences.playMode || 'regionPlay' });\n    setPreferences(newPreferences);\n    localStorage.setItem(catchPreferencesKey, JSON.stringify(newPreferences));\n  };\n\n  return (\n    <>\n      <Tooltip placement=\"bottom\" title={i18n.translate('PREFERENCES_TITLE')}>\n        <div\n          className={cx('icon-button', {\n            'icon-button--active': visible,\n          })}\n          onClick={() => setVisible(true)}\n        >\n          <Setting />\n        </div>\n      </Tooltip>\n      <Modal\n        title={i18n.translate('PREFERENCES_TITLE')}\n        visible={visible}\n        width={480}\n        onOk={() => setVisible(false)}\n        onCancel={() => setVisible(false)}\n        wrapClassName=\"preferences_modal\"\n        footer={null}\n      >\n        <div className=\"preferences-settings\">\n          <div className=\"preferences-settings-item\">\n            <div className=\"preferences-settings-item-title\">\n              <div>{i18n.translate('PREFERENCES_PLAY')}</div>\n              <div className=\"reset\" onClick={() => handlePreferences({ speed: 1, playMode: 'regionPlay' })}>\n                <RedoOutlined />\n              </div>\n            </div>\n\n            <div className=\"preferences-settings-item-content\">\n              <div style={{ marginBottom: 6 }}>{i18n.translate('PREFERENCES_PLAY_SPEED')}</div>\n              <Row gutter={12} align=\"middle\">\n                <Col span={10}>\n                  <Slider\n                    min={0.25}\n                    max={4}\n                    step={0.25}\n                    value={preferences.speed}\n                    onChange={(v: number) => handlePreferences({ speed: v })}\n                  />\n                </Col>\n                <Col span={6}>\n                  <InputNumber\n                    min={0.25}\n                    max={4}\n                    step={0.25}\n                    value={preferences.speed}\n                    onChange={(v) => handlePreferences({ speed: v as number })}\n                    onFocus={() => { (window as any).disableLongAudioHotKeys = true; }}\n                    onBlur={() => { (window as any).disableLongAudioHotKeys = false; }}\n                  />\n                </Col>\n              </Row>\n              <div style={{ margin: '20px 0 6px' }}>{i18n.translate('PREFERENCES_PLAY_MODE')}</div>\n              <Radio.Group\n                size=\"small\"\n                className=\"preferences-play-mode\"\n                value={preferences.playMode}\n                onChange={(e) => { handlePreferences({ playMode: e.target.value }); }}\n              >\n                <Space direction=\"vertical\">\n                  {playMode.map((m) => (<Radio key={m} value={m}>{playModeMessage[m]()}</Radio>))}\n                </Space>\n              </Radio.Group>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </>\n  );\n};\n\nconst mapDispatchToProps = {\n  setVideoSpeedFun: setVideoSpeed,\n  setPlayModeFun: setPlayMode,\n};\n\nexport default connect(null, mapDispatchToProps)(PreferencesPanel);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}