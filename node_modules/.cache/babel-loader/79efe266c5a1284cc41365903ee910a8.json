{"ast":null,"code":"/* eslint-disable no-underscore-dangle */\nimport dayjs from 'dayjs';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\nimport utc from 'dayjs/plugin/utc';\nimport { insertStyle, isCellEmpty, getMergeStatus, getCellIndexPosition, isTimeFormat, isDateFormat, isDateTimeFormat } from './utils';\ndayjs.extend(customParseFormat);\ndayjs.extend(utc);\n// 检测workbook是否有x-spreadsheet不支持的样式\n// 不支持header，footer，media，table\nexport function checkStyleValid(workbook) {\n  let result = true;\n  workbook.eachSheet(sheet => {\n    if (!result) return;\n    Object.keys(sheet).forEach(key => {\n      if (sheet[key]) {\n        switch (key) {\n          case 'views':\n            if (sheet[key][0] && sheet[key][0].state === 'split') {\n              result = false;\n            }\n            break;\n          case 'tables':\n            if (Object.keys(sheet[key]).length !== 0) {\n              result = false;\n            }\n            break;\n          case '_media':\n            if (sheet[key].length !== 0) {\n              result = false;\n            }\n            break;\n          case 'headerFooter':\n            result = false;\n            break;\n          default:\n            break;\n        }\n      }\n    });\n  });\n  return result;\n}\n\n// 将workbook转换成x-spreadsheet所支持的json格式\nexport default function workbookToJson(workbook) {\n  const json = [];\n  workbook.eachSheet(sheet => {\n    const sheetInfo = {\n      locked: true\n    };\n    sheetInfo.name = sheet.name;\n    sheetInfo.cols = {\n      len: sheet.columnCount > 26 ? sheet.columnCount : 26\n    };\n    sheetInfo.merges = sheet.hasMerges ? Object.keys(sheet._merges).map(key => sheet._merges[key].range) : [];\n    sheetInfo.validations = [];\n    sheetInfo.autofilter = {};\n    sheetInfo.freeze = sheet.views && sheet.views[0].state === 'frozen' && sheet.views[0].topLeftCell ? sheet.views[0].topLeftCell : 'A1';\n    sheetInfo.rows = {\n      len: sheet.rowCount > 100 ? sheet.rowCount : 100\n    };\n    sheetInfo.styles = [];\n    // 设置宽度\n    if (sheet._columns) {\n      for (let i = 0; i < sheet._columns.length; i += 1) {\n        if (sheet._columns[i] && sheet._columns[i].width) sheetInfo.cols[i] = {\n          width: sheet._columns[i].width * 10\n        };\n      }\n    }\n    importExcel(sheet, sheetInfo);\n    json.push(sheetInfo);\n  });\n  return json;\n}\n\n// 将exceljs的workbook中的样式导入x-spreadsheet支持的json中\nfunction importExcel(sheet, sheetInfo) {\n  const {\n    styles,\n    rows,\n    merges\n  } = sheetInfo;\n  const stylePool = insertStyle(styles);\n  sheet.eachRow({\n    includeEmpty: true\n  }, (row, rowNum) => {\n    // rowNum 从1开始\n    if (row.height) {\n      rows[rowNum - 1] = {\n        cells: {},\n        height: row.height\n      };\n    }\n    row.eachCell({\n      includeEmpty: true\n    }, (cell, cellNum) => {\n      // cellNum 从1开始\n      if (isCellEmpty(cell)) return;\n      // 初始化\n      if (!rows[rowNum - 1]) {\n        rows[rowNum - 1] = {\n          cells: {}\n        };\n      }\n      ;\n      rows[rowNum - 1].cells[cellNum - 1] = {};\n      const {\n        style,\n        numFmt\n      } = cell;\n      let {\n        text\n      } = cell;\n      const merge = getMergeStatus(rowNum - 1, cellNum - 1, merges);\n      if (merge) {\n        // 将26进制转成10进制\n        const coord = merge.split(':');\n        const {\n          row: rowS,\n          col: colS\n        } = getCellIndexPosition(coord[0]);\n        const {\n          row: rowE,\n          col: colE\n        } = getCellIndexPosition(coord[1]);\n        // 仅设置merge单元格左上角的格子\n        if (rowNum - 1 === rowS && cellNum - 1 === colS) {\n          rows[rowNum - 1].cells[cellNum - 1].merge = [rowE - rowS, colE - colS];\n        } else {\n          delete rows[rowNum - 1].cells[cellNum - 1];\n          return;\n        }\n      }\n      if (text && numFmt && isDateTimeFormat(numFmt)) {\n        text = dayjs(text).utc().format('YYYY/MM/DD HH:mm:ss');\n      }\n      if (text) rows[rowNum - 1].cells[cellNum - 1].text = text;\n      if (style && Object.keys(style).length !== 0) insertCellStyleFromExcel(stylePool, style, numFmt, rows[rowNum - 1].cells[cellNum - 1]);\n      if (text) rows[rowNum - 1].cells[cellNum - 1].locked = true;\n    });\n  });\n}\n\n// 将exceljs中cell所对应的style转换至x-spreadsheet所支持的格式\nfunction insertCellStyleFromExcel(stylePool, style, numFmt, cell) {\n  let cellStyle = {};\n\n  // font format\n  if (numFmt != null) {\n    if (numFmt.match(/0.00E\\+00/)) {\n      cellStyle.format = 'scientific';\n    } else if (isDateFormat(numFmt) && isTimeFormat(numFmt)) {\n      cellStyle.format = 'datetime';\n    } else if (isDateFormat(numFmt)) {\n      cellStyle.format = 'date';\n    } else if (isTimeFormat(numFmt)) {\n      cellStyle.format = 'time';\n    } else if (numFmt === '0.00%') {\n      cellStyle.format = 'percent';\n    } else if (numFmt.match(/^(?<!€)\\$(?!.*€)/)) {\n      cellStyle.format = 'usd';\n    } else if (numFmt.match(/¥/)) {\n      cellStyle.format = 'rmb';\n    } else if (numFmt.match(/€/)) {\n      cellStyle.format = 'eur';\n    }\n  }\n\n  // border style\n  if (style.border && Object.keys(style.border).length !== 0) {\n    cellStyle.border = {};\n    Object.keys(style.border).forEach(key => {\n      cellStyle.border[key] = [style.border[key].style, `#${style.border[key].color.argb.slice(2)}`];\n    });\n  }\n\n  // fill style\n  if (style.fill && style.fill.fgColor && style.fill.pattern && style.fill.pattern !== 'none') {\n    cellStyle.bgcolor = `#${style.fill.fgColor.argb.slice(2)}`;\n  }\n\n  // font style\n  if (style.font) {\n    const {\n      color,\n      size,\n      strike,\n      underline = false,\n      italic = false,\n      bold = false\n    } = style.font;\n    if (color && color.argb) cellStyle.color = `#${color.argb.slice(2)}`;\n    cellStyle.font = {\n      bold,\n      italic,\n      size\n    };\n    if (strike) cellStyle.strike = strike;\n    if (underline) cellStyle.underline = underline;\n  }\n\n  // alignment\n  if (style.alignment) {\n    const {\n      horizontal: align = 'left',\n      vertical: valign = 'bottom',\n      wrapText = false\n    } = style.alignment;\n    cellStyle = {\n      ...cellStyle,\n      align,\n      valign\n    };\n    cellStyle.textwrap = wrapText;\n  }\n  // 将样式载入styles，若有重复的style在styles中则选定index\n  cell.style = stylePool(cellStyle);\n}","map":{"version":3,"names":["dayjs","customParseFormat","utc","insertStyle","isCellEmpty","getMergeStatus","getCellIndexPosition","isTimeFormat","isDateFormat","isDateTimeFormat","extend","checkStyleValid","workbook","result","eachSheet","sheet","Object","keys","forEach","key","state","length","workbookToJson","json","sheetInfo","locked","name","cols","len","columnCount","merges","hasMerges","_merges","map","range","validations","autofilter","freeze","views","topLeftCell","rows","rowCount","styles","_columns","i","width","importExcel","push","stylePool","eachRow","includeEmpty","row","rowNum","height","cells","eachCell","cell","cellNum","style","numFmt","text","merge","coord","split","rowS","col","colS","rowE","colE","format","insertCellStyleFromExcel","cellStyle","match","border","color","argb","slice","fill","fgColor","pattern","bgcolor","font","size","strike","underline","italic","bold","alignment","horizontal","align","vertical","valign","wrapText","textwrap"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/excel/workbook2json.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport dayjs from 'dayjs';\nimport customParseFormat from 'dayjs/plugin/customParseFormat';\nimport utc from 'dayjs/plugin/utc';\nimport { insertStyle, isCellEmpty, getMergeStatus, getCellIndexPosition, isTimeFormat, isDateFormat, isDateTimeFormat } from './utils';\n\ndayjs.extend(customParseFormat);\ndayjs.extend(utc);\n// 检测workbook是否有x-spreadsheet不支持的样式\n// 不支持header，footer，media，table\nexport function checkStyleValid(workbook) {\n  let result = true;\n  workbook.eachSheet((sheet) => {\n    if (!result) return;\n    Object.keys(sheet).forEach((key) => {\n      if (sheet[key]) {\n        switch (key) {\n          case 'views':\n            if (sheet[key][0] && sheet[key][0].state === 'split') {\n              result = false;\n            }\n            break;\n          case 'tables':\n            if (Object.keys(sheet[key]).length !== 0) {\n              result = false;\n            }\n            break;\n          case '_media':\n            if (sheet[key].length !== 0) {\n              result = false;\n            }\n            break;\n          case 'headerFooter':\n            result = false;\n            break;\n          default: break;\n        }\n      }\n    });\n  });\n  return result;\n}\n\n// 将workbook转换成x-spreadsheet所支持的json格式\nexport default function workbookToJson(workbook) {\n  const json = [];\n  workbook.eachSheet((sheet) => {\n    const sheetInfo = { locked: true };\n    sheetInfo.name = sheet.name;\n    sheetInfo.cols = { len: sheet.columnCount > 26 ? sheet.columnCount : 26 };\n    sheetInfo.merges = sheet.hasMerges ? Object.keys(sheet._merges).map((key) => sheet._merges[key].range) : [];\n    sheetInfo.validations = [];\n    sheetInfo.autofilter = {};\n    sheetInfo.freeze = sheet.views && sheet.views[0].state === 'frozen' && sheet.views[0].topLeftCell ? sheet.views[0].topLeftCell : 'A1';\n\n    sheetInfo.rows = { len: sheet.rowCount > 100 ? sheet.rowCount : 100 };\n    sheetInfo.styles = [];\n    // 设置宽度\n    if (sheet._columns) {\n      for (let i = 0; i < sheet._columns.length; i += 1) {\n        if (sheet._columns[i] && sheet._columns[i].width) sheetInfo.cols[i] = { width: sheet._columns[i].width * 10 };\n      }\n    }\n    importExcel(sheet, sheetInfo);\n    json.push(sheetInfo);\n  });\n  return json;\n}\n\n// 将exceljs的workbook中的样式导入x-spreadsheet支持的json中\nfunction importExcel(sheet, sheetInfo) {\n  const { styles, rows, merges } = sheetInfo;\n  const stylePool = insertStyle(styles);\n  sheet.eachRow({ includeEmpty: true }, (row, rowNum) => { // rowNum 从1开始\n    if (row.height) {\n      rows[rowNum - 1] = {\n        cells: {},\n        height: row.height,\n      };\n    }\n    row.eachCell({ includeEmpty: true }, (cell, cellNum) => { // cellNum 从1开始\n      if (isCellEmpty(cell)) return;\n      // 初始化\n      if (!rows[rowNum - 1]) {\n        rows[rowNum - 1] = {\n          cells: {},\n        };\n      };\n\n      rows[rowNum - 1].cells[cellNum - 1] = {};\n      const { style, numFmt } = cell;\n      let { text } = cell;\n      const merge = getMergeStatus(rowNum - 1, cellNum - 1, merges);\n      if (merge) {\n        // 将26进制转成10进制\n        const coord = merge.split(':');\n        const { row: rowS, col: colS } = getCellIndexPosition(coord[0]);\n        const { row: rowE, col: colE } = getCellIndexPosition(coord[1]);\n        // 仅设置merge单元格左上角的格子\n        if (rowNum - 1 === rowS && cellNum - 1 === colS) {\n          rows[rowNum - 1].cells[cellNum - 1].merge = [rowE - rowS, colE - colS];\n        } else {\n          delete rows[rowNum - 1].cells[cellNum - 1];\n          return;\n        }\n      }\n\n      if (text && numFmt && isDateTimeFormat(numFmt)) {\n        text = dayjs(text).utc().format('YYYY/MM/DD HH:mm:ss');\n      }\n      if (text) rows[rowNum - 1].cells[cellNum - 1].text = text;\n      if (style && Object.keys(style).length !== 0) insertCellStyleFromExcel(stylePool, style, numFmt, rows[rowNum - 1].cells[cellNum - 1]);\n      if (text) rows[rowNum - 1].cells[cellNum - 1].locked = true;\n    });\n  });\n}\n\n// 将exceljs中cell所对应的style转换至x-spreadsheet所支持的格式\nfunction insertCellStyleFromExcel(stylePool, style, numFmt, cell) {\n  let cellStyle = {};\n\n  // font format\n  if (numFmt != null) {\n    if (numFmt.match(/0.00E\\+00/)) {\n      cellStyle.format = 'scientific';\n    } else if (isDateFormat(numFmt) && isTimeFormat(numFmt)) {\n      cellStyle.format = 'datetime';\n    } else if (isDateFormat(numFmt)) {\n      cellStyle.format = 'date';\n    } else if (isTimeFormat(numFmt)) {\n      cellStyle.format = 'time';\n    } else if (numFmt === '0.00%') {\n      cellStyle.format = 'percent';\n    } else if (numFmt.match(/^(?<!€)\\$(?!.*€)/)) {\n      cellStyle.format = 'usd';\n    } else if (numFmt.match(/¥/)) {\n      cellStyle.format = 'rmb';\n    } else if (numFmt.match(/€/)) {\n      cellStyle.format = 'eur';\n    }\n  }\n\n  // border style\n  if (style.border && Object.keys(style.border).length !== 0) {\n    cellStyle.border = {};\n    Object.keys(style.border).forEach((key) => {\n      cellStyle.border[key] = [style.border[key].style, `#${style.border[key].color.argb.slice(2)}`];\n    });\n  }\n\n  // fill style\n  if (style.fill && style.fill.fgColor && style.fill.pattern && style.fill.pattern !== 'none') {\n    cellStyle.bgcolor = `#${style.fill.fgColor.argb.slice(2)}`;\n  }\n\n  // font style\n  if (style.font) {\n    const { color, size, strike, underline = false, italic = false, bold = false } = style.font;\n    if (color && color.argb) cellStyle.color = `#${color.argb.slice(2)}`;\n    cellStyle.font = {\n      bold,\n      italic,\n      size,\n    };\n    if (strike) cellStyle.strike = strike;\n    if (underline) cellStyle.underline = underline;\n  }\n\n  // alignment\n  if (style.alignment) {\n    const { horizontal: align = 'left', vertical: valign = 'bottom', wrapText = false } = style.alignment;\n    cellStyle = { ...cellStyle, align, valign };\n    cellStyle.textwrap = wrapText;\n  }\n  // 将样式载入styles，若有重复的style在styles中则选定index\n  cell.style = stylePool(cellStyle);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}