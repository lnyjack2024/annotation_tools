{"ast":null,"code":"import { Base64 } from 'js-base64';\nimport { utils } from '@appen/easy-form';\nimport store from '../store/RootStore';\nimport i18n from '../locales';\nimport { runCustomValidation } from '../../../utils';\nimport { ValidationType } from '../types';\n/**\n * load instance from result\n * @param result\n */\nexport function loadInstancesFromResult(result, ontology) {\n  return result.map(instance => {\n    const {\n      channelIndex\n    } = instance;\n    const newCategory = ontology[channelIndex];\n    return {\n      ...instance,\n      category: (newCategory === null || newCategory === void 0 ? void 0 : newCategory.class_name) || `${channelIndex + 1}`,\n      label: (newCategory === null || newCategory === void 0 ? void 0 : newCategory.display_name) || (newCategory === null || newCategory === void 0 ? void 0 : newCategory.class_name) || `${channelIndex + 1}`\n    };\n  });\n}\nexport function validate(customCheck, params) {\n  return new Promise(async resolve => {\n    const {\n      resultLink\n    } = params;\n    const results = [];\n    let hasCustomError = false;\n    if (customCheck) {\n      // custom check\n      const customResult = await runCustomValidation(customCheck, resultLink);\n      customResult.results.forEach(result => {\n        results.push({\n          ...result,\n          ...(result.info && result.info),\n          warningType: ValidationType.CUSTOM\n        });\n      });\n      hasCustomError = customResult.hasCustomError;\n    }\n    resolve({\n      results,\n      hasCustomError\n    });\n  });\n}\n\n/* eslint-disable valid-jsdoc */\n/**\n * Returns the `requestAnimationFrame` function for the browser, or a shim with\n * `setTimeout` if the function is not found\n *\n * @return {function} Available `requestAnimationFrame` function for the browser\n */\nexport const requestAnimationFrame = (window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || (callback => setTimeout(callback, 1000 / 60))).bind(window);\nexport const cancelAnimationFrame = (window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || (callback => clearTimeout(callback))).bind(window);\n\n/**\n * Create a function which will be called at the next requestAnimationFrame\n * cycle\n *\n * @param {function} func The function to call\n *\n * @return {func} The function wrapped within a requestAnimationFrame\n */\nexport function frame(func) {\n  return (...args) => requestAnimationFrame(() => func(...args));\n}\nexport const timeInterval = pxPerSec => {\n  let retVal = 1;\n  if (pxPerSec >= 1000) {\n    retVal = 0.01;\n  } else if (pxPerSec >= 500) {\n    retVal = 0.02;\n  } else if (pxPerSec >= 100) {\n    retVal = 0.1;\n  } else if (pxPerSec >= 50) {\n    retVal = 0.2;\n  } else if (pxPerSec >= 10) {\n    retVal = 1;\n  } else if (pxPerSec >= 5) {\n    retVal = 12;\n  } else if (pxPerSec >= 1) {\n    retVal = 24;\n  } else if (pxPerSec >= 0.5) {\n    retVal = 120;\n  } else if (pxPerSec >= 0.01) {\n    retVal = 600;\n  } else {\n    retVal = Math.ceil(1 / pxPerSec) * 60;\n  }\n  return retVal;\n};\nexport const formatTimeCallback = (secs, pxPerSec) => {\n  let seconds = Number(secs);\n  const minutes = Math.floor(seconds / 60);\n  seconds %= 60;\n\n  // fill up seconds with zeroes\n  let secondsStr = Math.round(seconds).toString();\n  if (pxPerSec >= 25 * 10) {\n    secondsStr = seconds.toFixed(2);\n  } else if (pxPerSec >= 25 * 1) {\n    secondsStr = seconds.toFixed(1);\n  }\n  secondsStr = seconds >= 10 ? secondsStr : `0${secondsStr}`;\n  return `${minutes || '00'}:${secondsStr}`;\n};\n\n/**\n * Apply a map of styles to an element\n *\n * @param {HTMLElement} el The element that the styles will be applied to\n * @param {Object} styles The map of propName: attribute, both are used as-is\n *\n * @return {HTMLElement} el\n */\nexport const setStyle = (el, styles) => {\n  Object.keys(styles).forEach(prop => {\n    if (el.style[prop] !== styles[prop]) {\n      el.style[prop] = styles[prop];\n    }\n  });\n  return el;\n};\n\n/**\n * parse config\n */\nexport function parseLabelConfig(configStr) {\n  if (configStr) {\n    try {\n      const labelConfig = JSON.parse(Base64.decode(configStr));\n      return labelConfig;\n    } catch (e) {\n      // parse error\n    }\n  }\n  return undefined;\n}\nexport const verifyCurrentForm = (config, instance, current) => {\n  if (store.readonly) return {\n    result: true\n  };\n  const {\n    updatedValues,\n    updatedFields\n  } = triggerForm(config, instance.attributes);\n  const index = updatedFields.findIndex(v => v.required === true && v.readonly !== true && v.visible !== false && (v.defaultValue === undefined || v.defaultValue === ''));\n  if (index < 0) return {\n    result: true,\n    data: updatedValues\n  };\n  const err = `${i18n.translate('DATA_ERROR_REQUIRED')} ${updatedFields[index].label}. Segment ${current + 1}`;\n  return {\n    result: false,\n    error: err\n  };\n};\nexport const triggerForm = (config, values = {}) => {\n  const {\n    fields: configFields,\n    conditions = [],\n    effects = [],\n    rules = []\n  } = config;\n  const fields = (configFields || []).map(field => ({\n    ...field,\n    ...(values[field.name] !== undefined && {\n      defaultValue: values[field.name]\n    })\n  }));\n  const parsedValue = utils.parseFormFields(fields);\n  // trigger rule effects\n  const {\n    updatedValues: triggerValues,\n    updatedFields\n  } = rules.reduce((acc, curr) => utils.ruleTrigger(curr, acc.updatedFields, acc.updatedValues, fields, conditions, effects), {\n    updatedFields: parsedValue.fields,\n    updatedValues: parsedValue.initialValues\n  });\n  const updatedValues = {\n    ...triggerValues\n  };\n  updatedFields.filter(f => f.visible === false).forEach(f => {\n    delete updatedValues[f.name];\n  });\n  return {\n    updatedValues,\n    updatedFields\n  };\n};\nexport const fittingString = (_ctx, _str, maxWidth) => {\n  let str = _str;\n  let strWidth = _ctx.measureText(str).width;\n  const ellipsis = '…';\n  const ellipsisWidth = _ctx.measureText(ellipsis).width;\n  if (strWidth + ellipsisWidth <= maxWidth) {\n    return str;\n  }\n  let len = str.length;\n  while (strWidth + ellipsisWidth >= maxWidth && len > 0) {\n    str = str.slice(0, len);\n    strWidth = _ctx.measureText(str).width;\n    len -= 1;\n  }\n  return str + ellipsis;\n};\nexport const drawRoundedRect = (rect, r, ctx) => {\n  const ptA = {\n    x: rect.x + r,\n    y: rect.y\n  };\n  const ptB = {\n    x: rect.x + rect.width,\n    y: rect.y\n  };\n  const ptC = {\n    x: rect.x + rect.width,\n    y: rect.y + rect.height\n  };\n  const ptD = {\n    x: rect.x,\n    y: rect.y + rect.height\n  };\n  const ptE = {\n    x: rect.x,\n    y: rect.y\n  };\n  ctx.beginPath();\n  ctx.moveTo(ptA.x, ptA.y);\n  ctx.arcTo(ptB.x, ptB.y, ptC.x, ptC.y, r);\n  ctx.arcTo(ptC.x, ptC.y, ptD.x, ptD.y, r);\n  ctx.arcTo(ptD.x, ptD.y, ptE.x, ptE.y, r);\n  ctx.arcTo(ptE.x, ptE.y, ptA.x, ptA.y, r);\n  ctx.closePath();\n  ctx.fill();\n};\nexport const verifyForm = (config, attributes = {}) => {\n  if (store.readonly) return {\n    result: true\n  };\n  const {\n    updatedValues,\n    updatedFields\n  } = triggerForm(config, attributes);\n  const index = updatedFields.findIndex(v => v.required === true && v.readonly !== true && v.visible !== false && (v.defaultValue === undefined || v.defaultValue === ''));\n  return {\n    result: index < 0,\n    data: updatedValues\n  };\n};","map":{"version":3,"names":["Base64","utils","store","i18n","runCustomValidation","ValidationType","loadInstancesFromResult","result","ontology","map","instance","channelIndex","newCategory","category","class_name","label","display_name","validate","customCheck","params","Promise","resolve","resultLink","results","hasCustomError","customResult","forEach","push","info","warningType","CUSTOM","requestAnimationFrame","window","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","bind","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","clearTimeout","frame","func","args","timeInterval","pxPerSec","retVal","Math","ceil","formatTimeCallback","secs","seconds","Number","minutes","floor","secondsStr","round","toString","toFixed","setStyle","el","styles","Object","keys","prop","style","parseLabelConfig","configStr","labelConfig","JSON","parse","decode","e","undefined","verifyCurrentForm","config","current","readonly","updatedValues","updatedFields","triggerForm","attributes","index","findIndex","v","required","visible","defaultValue","data","err","translate","error","values","fields","configFields","conditions","effects","rules","field","name","parsedValue","parseFormFields","triggerValues","reduce","acc","curr","ruleTrigger","initialValues","filter","f","fittingString","_ctx","_str","maxWidth","str","strWidth","measureText","width","ellipsis","ellipsisWidth","len","length","slice","drawRoundedRect","rect","r","ctx","ptA","x","y","ptB","ptC","height","ptD","ptE","beginPath","moveTo","arcTo","closePath","fill","verifyForm"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/multi-channel/utils/index.ts"],"sourcesContent":["import { Base64 } from 'js-base64';\nimport { utils } from '@appen/easy-form';\nimport store from '../store/RootStore';\nimport i18n from '../locales';\nimport { runCustomValidation } from '../../../utils';\nimport { ValidationType, Instance, Ontology, FormConfig } from '../types';\nimport { IWarning } from '../../common/tabs-menu/Validator';\n\n/**\n * load instance from result\n * @param result\n */\nexport function loadInstancesFromResult(result: Instance[], ontology: Ontology[]) {\n  return result.map((instance) => {\n    const { channelIndex } = instance;\n    const newCategory = ontology[channelIndex];\n    return {\n      ...instance,\n      category: newCategory?.class_name || `${channelIndex + 1}`,\n      label: newCategory?.display_name || newCategory?.class_name || `${channelIndex + 1}`,\n    };\n  });\n}\n\nexport function validate(\n  customCheck: string[],\n  params: {\n    resultLink?: string;\n  },\n) {\n  return new Promise<{\n    results: IWarning[];\n    hasCustomError: boolean;\n  }>(async (resolve) => {\n    const { resultLink } = params;\n    const results: IWarning[] = [];\n    let hasCustomError = false;\n\n    if (customCheck) {\n      // custom check\n      const customResult = await runCustomValidation(customCheck, resultLink!);\n      customResult.results.forEach((result) => {\n        results.push({ ...result, ...result.info && result.info, warningType: ValidationType.CUSTOM });\n      });\n      hasCustomError = customResult.hasCustomError;\n    }\n\n    resolve({ results, hasCustomError });\n  });\n}\n\n/* eslint-disable valid-jsdoc */\n/**\n * Returns the `requestAnimationFrame` function for the browser, or a shim with\n * `setTimeout` if the function is not found\n *\n * @return {function} Available `requestAnimationFrame` function for the browser\n */\nexport const requestAnimationFrame = (\n  window.requestAnimationFrame ||\n  (window as any).webkitRequestAnimationFrame ||\n  (window as any).mozRequestAnimationFrame ||\n  (window as any).oRequestAnimationFrame ||\n  (window as any).msRequestAnimationFrame ||\n  ((callback) => setTimeout(callback, 1000 / 60))\n).bind(window);\n\nexport const cancelAnimationFrame = (\n  window.cancelAnimationFrame ||\n  (window as any).webkitCancelAnimationFrame ||\n  (window as any).mozCancelAnimationFrame ||\n  (window as any).oCancelAnimationFrame ||\n  (window as any).msCancelAnimationFrame ||\n  ((callback) => clearTimeout(callback))\n).bind(window);\n\n/**\n * Create a function which will be called at the next requestAnimationFrame\n * cycle\n *\n * @param {function} func The function to call\n *\n * @return {func} The function wrapped within a requestAnimationFrame\n */\nexport function frame(func: any) {\n  return (...args: any) => requestAnimationFrame(() => func(...args));\n}\n\nexport const timeInterval = (pxPerSec: number) => {\n  let retVal = 1;\n  if (pxPerSec >= 1000) {\n    retVal = 0.01;\n  } else if (pxPerSec >= 500) {\n    retVal = 0.02;\n  } else if (pxPerSec >= 100) {\n    retVal = 0.1;\n  } else if (pxPerSec >= 50) {\n    retVal = 0.2;\n  } else if (pxPerSec >= 10) {\n    retVal = 1;\n  } else if (pxPerSec >= 5) {\n    retVal = 12;\n  } else if (pxPerSec >= 1) {\n    retVal = 24;\n  } else if (pxPerSec >= 0.5) {\n    retVal = 120;\n  } else if (pxPerSec >= 0.01) {\n    retVal = 600;\n  } else {\n    retVal = Math.ceil(1 / pxPerSec) * 60;\n  }\n  return retVal;\n};\n\nexport const formatTimeCallback = (secs: number, pxPerSec: number) => {\n  let seconds = Number(secs);\n  const minutes = Math.floor(seconds / 60);\n  seconds %= 60;\n\n  // fill up seconds with zeroes\n  let secondsStr = Math.round(seconds).toString();\n  if (pxPerSec >= 25 * 10) {\n    secondsStr = seconds.toFixed(2);\n  } else if (pxPerSec >= 25 * 1) {\n    secondsStr = seconds.toFixed(1);\n  }\n  secondsStr = seconds >= 10 ? secondsStr : `0${secondsStr}`;\n  return `${minutes || '00'}:${secondsStr}`;\n};\n\n/**\n * Apply a map of styles to an element\n *\n * @param {HTMLElement} el The element that the styles will be applied to\n * @param {Object} styles The map of propName: attribute, both are used as-is\n *\n * @return {HTMLElement} el\n */\nexport const setStyle = (el: HTMLElement, styles: {[key: string]: any}) => {\n  Object.keys(styles).forEach((prop) => {\n    if ((el.style as any)[prop] !== styles[prop]) {\n      (el.style as any)[prop] = styles[prop];\n    }\n  });\n  return el;\n};\n\n/**\n * parse config\n */\nexport function parseLabelConfig(configStr?: string) {\n  if (configStr) {\n    try {\n      const labelConfig = JSON.parse(Base64.decode(configStr));\n      return labelConfig;\n    } catch (e) {\n      // parse error\n    }\n  }\n  return undefined;\n}\n\nexport const verifyCurrentForm = (config: FormConfig, instance: Instance, current: number) => {\n  if (store.readonly) return { result: true };\n  const { updatedValues, updatedFields } = triggerForm(config, instance.attributes);\n  const index = updatedFields.findIndex((v) => v.required === true && v.readonly !== true && v.visible !== false && (v.defaultValue === undefined || v.defaultValue === ''));\n  if (index < 0) return { result: true, data: updatedValues };\n  const err = `${i18n.translate('DATA_ERROR_REQUIRED')} ${updatedFields[index].label}. Segment ${current + 1}`;\n  return { result: false, error: err };\n};\n\nexport const triggerForm = (config: FormConfig, values:{[key: string]: any} = {}) => {\n  const { fields: configFields, conditions = [], effects = [], rules = [] } = config;\n  const fields = (configFields || []).map((field) => ({\n    ...field,\n    ...values[field.name] !== undefined && {\n      defaultValue: values[field.name],\n    },\n  }));\n\n  const parsedValue = utils.parseFormFields(fields);\n  // trigger rule effects\n  const { updatedValues: triggerValues, updatedFields } = rules.reduce(\n    (acc, curr) => utils.ruleTrigger(\n      curr, acc.updatedFields, acc.updatedValues, fields, conditions, effects,\n    ),\n    { updatedFields: parsedValue.fields, updatedValues: parsedValue.initialValues },\n  );\n\n  const updatedValues = {\n    ...triggerValues\n  };\n  updatedFields.filter((f) => f.visible === false).forEach((f) => {\n    delete updatedValues[f.name];\n  });\n  return {\n    updatedValues,\n    updatedFields,\n  };\n};\n\nexport const fittingString = (_ctx: CanvasRenderingContext2D, _str: string, maxWidth: number) => {\n  let str = _str;\n  let strWidth = _ctx.measureText(str).width;\n  const ellipsis = '…';\n  const ellipsisWidth = _ctx.measureText(ellipsis).width;\n  if ((strWidth + ellipsisWidth) <= maxWidth) {\n    return str;\n  }\n  let len = str.length;\n  while ((strWidth + ellipsisWidth) >= maxWidth && len > 0) {\n    str = str.slice(0, len);\n    strWidth = _ctx.measureText(str).width;\n    len -= 1;\n  }\n  return str + ellipsis;\n};\n\nexport const drawRoundedRect = (rect: { x: number, y: number, width: number, height: number }, r: number, ctx: CanvasRenderingContext2D) => {\n  const ptA = { x: rect.x + r, y: rect.y };\n  const ptB = { x: rect.x + rect.width, y: rect.y };\n  const ptC = { x: rect.x + rect.width, y: rect.y + rect.height };\n  const ptD = { x: rect.x, y: rect.y + rect.height };\n  const ptE = { x: rect.x, y: rect.y };\n  ctx.beginPath();\n  ctx.moveTo(ptA.x, ptA.y);\n  ctx.arcTo(ptB.x, ptB.y, ptC.x, ptC.y, r);\n  ctx.arcTo(ptC.x, ptC.y, ptD.x, ptD.y, r);\n  ctx.arcTo(ptD.x, ptD.y, ptE.x, ptE.y, r);\n  ctx.arcTo(ptE.x, ptE.y, ptA.x, ptA.y, r);\n  ctx.closePath();\n  ctx.fill();\n};\n\nexport const verifyForm = (config: FormConfig, attributes:{[key: string]: any} = {}) => {\n  if (store.readonly) return { result: true };\n  const { updatedValues, updatedFields } = triggerForm(config, attributes);\n  const index = updatedFields.findIndex((v) => v.required === true && v.readonly !== true && v.visible !== false && (v.defaultValue === undefined || v.defaultValue === ''));\n  return { result: index < 0, data: updatedValues };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}