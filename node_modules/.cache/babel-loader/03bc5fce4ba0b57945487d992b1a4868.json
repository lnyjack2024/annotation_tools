{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/advertisement-annotation/AnnotationForm.jsx\";\n/* eslint-disable jsx-a11y/label-has-associated-control */\n/* eslint-disable no-nested-ternary */\nimport React from 'react';\nimport { Card, Radio, Cascader, Button, Tag, Input } from 'antd';\nimport { formatTime, simpleClone, parseTime } from './util';\nimport AdvertisementNameSelect from './AdvertisementNameSelect';\nimport { getDeltaTime } from './AnnotationCanvas';\nimport './index.scss';\nimport { isAnnotationReadonly } from '../../utils/tool-mode';\nexport const MIN_SEGMENT_LENGTH = 0.1;\nexport const UNDEFINED_COLOR = '#dddddd';\nexport const FOCUS_COLOR = '#f5f5f5';\nexport const FPS = 20;\nclass AnnotationForm extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      tempOption: null,\n      historySelect: [],\n      currentFocus: null,\n      currentFocusValue: '',\n      currentTimestampType: null\n    };\n    this.snapshotPlaceholder = null;\n  }\n  handleSelectChange(e, type, key) {\n    const {\n      results,\n      currentMode,\n      currentIndex,\n      canvas,\n      advertisementNameMap\n    } = this.props;\n    const {\n      historySelect\n    } = this.state;\n    const resultsCopy = simpleClone(results);\n    const item = this.getResult(resultsCopy, key);\n    const hisotryCopy = simpleClone(historySelect);\n    // let currStorage;\n    switch (type) {\n      case 'name':\n        {\n          this.setState({\n            tempOption: null\n          });\n          if (currentMode !== 'edit') break;\n          if (!advertisementNameMap.has(e)) {\n            break;\n            //this.props.addAdvertisementName(e);\n          }\n          item.name = e;\n          // resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          this.props.handleResultsChange(resultsCopy);\n          const eIndex = hisotryCopy.indexOf(e);\n          if (eIndex !== -1) hisotryCopy.splice(hisotryCopy.indexOf(e), 1);\n          if (hisotryCopy.length === 5) hisotryCopy.pop();\n          hisotryCopy.unshift(e);\n          this.setState({\n            historySelect: hisotryCopy\n          });\n          break;\n        }\n      case 'type':\n        if (currentMode !== 'edit') break;\n        item.type = e;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      default:\n        break;\n    }\n  }\n  handleSelectBlur() {\n    this.setState({\n      tempOption: null\n    });\n  }\n  handleSelectSearch(e) {\n    this.setState({\n      tempOption: e\n    });\n  }\n  handleTimestampFocus(e, key, type) {\n    window.disableAdvertisementHotKeys = true;\n    this.setState({\n      currentFocus: key,\n      currentTimestampType: type,\n      currentFocusValue: e.target.value\n    });\n  }\n  getResult(results, key) {\n    return results.find(r => r.key === key);\n  }\n  async handleTimestampBlur(e, key, type) {\n    const {\n      results,\n      canvas,\n      toolMode\n    } = this.props;\n    if (isAnnotationReadonly(toolMode)) return;\n    const resultsCopy = simpleClone(results);\n    const item = this.getResult(resultsCopy, key);\n    let start = item === null || item === void 0 ? void 0 : item.start;\n    let end = item === null || item === void 0 ? void 0 : item.end;\n    let startChanged = false;\n    let endChanged = false;\n    if (type === 'start') {\n      const newStart = parseTime(e.target.value);\n      if (newStart && (!end || newStart < end)) {\n        start = newStart;\n        startChanged = true;\n      }\n    } else if (type === 'end') {\n      const newEnd = parseTime(e.target.value);\n      if (newEnd && (!start || newEnd > start)) {\n        end = newEnd;\n        endChanged = true;\n      }\n    }\n    if (startChanged || endChanged) {\n      this.pauseVideo();\n      if (startChanged) {\n        canvas.video.currentTime = start;\n      } else if (endChanged) {\n        canvas.video.currentTime = end;\n      }\n      item.start = start;\n      item.end = end;\n      this.props.handleResultsChange(resultsCopy);\n    }\n    this.setState({\n      currentFocus: null,\n      currentTimestampType: null,\n      currentFocusValue: ''\n    });\n    window.disableAdvertisementHotKeys = false;\n  }\n  getMaxKey(results) {\n    const keys = (results || []).map(r => r.key);\n    const maxKey = keys.reduce((a, b) => Math.max(a, b), 0);\n    return maxKey;\n  }\n  async handleButtonClick(e, type, key) {\n    e.stopPropagation();\n    e.preventDefault();\n    const {\n      results,\n      currentTime,\n      canvas,\n      currentMode,\n      toolMode,\n      setCurrentIndex,\n      currentIndex\n    } = this.props;\n    if (isAnnotationReadonly(toolMode)) return;\n    const resultsCopy = simpleClone(results) || [];\n    const item = this.getResult(resultsCopy, key);\n    const maxKey = this.getMaxKey(resultsCopy);\n    switch (type) {\n      case 'delete':\n        if (currentMode === 'edit') {\n          // resultsCopy.splice(index, 1);\n          for (let i = 0; i < resultsCopy.length; i += 1) {\n            if (resultsCopy[i].key === key) {\n              resultsCopy.splice(i, 1);\n              break;\n            }\n          }\n          this.pauseVideo();\n          this.props.setCurrentIndex();\n        } else {\n          this.props.disableSVG();\n          item.position = null;\n          // resultsCopy[index].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          setCurrentIndex(null);\n        }\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'add':\n        if (currentMode !== 'edit') break;\n        const newKey = maxKey + 1;\n        resultsCopy.push({\n          key: newKey,\n          name: undefined,\n          type: [],\n          position: [],\n          start: null,\n          end: null,\n          qaState: 'unchecked',\n          qaComment: null,\n          qaReason: null\n        });\n        this.pauseVideo();\n        this.props.handleResultsChange(resultsCopy).then(() => {\n          this.props.setCurrentIndex(newKey);\n        });\n        break;\n      case 'currentStart':\n        if (currentMode !== 'edit') break;\n        if (item.end != null && item.end <= currentTime + MIN_SEGMENT_LENGTH) break;\n        if (currentTime == null) break;\n        if (item.start !== currentTime) {\n          item.start = currentTime;\n          this.pauseVideo();\n          const imageUrl = await this.props.canvas.generateImageUrl(currentTime);\n          item.snapshot = imageUrl;\n          this.props.handleResultsChange(resultsCopy);\n        }\n        break;\n      case 'currentEnd':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        if (item.start != null && item.start >= currentTime - MIN_SEGMENT_LENGTH) break;\n        item.end = currentTime;\n        this.props.handleResultsChange(resultsCopy);\n        this.pauseVideo();\n        break;\n      case 'removeStart':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        item.start = null;\n        item.snapshot = null;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'removeEnd':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        item.end = null;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'paint':\n        if (currentMode === 'edit') {\n          this.props.enableSVG(item.key);\n          this.pauseVideo();\n        } else {\n          // resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          this.props.handleResultsChange(resultsCopy);\n          this.props.disableSVG();\n        }\n        break;\n      case 'copy':\n        {\n          const newItem = JSON.parse(JSON.stringify(item));\n          newItem.key = this.getMaxKey(results) + 1;\n          newItem.position = [];\n          resultsCopy.push(newItem);\n          this.props.handleResultsChange(resultsCopy).then(resolve => {\n            this.pauseVideo();\n            this.props.enableSVG(newItem.key);\n          });\n          break;\n        }\n      default:\n        break;\n    }\n  }\n  handleCardClick(e, key) {\n    this.props.setCurrentIndex(key);\n  }\n  pauseVideo() {\n    const {\n      canvas\n    } = this.props;\n    if (canvas && canvas.video) canvas.video.pause();\n  }\n  render() {\n    const {\n      tempOption,\n      historySelect\n    } = this.state;\n    const {\n      results,\n      advertisementName,\n      advertisementType,\n      currentTime,\n      currentMode,\n      currentIndex,\n      canvas,\n      currentPlayBackRate,\n      advertisementNameMap,\n      toolMode\n    } = this.props;\n    const currentItem = this.getResult(results, currentIndex);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"annotation-form-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"annotation-form-card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"video-currentTime\",\n      size: \"small\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }\n    }, formatTime(currentTime)), /*#__PURE__*/React.createElement(Radio.Group, {\n      className: \"video-playBackRate\",\n      onChange: e => this.props.setCurrentPlayBackRate(e.target.value),\n      defaultValue: 1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Radio.Button, {\n      value: 0.25,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 13\n      }\n    }, \"X0.25\"), /*#__PURE__*/React.createElement(Radio.Button, {\n      value: 0.5,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 13\n      }\n    }, \"X0.5\"), /*#__PURE__*/React.createElement(Radio.Button, {\n      value: 1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 13\n      }\n    }, \"X1\"), /*#__PURE__*/React.createElement(Radio.Button, {\n      value: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 13\n      }\n    }, \"X2\"), /*#__PURE__*/React.createElement(Radio.Button, {\n      value: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 13\n      }\n    }, \"X4\")), /*#__PURE__*/React.createElement(Button, {\n      className: \"annotation-form-button\",\n      onClick: e => this.handleButtonClick(e, 'add'),\n      type: \"primary\",\n      block: true,\n      disabled: isAnnotationReadonly(toolMode),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 11\n      }\n    }, \"\\u65B0\\u589E\\u6807\\u6CE8\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"annotation-form-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }\n    }, results.reduceRight((arr, item, index) => {\n      var _item$type, _item$position;\n      arr.push(item.start == null || item.end == null || item.start <= currentTime + getDeltaTime(currentPlayBackRate) && item.end >= currentTime - getDeltaTime(currentPlayBackRate) ? /*#__PURE__*/React.createElement(Card\n      // eslint-disable-next-line react/no-array-index-key\n      , {\n        key: item.key,\n        className: `annotation-form-card annotation-form-card-${item.key}`,\n        style: {\n          border: currentIndex === item.key ? '1px solid #1890ff' : null\n        },\n        onClick: e => this.handleCardClick(e, item.key),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisement-attribute-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"advertisement-attribute-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 23\n        }\n      }, \"\\u8BC6\\u522B\\u7ED3\\u679C\"), /*#__PURE__*/React.createElement(AdvertisementNameSelect, {\n        index: item.key,\n        historySelect: historySelect,\n        handleSelectChange: this.handleSelectChange.bind(this),\n        handleSelectSearch: this.handleSelectSearch.bind(this),\n        handleSelectBlur: this.handleSelectBlur.bind(this),\n        item: item,\n        advertisementName: advertisementName,\n        advertisementNameMap: advertisementNameMap,\n        tempOption: tempOption,\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisement-attribute-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"advertisement-attribute-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 23\n        }\n      }, \"\\u5E7F\\u544A\\u5F62\\u5F0F\"), /*#__PURE__*/React.createElement(Cascader, {\n        showSearch: true,\n        className: \"advertisement-attribute-select\",\n        options: advertisementType,\n        placeholder: \"\\u9009\\u62E9\\u5E7F\\u544A\\u5F62\\u5F0F\",\n        onChange: e => this.handleSelectChange(e, 'type', item.key),\n        defaultValue: item.type,\n        getPopupContainer: () => document.getElementById('root'),\n        disabled: isAnnotationReadonly(toolMode),\n        onFocus: () => window.disableAdvertisementHotKeys = true,\n        onBlur: () => window.disableAdvertisementHotKeys = false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisement-attribute-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"advertisement-attribute-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 23\n        }\n      }, \"\\u5F00\\u59CB\\u65F6\\u95F4\"), /*#__PURE__*/React.createElement(\"input\", {\n        disabled: isAnnotationReadonly(toolMode),\n        className: \"advertisement-timestamp\",\n        value: this.state.currentFocus === item.key && this.state.currentTimestampType === 'start' ? this.state.currentFocusValue : formatTime(item.start),\n        onFocus: e => this.handleTimestampFocus(e, item.key, 'start'),\n        onBlur: e => this.handleTimestampBlur(e, item.key, 'start'),\n        onChange: e => {\n          this.setState({\n            currentFocusValue: e.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 23\n        }\n      }), /*#__PURE__*/React.createElement(Button, {\n        className: \"advertisement-timestamp-reset\",\n        onClick: e => this.handleButtonClick(e, 'currentStart', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 23\n        }\n      }, \"\\u221A\"), /*#__PURE__*/React.createElement(Button, {\n        className: \"advertisement-timestamp-reset\",\n        onClick: e => this.handleButtonClick(e, 'removeStart', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 23\n        }\n      }, \"x\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisement-attribute-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"advertisement-attribute-label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 23\n        }\n      }, \"\\u7ED3\\u675F\\u65F6\\u95F4\"), /*#__PURE__*/React.createElement(\"input\", {\n        /*readOnly*/\n        disabled: isAnnotationReadonly(toolMode),\n        className: \"advertisement-timestamp\"\n        /*value={formatTime(item.end)}*/,\n        value: this.state.currentFocus === item.key && this.state.currentTimestampType === 'end' ? this.state.currentFocusValue : formatTime(item.end),\n        onFocus: e => this.handleTimestampFocus(e, item.key, 'end'),\n        onBlur: e => this.handleTimestampBlur(e, item.key, 'end'),\n        onChange: e => {\n          this.setState({\n            currentFocusValue: e.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 23\n        }\n      }), /*#__PURE__*/React.createElement(Button, {\n        className: \"advertisement-timestamp-reset\",\n        onClick: e => this.handleButtonClick(e, 'currentEnd', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 23\n        }\n      }, \"\\u221A\"), /*#__PURE__*/React.createElement(Button, {\n        className: \"advertisement-timestamp-reset\",\n        onClick: e => this.handleButtonClick(e, 'removeEnd', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 23\n        }\n      }, \"x\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisement-attribute-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"advertisement-index\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 23\n        }\n      }, item.name == null || !((_item$type = item.type) === null || _item$type === void 0 ? void 0 : _item$type.length) || item.end == null || item.start == null || !((_item$position = item.position) === null || _item$position === void 0 ? void 0 : _item$position.length) ? /*#__PURE__*/React.createElement(Tag, {\n        style: {\n          backgroundColor: `${UNDEFINED_COLOR}40`,\n          borderColor: UNDEFINED_COLOR\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 29\n        }\n      }, `ID: ${item.key}未完成`) : item.qaState === 'unchecked' ? /*#__PURE__*/React.createElement(Tag, {\n        color: \"gold\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 31\n        }\n      }, `ID: ${item.key}待质检`) : item.qaState === 'accepted' ? /*#__PURE__*/React.createElement(Tag, {\n        color: \"green\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 33\n        }\n      }, `ID: ${item.key}已通过`) : /*#__PURE__*/React.createElement(Tag, {\n        color: \"red\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 33\n        }\n      }, `ID: ${item.key}被驳回`)), /*#__PURE__*/React.createElement(Button, {\n        className: \"annotation-form-button-right\",\n        onClick: e => this.handleButtonClick(e, 'delete', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 23\n        }\n      }, \"\\u5220\\u9664\"), /*#__PURE__*/React.createElement(Button, {\n        className: \"annotation-form-button-right\",\n        onClick: e => this.handleButtonClick(e, 'copy', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 23\n        }\n      }, \"\\u590D\\u5236\"), /*#__PURE__*/React.createElement(Button, {\n        className: \"annotation-form-button-right\",\n        onClick: e => this.handleButtonClick(e, 'paint', item.key),\n        disabled: isAnnotationReadonly(toolMode),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 23\n        }\n      }, \"\\u6807\\u8BB0\\u4F4D\\u7F6E\"))) : null);\n      return arr;\n    }, []), currentMode !== 'edit' && currentIndex != null && (currentItem === null || currentItem === void 0 ? void 0 : currentItem.position) != null ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"annotation-form-buttons-float\",\n      style: {\n        left: `${(Math.max(currentItem === null || currentItem === void 0 ? void 0 : currentItem.position[0], currentItem === null || currentItem === void 0 ? void 0 : currentItem.position[2]) * (canvas ? canvas.width : 0) || -5) + (canvas ? canvas.container.offsetLeft : 0) + 5}px`,\n        top: `${(Math.max(currentItem === null || currentItem === void 0 ? void 0 : currentItem.position[1], currentItem === null || currentItem === void 0 ? void 0 : currentItem.position[3]) * (canvas ? canvas.height : 0) || 60) + (canvas ? canvas.container.offsetTop : 0) - 60}px`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"annotation-form-button-float\",\n      onClick: e => this.handleButtonClick(e, 'paint', currentIndex),\n      size: \"small\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 19\n      }\n    }, currentMode === 'edit' ? '标记位置' : '确定'), /*#__PURE__*/React.createElement(Button, {\n      className: \"annotation-form-button-float\",\n      onClick: e => this.handleButtonClick(e, 'copy', currentIndex),\n      size: \"small\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 19\n      }\n    }, \"\\u590D\\u5236\")) : null));\n  }\n}\nexport default AnnotationForm;","map":{"version":3,"names":["React","Card","Radio","Cascader","Button","Tag","Input","formatTime","simpleClone","parseTime","AdvertisementNameSelect","getDeltaTime","isAnnotationReadonly","MIN_SEGMENT_LENGTH","UNDEFINED_COLOR","FOCUS_COLOR","FPS","AnnotationForm","Component","constructor","state","tempOption","historySelect","currentFocus","currentFocusValue","currentTimestampType","snapshotPlaceholder","handleSelectChange","e","type","key","results","currentMode","currentIndex","canvas","advertisementNameMap","props","resultsCopy","item","getResult","hisotryCopy","setState","has","name","handleResultsChange","eIndex","indexOf","splice","length","pop","unshift","handleSelectBlur","handleSelectSearch","handleTimestampFocus","window","disableAdvertisementHotKeys","target","value","find","r","handleTimestampBlur","toolMode","start","end","startChanged","endChanged","newStart","newEnd","pauseVideo","video","currentTime","getMaxKey","keys","map","maxKey","reduce","a","b","Math","max","handleButtonClick","stopPropagation","preventDefault","setCurrentIndex","i","disableSVG","position","newKey","push","undefined","qaState","qaComment","qaReason","then","imageUrl","generateImageUrl","snapshot","enableSVG","newItem","JSON","parse","stringify","resolve","handleCardClick","pause","render","advertisementName","advertisementType","currentPlayBackRate","currentItem","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","size","Group","onChange","setCurrentPlayBackRate","defaultValue","onClick","block","disabled","reduceRight","arr","index","_item$type","_item$position","style","border","bind","showSearch","options","placeholder","getPopupContainer","document","getElementById","onFocus","onBlur","backgroundColor","borderColor","color","left","width","container","offsetLeft","top","height","offsetTop"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/advertisement-annotation/AnnotationForm.jsx"],"sourcesContent":["/* eslint-disable jsx-a11y/label-has-associated-control */\n/* eslint-disable no-nested-ternary */\nimport React from 'react';\nimport {Card, Radio, Cascader, Button, Tag, Input} from 'antd';\nimport { formatTime, simpleClone, parseTime } from './util';\nimport AdvertisementNameSelect from './AdvertisementNameSelect';\nimport { getDeltaTime } from './AnnotationCanvas';\nimport './index.scss';\nimport { isAnnotationReadonly } from '../../utils/tool-mode';\n\nexport const MIN_SEGMENT_LENGTH = 0.1;\nexport const UNDEFINED_COLOR = '#dddddd';\nexport const FOCUS_COLOR = '#f5f5f5';\nexport const FPS = 20;\n\nclass AnnotationForm extends React.Component {\n  constructor() {\n    super();\n    this.state = ({\n      tempOption: null,\n      historySelect: [],\n      currentFocus: null,\n      currentFocusValue: '',\n      currentTimestampType: null,\n    });\n    this.snapshotPlaceholder = null;\n  }\n\n  handleSelectChange(e, type, key) {\n    const { results, currentMode, currentIndex, canvas, advertisementNameMap } = this.props;\n    const { historySelect } = this.state;\n    const resultsCopy = simpleClone(results);\n    const item = this.getResult(resultsCopy, key);\n    const hisotryCopy = simpleClone(historySelect);\n    // let currStorage;\n    switch (type) {\n      case 'name': {\n        this.setState({ tempOption: null });\n        if (currentMode !== 'edit') break;\n        if (!advertisementNameMap.has(e)) {\n          break;\n          //this.props.addAdvertisementName(e);\n        }\n        item.name = e;\n        // resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n        this.props.handleResultsChange(resultsCopy);\n\n        const eIndex = hisotryCopy.indexOf(e);\n        if (eIndex !== -1) hisotryCopy.splice(hisotryCopy.indexOf(e), 1);\n        if (hisotryCopy.length === 5) hisotryCopy.pop();\n        hisotryCopy.unshift(e);\n        this.setState({\n          historySelect: hisotryCopy,\n        });\n        break;\n      }\n      case 'type':\n        if (currentMode !== 'edit') break;\n        item.type = e;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      default:\n        break;\n    }\n  }\n\n  handleSelectBlur() {\n    this.setState({ tempOption: null });\n  }\n\n  handleSelectSearch(e) {\n    this.setState({ tempOption: e });\n  }\n\n  handleTimestampFocus(e, key, type) {\n    window.disableAdvertisementHotKeys = true;\n    this.setState({ currentFocus: key, currentTimestampType: type, currentFocusValue: e.target.value });\n  }\n\n  getResult(results, key) {\n    return results.find(r => r.key === key);\n  }\n\n  async handleTimestampBlur(e, key, type) {\n    const { results, canvas, toolMode } = this.props;\n    if (isAnnotationReadonly(toolMode)) return;\n    const resultsCopy = simpleClone(results);\n    const item = this.getResult(resultsCopy, key);\n    let start = item?.start;\n    let end = item?.end;\n    let startChanged = false;\n    let endChanged = false;\n    if (type === 'start') {\n      const newStart = parseTime(e.target.value);\n      if (newStart && (!end || newStart < end)) {\n        start = newStart;\n        startChanged = true;\n      }\n    } else if (type === 'end') {\n      const newEnd = parseTime(e.target.value);\n      if (newEnd && (!start || newEnd > start)) {\n        end = newEnd;\n        endChanged = true;\n      }\n    }\n    if (startChanged || endChanged) {\n      this.pauseVideo();\n      if (startChanged) {\n        canvas.video.currentTime = start;\n      } else if (endChanged) {\n        canvas.video.currentTime = end;\n      }\n      item.start = start;\n      item.end = end;\n      this.props.handleResultsChange(resultsCopy);\n    }\n    this.setState({ currentFocus: null, currentTimestampType: null, currentFocusValue: '' });\n    window.disableAdvertisementHotKeys = false;\n  }\n\n  getMaxKey(results) {\n    const keys = (results || []).map(r => r.key);\n    const maxKey = keys.reduce((a, b) => Math.max(a, b), 0);\n    return maxKey;\n  }\n\n  async handleButtonClick(e, type, key) {\n    e.stopPropagation();\n    e.preventDefault();\n    const { results, currentTime, canvas, currentMode, toolMode, setCurrentIndex, currentIndex } = this.props;\n    if (isAnnotationReadonly(toolMode)) return;\n    const resultsCopy = simpleClone(results) || [];\n    const item = this.getResult(resultsCopy, key);\n    const maxKey = this.getMaxKey(resultsCopy);\n    switch (type) {\n      case 'delete':\n        if (currentMode === 'edit') {\n          // resultsCopy.splice(index, 1);\n          for (let i = 0; i < resultsCopy.length; i += 1) {\n            if (resultsCopy[i].key === key)  {\n              resultsCopy.splice(i, 1);\n              break;\n            }\n          }\n          this.pauseVideo();\n          this.props.setCurrentIndex();\n        } else {\n          this.props.disableSVG();\n          item.position = null;\n          // resultsCopy[index].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          setCurrentIndex(null);\n        }\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'add':\n        if (currentMode !== 'edit') break;\n        const newKey = maxKey + 1;\n        resultsCopy.push({\n          key: newKey,\n          name: undefined,\n          type: [],\n          position: [],\n          start: null,\n          end: null,\n          qaState: 'unchecked',\n          qaComment: null,\n          qaReason: null,\n        });\n        this.pauseVideo();\n        this.props.handleResultsChange(resultsCopy).then(() => {\n          this.props.setCurrentIndex(newKey);\n        });\n        break;\n      case 'currentStart':\n        if (currentMode !== 'edit') break;\n        if (item.end != null && item.end <= currentTime + MIN_SEGMENT_LENGTH) break;\n        if (currentTime == null) break;\n        if (item.start !== currentTime) {\n          item.start = currentTime;\n          this.pauseVideo();\n          const imageUrl = await this.props.canvas.generateImageUrl(currentTime);\n          item.snapshot = imageUrl;\n          this.props.handleResultsChange(resultsCopy);\n        }\n        break;\n      case 'currentEnd':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        if (item.start != null && item.start >= currentTime - MIN_SEGMENT_LENGTH) break;\n        item.end = currentTime;\n        this.props.handleResultsChange(resultsCopy);\n        this.pauseVideo();\n        break;\n      case 'removeStart':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        item.start = null;\n        item.snapshot = null;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'removeEnd':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        item.end = null;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'paint':\n        if (currentMode === 'edit') {\n          this.props.enableSVG(item.key);\n          this.pauseVideo();\n        } else {\n          // resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          this.props.handleResultsChange(resultsCopy);\n          this.props.disableSVG();\n        }\n        break;\n      case 'copy': {\n        const newItem = JSON.parse(JSON.stringify(item));\n        newItem.key = this.getMaxKey(results) + 1;\n        newItem.position = [];\n        resultsCopy.push(newItem);\n        this.props.handleResultsChange(resultsCopy).then((resolve) => {\n          this.pauseVideo();\n          this.props.enableSVG(newItem.key);\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  handleCardClick(e, key) {\n    this.props.setCurrentIndex(key);\n  }\n\n  pauseVideo() {\n    const { canvas } = this.props;\n    if (canvas && canvas.video) canvas.video.pause();\n  }\n\n  render() {\n    const { tempOption, historySelect } = this.state;\n    const {\n      results,\n      advertisementName,\n      advertisementType,\n      currentTime,\n      currentMode,\n      currentIndex,\n      canvas,\n      currentPlayBackRate,\n      advertisementNameMap,\n      toolMode,\n    } = this.props;\n    const currentItem = this.getResult(results, currentIndex);\n    return (\n      <div className=\"annotation-form-wrapper\">\n        <Card className=\"annotation-form-card\">\n          <Card className=\"video-currentTime\" size=\"small\">\n            {formatTime(currentTime)}\n          </Card>\n          <Radio.Group\n            className=\"video-playBackRate\"\n            onChange={(e) => this.props.setCurrentPlayBackRate(e.target.value)}\n            defaultValue={1}\n          >\n            <Radio.Button value={0.25}>\n              X0.25\n            </Radio.Button>\n            <Radio.Button value={0.5}>\n              X0.5\n            </Radio.Button>\n            <Radio.Button value={1}>\n              X1\n            </Radio.Button>\n            <Radio.Button value={2}>\n              X2\n            </Radio.Button>\n            <Radio.Button value={4}>\n              X4\n            </Radio.Button>\n          </Radio.Group>\n          <Button\n            className=\"annotation-form-button\"\n            onClick={(e) => this.handleButtonClick(e, 'add')}\n            type=\"primary\"\n            block\n            disabled={isAnnotationReadonly(toolMode)}\n          >\n            新增标注\n          </Button>\n        </Card>\n        <div className=\"annotation-form-container\">\n          {results.reduceRight((arr, item, index) => {\n            arr.push(\n              ((item.start == null || item.end == null) || (item.start <= currentTime + getDeltaTime(currentPlayBackRate) && item.end >= currentTime - getDeltaTime(currentPlayBackRate)))\n                ? (\n                  <Card\n                    // eslint-disable-next-line react/no-array-index-key\n                    key={item.key}\n                    className={`annotation-form-card annotation-form-card-${item.key}`}\n                    style={{ border: currentIndex === item.key ? '1px solid #1890ff' : null }}\n                    onClick={(e) => this.handleCardClick(e, item.key)}\n                  >\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        识别结果\n                      </label>\n                      <AdvertisementNameSelect\n                        index={item.key}\n                        historySelect={historySelect}\n                        handleSelectChange={this.handleSelectChange.bind(this)}\n                        handleSelectSearch={this.handleSelectSearch.bind(this)}\n                        handleSelectBlur={this.handleSelectBlur.bind(this)}\n                        item={item}\n                        advertisementName={advertisementName}\n                        advertisementNameMap={advertisementNameMap}\n                        tempOption={tempOption}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      />\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        广告形式\n                      </label>\n                      <Cascader\n                        showSearch\n                        className=\"advertisement-attribute-select\"\n                        options={advertisementType}\n                        placeholder=\"选择广告形式\"\n                        onChange={(e) => this.handleSelectChange(e, 'type', item.key)}\n                        defaultValue={item.type}\n                        getPopupContainer={() => document.getElementById('root')}\n                        disabled={isAnnotationReadonly(toolMode)}\n                        onFocus={() => window.disableAdvertisementHotKeys = true}\n                        onBlur={() => window.disableAdvertisementHotKeys = false}\n                      />\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        开始时间\n                      </label>\n                      <input\n                        disabled={isAnnotationReadonly(toolMode)}\n                        className=\"advertisement-timestamp\"\n                        value={ this.state.currentFocus === item.key && this.state.currentTimestampType === 'start' ? this.state.currentFocusValue : formatTime(item.start)}\n                        onFocus={ (e) => this.handleTimestampFocus(e, item.key, 'start') }\n                        onBlur={ (e) => this.handleTimestampBlur(e, item.key, 'start') }\n                        onChange={(e) => { this.setState({currentFocusValue: e.target.value})}}\n                      />\n                      {/*<input\n                        readOnly\n                        className=\"advertisement-timestamp\"\n                        value={formatTime(item.start)}\n                        onChange={(e) => {\n                          console.log('start time', e.target.value, formatTime(e.target.value));\n                          item.start = 123;\n                        }}\n                      />*/}\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'currentStart', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        √\n                      </Button>\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'removeStart', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        x\n                      </Button>\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        结束时间\n                      </label>\n                      <input\n                        /*readOnly*/\n                        disabled={isAnnotationReadonly(toolMode)}\n                        className=\"advertisement-timestamp\"\n                        /*value={formatTime(item.end)}*/\n                        value={ this.state.currentFocus === item.key && this.state.currentTimestampType === 'end' ? this.state.currentFocusValue : formatTime(item.end)}\n                        onFocus={ (e) => this.handleTimestampFocus(e, item.key, 'end') }\n                        onBlur={ (e) => this.handleTimestampBlur(e, item.key, 'end') }\n                        onChange={(e) => { this.setState({currentFocusValue: e.target.value})}}\n                      />\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'currentEnd', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        √\n                      </Button>\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'removeEnd', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        x\n                      </Button>\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <div className=\"advertisement-index\">\n                        {(item.name == null || !item.type?.length || item.end == null || item.start == null || !item.position?.length)\n                          ? (\n                            <Tag style={{ backgroundColor: `${UNDEFINED_COLOR}40`, borderColor: UNDEFINED_COLOR }}>\n                              {`ID: ${item.key}未完成`}\n                            </Tag>\n                          )\n                          : (item.qaState === 'unchecked')\n                            ? (\n                              <Tag color=\"gold\">\n                                {`ID: ${item.key}待质检`}\n                              </Tag>\n                            )\n                            : (item.qaState === 'accepted')\n                              ? <Tag color=\"green\">{`ID: ${item.key}已通过`}</Tag>\n                              : <Tag color=\"red\">{`ID: ${item.key}被驳回`}</Tag>}\n                      </div>\n                      <Button\n                        className=\"annotation-form-button-right\"\n                        onClick={(e) => this.handleButtonClick(e, 'delete', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        删除\n                      </Button>\n                      <Button\n                        className=\"annotation-form-button-right\"\n                        onClick={(e) => this.handleButtonClick(e, 'copy', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        复制\n                      </Button>\n                      <Button\n                        className=\"annotation-form-button-right\"\n                        onClick={(e) => this.handleButtonClick(e, 'paint', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        标记位置\n                      </Button>\n                    </div>\n                  </Card>\n                )\n                : null\n            );\n            return arr;\n          }, [])}\n          {\n            currentMode !== 'edit' && currentIndex != null && currentItem?.position != null\n              ? (\n                <div\n                  className=\"annotation-form-buttons-float\"\n                  style={{\n                    left: `${(Math.max(currentItem?.position[0], currentItem?.position[2]) * (canvas ? canvas.width : 0) || -5) + (canvas ? canvas.container.offsetLeft : 0) + 5}px`,\n                    top: `${(Math.max(currentItem?.position[1], currentItem?.position[3]) * (canvas ? canvas.height : 0) || 60) + (canvas ? canvas.container.offsetTop : 0) - 60}px`,\n                  }}\n                >\n                  <Button\n                    className=\"annotation-form-button-float\"\n                    onClick={(e) => this.handleButtonClick(e, 'paint', currentIndex)}\n                    size=\"small\"\n                  >\n                    {currentMode === 'edit' ? '标记位置' : '确定'}\n                  </Button>\n                  <Button\n                    className=\"annotation-form-button-float\"\n                    onClick={(e) => this.handleButtonClick(e, 'copy', currentIndex)}\n                    size=\"small\"\n                  >\n                    复制\n                  </Button>\n                  {/*<Button\n                    className=\"annotation-form-button-float\"\n                    onClick={(e) => this.handleButtonClick(e, 'delete', currentIndex)}\n                    size=\"small\"\n                  >\n                    删除\n                  </Button>*/}\n                </div>\n              )\n              : null\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AnnotationForm;\n"],"mappings":";AAAA;AACA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAAQC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,GAAG,EAAEC,KAAK,QAAO,MAAM;AAC9D,SAASC,UAAU,EAAEC,WAAW,EAAEC,SAAS,QAAQ,QAAQ;AAC3D,OAAOC,uBAAuB,MAAM,2BAA2B;AAC/D,SAASC,YAAY,QAAQ,oBAAoB;AACjD,OAAO,cAAc;AACrB,SAASC,oBAAoB,QAAQ,uBAAuB;AAE5D,OAAO,MAAMC,kBAAkB,GAAG,GAAG;AACrC,OAAO,MAAMC,eAAe,GAAG,SAAS;AACxC,OAAO,MAAMC,WAAW,GAAG,SAAS;AACpC,OAAO,MAAMC,GAAG,GAAG,EAAE;AAErB,MAAMC,cAAc,SAASjB,KAAK,CAACkB,SAAS,CAAC;EAC3CC,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IACP,IAAI,CAACC,KAAK,GAAI;MACZC,UAAU,EAAE,IAAI;MAChBC,aAAa,EAAE,EAAE;MACjBC,YAAY,EAAE,IAAI;MAClBC,iBAAiB,EAAE,EAAE;MACrBC,oBAAoB,EAAE;IACxB,CAAE;IACF,IAAI,CAACC,mBAAmB,GAAG,IAAI;EACjC;EAEAC,kBAAkBA,CAACC,CAAC,EAAEC,IAAI,EAAEC,GAAG,EAAE;IAC/B,MAAM;MAAEC,OAAO;MAAEC,WAAW;MAAEC,YAAY;MAAEC,MAAM;MAAEC;IAAqB,CAAC,GAAG,IAAI,CAACC,KAAK;IACvF,MAAM;MAAEd;IAAc,CAAC,GAAG,IAAI,CAACF,KAAK;IACpC,MAAMiB,WAAW,GAAG7B,WAAW,CAACuB,OAAO,CAAC;IACxC,MAAMO,IAAI,GAAG,IAAI,CAACC,SAAS,CAACF,WAAW,EAAEP,GAAG,CAAC;IAC7C,MAAMU,WAAW,GAAGhC,WAAW,CAACc,aAAa,CAAC;IAC9C;IACA,QAAQO,IAAI;MACV,KAAK,MAAM;QAAE;UACX,IAAI,CAACY,QAAQ,CAAC;YAAEpB,UAAU,EAAE;UAAK,CAAC,CAAC;UACnC,IAAIW,WAAW,KAAK,MAAM,EAAE;UAC5B,IAAI,CAACG,oBAAoB,CAACO,GAAG,CAACd,CAAC,CAAC,EAAE;YAChC;YACA;UACF;UACAU,IAAI,CAACK,IAAI,GAAGf,CAAC;UACb;UACA,IAAI,CAACQ,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;UAE3C,MAAMQ,MAAM,GAAGL,WAAW,CAACM,OAAO,CAAClB,CAAC,CAAC;UACrC,IAAIiB,MAAM,KAAK,CAAC,CAAC,EAAEL,WAAW,CAACO,MAAM,CAACP,WAAW,CAACM,OAAO,CAAClB,CAAC,CAAC,EAAE,CAAC,CAAC;UAChE,IAAIY,WAAW,CAACQ,MAAM,KAAK,CAAC,EAAER,WAAW,CAACS,GAAG,CAAC,CAAC;UAC/CT,WAAW,CAACU,OAAO,CAACtB,CAAC,CAAC;UACtB,IAAI,CAACa,QAAQ,CAAC;YACZnB,aAAa,EAAEkB;UACjB,CAAC,CAAC;UACF;QACF;MACA,KAAK,MAAM;QACT,IAAIR,WAAW,KAAK,MAAM,EAAE;QAC5BM,IAAI,CAACT,IAAI,GAAGD,CAAC;QACb,IAAI,CAACQ,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;QAC3C;MACF;QACE;IACJ;EACF;EAEAc,gBAAgBA,CAAA,EAAG;IACjB,IAAI,CAACV,QAAQ,CAAC;MAAEpB,UAAU,EAAE;IAAK,CAAC,CAAC;EACrC;EAEA+B,kBAAkBA,CAACxB,CAAC,EAAE;IACpB,IAAI,CAACa,QAAQ,CAAC;MAAEpB,UAAU,EAAEO;IAAE,CAAC,CAAC;EAClC;EAEAyB,oBAAoBA,CAACzB,CAAC,EAAEE,GAAG,EAAED,IAAI,EAAE;IACjCyB,MAAM,CAACC,2BAA2B,GAAG,IAAI;IACzC,IAAI,CAACd,QAAQ,CAAC;MAAElB,YAAY,EAAEO,GAAG;MAAEL,oBAAoB,EAAEI,IAAI;MAAEL,iBAAiB,EAAEI,CAAC,CAAC4B,MAAM,CAACC;IAAM,CAAC,CAAC;EACrG;EAEAlB,SAASA,CAACR,OAAO,EAAED,GAAG,EAAE;IACtB,OAAOC,OAAO,CAAC2B,IAAI,CAACC,CAAC,IAAIA,CAAC,CAAC7B,GAAG,KAAKA,GAAG,CAAC;EACzC;EAEA,MAAM8B,mBAAmBA,CAAChC,CAAC,EAAEE,GAAG,EAAED,IAAI,EAAE;IACtC,MAAM;MAAEE,OAAO;MAAEG,MAAM;MAAE2B;IAAS,CAAC,GAAG,IAAI,CAACzB,KAAK;IAChD,IAAIxB,oBAAoB,CAACiD,QAAQ,CAAC,EAAE;IACpC,MAAMxB,WAAW,GAAG7B,WAAW,CAACuB,OAAO,CAAC;IACxC,MAAMO,IAAI,GAAG,IAAI,CAACC,SAAS,CAACF,WAAW,EAAEP,GAAG,CAAC;IAC7C,IAAIgC,KAAK,GAAGxB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEwB,KAAK;IACvB,IAAIC,GAAG,GAAGzB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEyB,GAAG;IACnB,IAAIC,YAAY,GAAG,KAAK;IACxB,IAAIC,UAAU,GAAG,KAAK;IACtB,IAAIpC,IAAI,KAAK,OAAO,EAAE;MACpB,MAAMqC,QAAQ,GAAGzD,SAAS,CAACmB,CAAC,CAAC4B,MAAM,CAACC,KAAK,CAAC;MAC1C,IAAIS,QAAQ,KAAK,CAACH,GAAG,IAAIG,QAAQ,GAAGH,GAAG,CAAC,EAAE;QACxCD,KAAK,GAAGI,QAAQ;QAChBF,YAAY,GAAG,IAAI;MACrB;IACF,CAAC,MAAM,IAAInC,IAAI,KAAK,KAAK,EAAE;MACzB,MAAMsC,MAAM,GAAG1D,SAAS,CAACmB,CAAC,CAAC4B,MAAM,CAACC,KAAK,CAAC;MACxC,IAAIU,MAAM,KAAK,CAACL,KAAK,IAAIK,MAAM,GAAGL,KAAK,CAAC,EAAE;QACxCC,GAAG,GAAGI,MAAM;QACZF,UAAU,GAAG,IAAI;MACnB;IACF;IACA,IAAID,YAAY,IAAIC,UAAU,EAAE;MAC9B,IAAI,CAACG,UAAU,CAAC,CAAC;MACjB,IAAIJ,YAAY,EAAE;QAChB9B,MAAM,CAACmC,KAAK,CAACC,WAAW,GAAGR,KAAK;MAClC,CAAC,MAAM,IAAIG,UAAU,EAAE;QACrB/B,MAAM,CAACmC,KAAK,CAACC,WAAW,GAAGP,GAAG;MAChC;MACAzB,IAAI,CAACwB,KAAK,GAAGA,KAAK;MAClBxB,IAAI,CAACyB,GAAG,GAAGA,GAAG;MACd,IAAI,CAAC3B,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;IAC7C;IACA,IAAI,CAACI,QAAQ,CAAC;MAAElB,YAAY,EAAE,IAAI;MAAEE,oBAAoB,EAAE,IAAI;MAAED,iBAAiB,EAAE;IAAG,CAAC,CAAC;IACxF8B,MAAM,CAACC,2BAA2B,GAAG,KAAK;EAC5C;EAEAgB,SAASA,CAACxC,OAAO,EAAE;IACjB,MAAMyC,IAAI,GAAG,CAACzC,OAAO,IAAI,EAAE,EAAE0C,GAAG,CAACd,CAAC,IAAIA,CAAC,CAAC7B,GAAG,CAAC;IAC5C,MAAM4C,MAAM,GAAGF,IAAI,CAACG,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKC,IAAI,CAACC,GAAG,CAACH,CAAC,EAAEC,CAAC,CAAC,EAAE,CAAC,CAAC;IACvD,OAAOH,MAAM;EACf;EAEA,MAAMM,iBAAiBA,CAACpD,CAAC,EAAEC,IAAI,EAAEC,GAAG,EAAE;IACpCF,CAAC,CAACqD,eAAe,CAAC,CAAC;IACnBrD,CAAC,CAACsD,cAAc,CAAC,CAAC;IAClB,MAAM;MAAEnD,OAAO;MAAEuC,WAAW;MAAEpC,MAAM;MAAEF,WAAW;MAAE6B,QAAQ;MAAEsB,eAAe;MAAElD;IAAa,CAAC,GAAG,IAAI,CAACG,KAAK;IACzG,IAAIxB,oBAAoB,CAACiD,QAAQ,CAAC,EAAE;IACpC,MAAMxB,WAAW,GAAG7B,WAAW,CAACuB,OAAO,CAAC,IAAI,EAAE;IAC9C,MAAMO,IAAI,GAAG,IAAI,CAACC,SAAS,CAACF,WAAW,EAAEP,GAAG,CAAC;IAC7C,MAAM4C,MAAM,GAAG,IAAI,CAACH,SAAS,CAAClC,WAAW,CAAC;IAC1C,QAAQR,IAAI;MACV,KAAK,QAAQ;QACX,IAAIG,WAAW,KAAK,MAAM,EAAE;UAC1B;UACA,KAAK,IAAIoD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/C,WAAW,CAACW,MAAM,EAAEoC,CAAC,IAAI,CAAC,EAAE;YAC9C,IAAI/C,WAAW,CAAC+C,CAAC,CAAC,CAACtD,GAAG,KAAKA,GAAG,EAAG;cAC/BO,WAAW,CAACU,MAAM,CAACqC,CAAC,EAAE,CAAC,CAAC;cACxB;YACF;UACF;UACA,IAAI,CAAChB,UAAU,CAAC,CAAC;UACjB,IAAI,CAAChC,KAAK,CAAC+C,eAAe,CAAC,CAAC;QAC9B,CAAC,MAAM;UACL,IAAI,CAAC/C,KAAK,CAACiD,UAAU,CAAC,CAAC;UACvB/C,IAAI,CAACgD,QAAQ,GAAG,IAAI;UACpB;UACAH,eAAe,CAAC,IAAI,CAAC;QACvB;QACA,IAAI,CAAC/C,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;QAC3C;MACF,KAAK,KAAK;QACR,IAAIL,WAAW,KAAK,MAAM,EAAE;QAC5B,MAAMuD,MAAM,GAAGb,MAAM,GAAG,CAAC;QACzBrC,WAAW,CAACmD,IAAI,CAAC;UACf1D,GAAG,EAAEyD,MAAM;UACX5C,IAAI,EAAE8C,SAAS;UACf5D,IAAI,EAAE,EAAE;UACRyD,QAAQ,EAAE,EAAE;UACZxB,KAAK,EAAE,IAAI;UACXC,GAAG,EAAE,IAAI;UACT2B,OAAO,EAAE,WAAW;UACpBC,SAAS,EAAE,IAAI;UACfC,QAAQ,EAAE;QACZ,CAAC,CAAC;QACF,IAAI,CAACxB,UAAU,CAAC,CAAC;QACjB,IAAI,CAAChC,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC,CAACwD,IAAI,CAAC,MAAM;UACrD,IAAI,CAACzD,KAAK,CAAC+C,eAAe,CAACI,MAAM,CAAC;QACpC,CAAC,CAAC;QACF;MACF,KAAK,cAAc;QACjB,IAAIvD,WAAW,KAAK,MAAM,EAAE;QAC5B,IAAIM,IAAI,CAACyB,GAAG,IAAI,IAAI,IAAIzB,IAAI,CAACyB,GAAG,IAAIO,WAAW,GAAGzD,kBAAkB,EAAE;QACtE,IAAIyD,WAAW,IAAI,IAAI,EAAE;QACzB,IAAIhC,IAAI,CAACwB,KAAK,KAAKQ,WAAW,EAAE;UAC9BhC,IAAI,CAACwB,KAAK,GAAGQ,WAAW;UACxB,IAAI,CAACF,UAAU,CAAC,CAAC;UACjB,MAAM0B,QAAQ,GAAG,MAAM,IAAI,CAAC1D,KAAK,CAACF,MAAM,CAAC6D,gBAAgB,CAACzB,WAAW,CAAC;UACtEhC,IAAI,CAAC0D,QAAQ,GAAGF,QAAQ;UACxB,IAAI,CAAC1D,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;QAC7C;QACA;MACF,KAAK,YAAY;QACf,IAAIL,WAAW,KAAK,MAAM,EAAE;QAC5B,IAAIsC,WAAW,IAAI,IAAI,EAAE;QACzB,IAAIhC,IAAI,CAACwB,KAAK,IAAI,IAAI,IAAIxB,IAAI,CAACwB,KAAK,IAAIQ,WAAW,GAAGzD,kBAAkB,EAAE;QAC1EyB,IAAI,CAACyB,GAAG,GAAGO,WAAW;QACtB,IAAI,CAAClC,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;QAC3C,IAAI,CAAC+B,UAAU,CAAC,CAAC;QACjB;MACF,KAAK,aAAa;QAChB,IAAIpC,WAAW,KAAK,MAAM,EAAE;QAC5B,IAAIsC,WAAW,IAAI,IAAI,EAAE;QACzBhC,IAAI,CAACwB,KAAK,GAAG,IAAI;QACjBxB,IAAI,CAAC0D,QAAQ,GAAG,IAAI;QACpB,IAAI,CAAC5D,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;QAC3C;MACF,KAAK,WAAW;QACd,IAAIL,WAAW,KAAK,MAAM,EAAE;QAC5B,IAAIsC,WAAW,IAAI,IAAI,EAAE;QACzBhC,IAAI,CAACyB,GAAG,GAAG,IAAI;QACf,IAAI,CAAC3B,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;QAC3C;MACF,KAAK,OAAO;QACV,IAAIL,WAAW,KAAK,MAAM,EAAE;UAC1B,IAAI,CAACI,KAAK,CAAC6D,SAAS,CAAC3D,IAAI,CAACR,GAAG,CAAC;UAC9B,IAAI,CAACsC,UAAU,CAAC,CAAC;QACnB,CAAC,MAAM;UACL;UACA,IAAI,CAAChC,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC;UAC3C,IAAI,CAACD,KAAK,CAACiD,UAAU,CAAC,CAAC;QACzB;QACA;MACF,KAAK,MAAM;QAAE;UACX,MAAMa,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC/D,IAAI,CAAC,CAAC;UAChD4D,OAAO,CAACpE,GAAG,GAAG,IAAI,CAACyC,SAAS,CAACxC,OAAO,CAAC,GAAG,CAAC;UACzCmE,OAAO,CAACZ,QAAQ,GAAG,EAAE;UACrBjD,WAAW,CAACmD,IAAI,CAACU,OAAO,CAAC;UACzB,IAAI,CAAC9D,KAAK,CAACQ,mBAAmB,CAACP,WAAW,CAAC,CAACwD,IAAI,CAAES,OAAO,IAAK;YAC5D,IAAI,CAAClC,UAAU,CAAC,CAAC;YACjB,IAAI,CAAChC,KAAK,CAAC6D,SAAS,CAACC,OAAO,CAACpE,GAAG,CAAC;UACnC,CAAC,CAAC;UACF;QACF;MACA;QACE;IACJ;EACF;EAEAyE,eAAeA,CAAC3E,CAAC,EAAEE,GAAG,EAAE;IACtB,IAAI,CAACM,KAAK,CAAC+C,eAAe,CAACrD,GAAG,CAAC;EACjC;EAEAsC,UAAUA,CAAA,EAAG;IACX,MAAM;MAAElC;IAAO,CAAC,GAAG,IAAI,CAACE,KAAK;IAC7B,IAAIF,MAAM,IAAIA,MAAM,CAACmC,KAAK,EAAEnC,MAAM,CAACmC,KAAK,CAACmC,KAAK,CAAC,CAAC;EAClD;EAEAC,MAAMA,CAAA,EAAG;IACP,MAAM;MAAEpF,UAAU;MAAEC;IAAc,CAAC,GAAG,IAAI,CAACF,KAAK;IAChD,MAAM;MACJW,OAAO;MACP2E,iBAAiB;MACjBC,iBAAiB;MACjBrC,WAAW;MACXtC,WAAW;MACXC,YAAY;MACZC,MAAM;MACN0E,mBAAmB;MACnBzE,oBAAoB;MACpB0B;IACF,CAAC,GAAG,IAAI,CAACzB,KAAK;IACd,MAAMyE,WAAW,GAAG,IAAI,CAACtE,SAAS,CAACR,OAAO,EAAEE,YAAY,CAAC;IACzD,oBACEjC,KAAA,CAAA8G,aAAA;MAAKC,SAAS,EAAC,yBAAyB;MAAAC,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACtCrH,KAAA,CAAA8G,aAAA,CAAC7G,IAAI;MAAC8G,SAAS,EAAC,sBAAsB;MAAAC,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACpCrH,KAAA,CAAA8G,aAAA,CAAC7G,IAAI;MAAC8G,SAAS,EAAC,mBAAmB;MAACO,IAAI,EAAC,OAAO;MAAAN,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAC7C9G,UAAU,CAAC+D,WAAW,CACnB,CAAC,eACPtE,KAAA,CAAA8G,aAAA,CAAC5G,KAAK,CAACqH,KAAK;MACVR,SAAS,EAAC,oBAAoB;MAC9BS,QAAQ,EAAG5F,CAAC,IAAK,IAAI,CAACQ,KAAK,CAACqF,sBAAsB,CAAC7F,CAAC,CAAC4B,MAAM,CAACC,KAAK,CAAE;MACnEiE,YAAY,EAAE,CAAE;MAAAV,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBAEhBrH,KAAA,CAAA8G,aAAA,CAAC5G,KAAK,CAACE,MAAM;MAACqD,KAAK,EAAE,IAAK;MAAAuD,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,OAEb,CAAC,eACfrH,KAAA,CAAA8G,aAAA,CAAC5G,KAAK,CAACE,MAAM;MAACqD,KAAK,EAAE,GAAI;MAAAuD,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,MAEZ,CAAC,eACfrH,KAAA,CAAA8G,aAAA,CAAC5G,KAAK,CAACE,MAAM;MAACqD,KAAK,EAAE,CAAE;MAAAuD,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,IAEV,CAAC,eACfrH,KAAA,CAAA8G,aAAA,CAAC5G,KAAK,CAACE,MAAM;MAACqD,KAAK,EAAE,CAAE;MAAAuD,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,IAEV,CAAC,eACfrH,KAAA,CAAA8G,aAAA,CAAC5G,KAAK,CAACE,MAAM;MAACqD,KAAK,EAAE,CAAE;MAAAuD,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,IAEV,CACH,CAAC,eACdrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;MACL2G,SAAS,EAAC,wBAAwB;MAClCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,KAAK,CAAE;MACjDC,IAAI,EAAC,SAAS;MACd+F,KAAK;MACLC,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;MAAAmD,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAC1C,0BAEO,CACJ,CAAC,eACPrH,KAAA,CAAA8G,aAAA;MAAKC,SAAS,EAAC,2BAA2B;MAAAC,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GACvCtF,OAAO,CAAC+F,WAAW,CAAC,CAACC,GAAG,EAAEzF,IAAI,EAAE0F,KAAK,KAAK;MAAA,IAAAC,UAAA,EAAAC,cAAA;MACzCH,GAAG,CAACvC,IAAI,CACJlD,IAAI,CAACwB,KAAK,IAAI,IAAI,IAAIxB,IAAI,CAACyB,GAAG,IAAI,IAAI,IAAMzB,IAAI,CAACwB,KAAK,IAAIQ,WAAW,GAAG3D,YAAY,CAACiG,mBAAmB,CAAC,IAAItE,IAAI,CAACyB,GAAG,IAAIO,WAAW,GAAG3D,YAAY,CAACiG,mBAAmB,CAAE,gBAEvK5G,KAAA,CAAA8G,aAAA,CAAC7G;MACC;MAAA;QACA6B,GAAG,EAAEQ,IAAI,CAACR,GAAI;QACdiF,SAAS,EAAE,6CAA6CzE,IAAI,CAACR,GAAG,EAAG;QACnEqG,KAAK,EAAE;UAAEC,MAAM,EAAEnG,YAAY,KAAKK,IAAI,CAACR,GAAG,GAAG,mBAAmB,GAAG;QAAK,CAAE;QAC1E6F,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAAC2E,eAAe,CAAC3E,CAAC,EAAEU,IAAI,CAACR,GAAG,CAAE;QAAAkF,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,gBAElDrH,KAAA,CAAA8G,aAAA;QAAKC,SAAS,EAAC,iCAAiC;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,gBAC9CrH,KAAA,CAAA8G,aAAA;QAAOC,SAAS,EAAC,+BAA+B;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAAC,0BAE1C,CAAC,eACRrH,KAAA,CAAA8G,aAAA,CAACpG,uBAAuB;QACtBsH,KAAK,EAAE1F,IAAI,CAACR,GAAI;QAChBR,aAAa,EAAEA,aAAc;QAC7BK,kBAAkB,EAAE,IAAI,CAACA,kBAAkB,CAAC0G,IAAI,CAAC,IAAI,CAAE;QACvDjF,kBAAkB,EAAE,IAAI,CAACA,kBAAkB,CAACiF,IAAI,CAAC,IAAI,CAAE;QACvDlF,gBAAgB,EAAE,IAAI,CAACA,gBAAgB,CAACkF,IAAI,CAAC,IAAI,CAAE;QACnD/F,IAAI,EAAEA,IAAK;QACXoE,iBAAiB,EAAEA,iBAAkB;QACrCvE,oBAAoB,EAAEA,oBAAqB;QAC3Cd,UAAU,EAAEA,UAAW;QACvBwG,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,CAC1C,CACE,CAAC,eACNrH,KAAA,CAAA8G,aAAA;QAAKC,SAAS,EAAC,iCAAiC;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,gBAC9CrH,KAAA,CAAA8G,aAAA;QAAOC,SAAS,EAAC,+BAA+B;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAAC,0BAE1C,CAAC,eACRrH,KAAA,CAAA8G,aAAA,CAAC3G,QAAQ;QACPmI,UAAU;QACVvB,SAAS,EAAC,gCAAgC;QAC1CwB,OAAO,EAAE5B,iBAAkB;QAC3B6B,WAAW,EAAC,sCAAQ;QACpBhB,QAAQ,EAAG5F,CAAC,IAAK,IAAI,CAACD,kBAAkB,CAACC,CAAC,EAAE,MAAM,EAAEU,IAAI,CAACR,GAAG,CAAE;QAC9D4F,YAAY,EAAEpF,IAAI,CAACT,IAAK;QACxB4G,iBAAiB,EAAEA,CAAA,KAAMC,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAE;QACzDd,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QACzC+E,OAAO,EAAEA,CAAA,KAAMtF,MAAM,CAACC,2BAA2B,GAAG,IAAK;QACzDsF,MAAM,EAAEA,CAAA,KAAMvF,MAAM,CAACC,2BAA2B,GAAG,KAAM;QAAAyD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,CAC1D,CACE,CAAC,eACNrH,KAAA,CAAA8G,aAAA;QAAKC,SAAS,EAAC,iCAAiC;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,gBAC9CrH,KAAA,CAAA8G,aAAA;QAAOC,SAAS,EAAC,+BAA+B;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAAC,0BAE1C,CAAC,eACRrH,KAAA,CAAA8G,aAAA;QACEe,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QACzCkD,SAAS,EAAC,yBAAyB;QACnCtD,KAAK,EAAG,IAAI,CAACrC,KAAK,CAACG,YAAY,KAAKe,IAAI,CAACR,GAAG,IAAI,IAAI,CAACV,KAAK,CAACK,oBAAoB,KAAK,OAAO,GAAG,IAAI,CAACL,KAAK,CAACI,iBAAiB,GAAGjB,UAAU,CAAC+B,IAAI,CAACwB,KAAK,CAAE;QACpJ8E,OAAO,EAAIhH,CAAC,IAAK,IAAI,CAACyB,oBAAoB,CAACzB,CAAC,EAAEU,IAAI,CAACR,GAAG,EAAE,OAAO,CAAG;QAClE+G,MAAM,EAAIjH,CAAC,IAAK,IAAI,CAACgC,mBAAmB,CAAChC,CAAC,EAAEU,IAAI,CAACR,GAAG,EAAE,OAAO,CAAG;QAChE0F,QAAQ,EAAG5F,CAAC,IAAK;UAAE,IAAI,CAACa,QAAQ,CAAC;YAACjB,iBAAiB,EAAEI,CAAC,CAAC4B,MAAM,CAACC;UAAK,CAAC,CAAC;QAAA,CAAE;QAAAuD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,CACxE,CAAC,eAUFrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,+BAA+B;QACzCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,cAAc,EAAEU,IAAI,CAACR,GAAG,CAAE;QACpE+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,QAEO,CAAC,eACTrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,+BAA+B;QACzCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,aAAa,EAAEU,IAAI,CAACR,GAAG,CAAE;QACnE+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,GAEO,CACL,CAAC,eACNrH,KAAA,CAAA8G,aAAA;QAAKC,SAAS,EAAC,iCAAiC;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,gBAC9CrH,KAAA,CAAA8G,aAAA;QAAOC,SAAS,EAAC,+BAA+B;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAAC,0BAE1C,CAAC,eACRrH,KAAA,CAAA8G,aAAA;QACE;QACAe,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QACzCkD,SAAS,EAAC;QACV;QACAtD,KAAK,EAAG,IAAI,CAACrC,KAAK,CAACG,YAAY,KAAKe,IAAI,CAACR,GAAG,IAAI,IAAI,CAACV,KAAK,CAACK,oBAAoB,KAAK,KAAK,GAAG,IAAI,CAACL,KAAK,CAACI,iBAAiB,GAAGjB,UAAU,CAAC+B,IAAI,CAACyB,GAAG,CAAE;QAChJ6E,OAAO,EAAIhH,CAAC,IAAK,IAAI,CAACyB,oBAAoB,CAACzB,CAAC,EAAEU,IAAI,CAACR,GAAG,EAAE,KAAK,CAAG;QAChE+G,MAAM,EAAIjH,CAAC,IAAK,IAAI,CAACgC,mBAAmB,CAAChC,CAAC,EAAEU,IAAI,CAACR,GAAG,EAAE,KAAK,CAAG;QAC9D0F,QAAQ,EAAG5F,CAAC,IAAK;UAAE,IAAI,CAACa,QAAQ,CAAC;YAACjB,iBAAiB,EAAEI,CAAC,CAAC4B,MAAM,CAACC;UAAK,CAAC,CAAC;QAAA,CAAE;QAAAuD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,CACxE,CAAC,eACFrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,+BAA+B;QACzCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,YAAY,EAAEU,IAAI,CAACR,GAAG,CAAE;QAClE+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,QAEO,CAAC,eACTrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,+BAA+B;QACzCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,WAAW,EAAEU,IAAI,CAACR,GAAG,CAAE;QACjE+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,GAEO,CACL,CAAC,eACNrH,KAAA,CAAA8G,aAAA;QAAKC,SAAS,EAAC,iCAAiC;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,gBAC9CrH,KAAA,CAAA8G,aAAA;QAAKC,SAAS,EAAC,qBAAqB;QAAAC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAChC/E,IAAI,CAACK,IAAI,IAAI,IAAI,IAAI,GAAAsF,UAAA,GAAC3F,IAAI,CAACT,IAAI,cAAAoG,UAAA,uBAATA,UAAA,CAAWjF,MAAM,KAAIV,IAAI,CAACyB,GAAG,IAAI,IAAI,IAAIzB,IAAI,CAACwB,KAAK,IAAI,IAAI,IAAI,GAAAoE,cAAA,GAAC5F,IAAI,CAACgD,QAAQ,cAAA4C,cAAA,uBAAbA,cAAA,CAAelF,MAAM,iBAEzGhD,KAAA,CAAA8G,aAAA,CAACzG,GAAG;QAAC8H,KAAK,EAAE;UAAEW,eAAe,EAAE,GAAGhI,eAAe,IAAI;UAAEiI,WAAW,EAAEjI;QAAgB,CAAE;QAAAkG,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GACnF,OAAO/E,IAAI,CAACR,GAAG,KACb,CAAC,GAELQ,IAAI,CAACoD,OAAO,KAAK,WAAW,gBAE3B1F,KAAA,CAAA8G,aAAA,CAACzG,GAAG;QAAC2I,KAAK,EAAC,MAAM;QAAAhC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GACd,OAAO/E,IAAI,CAACR,GAAG,KACb,CAAC,GAELQ,IAAI,CAACoD,OAAO,KAAK,UAAU,gBAC1B1F,KAAA,CAAA8G,aAAA,CAACzG,GAAG;QAAC2I,KAAK,EAAC,OAAO;QAAAhC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAAE,OAAO/E,IAAI,CAACR,GAAG,KAAW,CAAC,gBAC/C9B,KAAA,CAAA8G,aAAA,CAACzG,GAAG;QAAC2I,KAAK,EAAC,KAAK;QAAAhC,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAAE,OAAO/E,IAAI,CAACR,GAAG,KAAW,CACjD,CAAC,eACN9B,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,8BAA8B;QACxCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,QAAQ,EAAEU,IAAI,CAACR,GAAG,CAAE;QAC9D+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,cAEO,CAAC,eACTrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,8BAA8B;QACxCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,MAAM,EAAEU,IAAI,CAACR,GAAG,CAAE;QAC5D+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,cAEO,CAAC,eACTrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;QACL2G,SAAS,EAAC,8BAA8B;QACxCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,OAAO,EAAEU,IAAI,CAACR,GAAG,CAAE;QAC7D+F,QAAQ,EAAEjH,oBAAoB,CAACiD,QAAQ,CAAE;QAAAmD,MAAA;QAAAC,QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAA,GAC1C,0BAEO,CACL,CACD,CAAC,GAEP,IACN,CAAC;MACD,OAAOU,GAAG;IACZ,CAAC,EAAE,EAAE,CAAC,EAEJ/F,WAAW,KAAK,MAAM,IAAIC,YAAY,IAAI,IAAI,IAAI,CAAA4E,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEvB,QAAQ,KAAI,IAAI,gBAE3EtF,KAAA,CAAA8G,aAAA;MACEC,SAAS,EAAC,+BAA+B;MACzCoB,KAAK,EAAE;QACLc,IAAI,EAAE,GAAG,CAACnE,IAAI,CAACC,GAAG,CAAC8B,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEvB,QAAQ,CAAC,CAAC,CAAC,EAAEuB,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEvB,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAIpD,MAAM,GAAGA,MAAM,CAACgH,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,KAAKhH,MAAM,GAAGA,MAAM,CAACiH,SAAS,CAACC,UAAU,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI;QAChKC,GAAG,EAAE,GAAG,CAACvE,IAAI,CAACC,GAAG,CAAC8B,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEvB,QAAQ,CAAC,CAAC,CAAC,EAAEuB,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEvB,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAIpD,MAAM,GAAGA,MAAM,CAACoH,MAAM,GAAG,CAAC,CAAC,IAAI,EAAE,KAAKpH,MAAM,GAAGA,MAAM,CAACiH,SAAS,CAACI,SAAS,GAAG,CAAC,CAAC,GAAG,EAAE;MAC9J,CAAE;MAAAvC,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBAEFrH,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;MACL2G,SAAS,EAAC,8BAA8B;MACxCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,OAAO,EAAEK,YAAY,CAAE;MACjEqF,IAAI,EAAC,OAAO;MAAAN,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAEXrF,WAAW,KAAK,MAAM,GAAG,MAAM,GAAG,IAC7B,CAAC,eACThC,KAAA,CAAA8G,aAAA,CAAC1G,MAAM;MACL2G,SAAS,EAAC,8BAA8B;MACxCY,OAAO,EAAG/F,CAAC,IAAK,IAAI,CAACoD,iBAAiB,CAACpD,CAAC,EAAE,MAAM,EAAEK,YAAY,CAAE;MAChEqF,IAAI,EAAC,OAAO;MAAAN,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GACb,cAEO,CAQL,CAAC,GAEN,IAEH,CACF,CAAC;EAEV;AACF;AAEA,eAAepG,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module"}