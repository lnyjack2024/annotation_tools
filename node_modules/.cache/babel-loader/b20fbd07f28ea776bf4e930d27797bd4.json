{"ast":null,"code":"import React,{useMemo,useRef}from'react';import{observer}from'mobx-react';import cx from'classnames';import{parseFields}from'../../utils';import{Pencil}from'../../../common/icons';import AttributeValueItem from'./AttributeValueItem';import store from'../../store/RootStore';import'./FrameAttributes.scss';const FrameAttributes=observer(_ref=>{var _attributes$camera;let{camera,cameraIndex}=_ref;const ref=useRef(null);const fieldsMap=useMemo(()=>parseFields(store.frame.frameConfig),[store.frame.frameConfig]);const{currentCamera,currentFrame,isSingleCamera,attributes,frameConfig}=store.frame;const{attributes:frameAttributes={}}=((_attributes$camera=attributes[camera])===null||_attributes$camera===void 0?void 0:_attributes$camera[currentFrame])||{};const fieldKeys=Object.keys(fieldsMap);const attrKeys=Object.keys(frameAttributes);const legacyKeys=attrKeys.filter(key=>!fieldKeys.includes(key));return/*#__PURE__*/React.createElement(\"div\",{ref:ref,className:cx('frame-attributes',{selected:!isSingleCamera&&currentCamera===camera})},!isSingleCamera&&frameConfig&&/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},\"C\".concat(cameraIndex+1,\"-\").concat(camera),!store.readonly&&/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-panel-icon\",onClick:e=>{e.stopPropagation();store.config.setFrameAttributesModalVisible(true);}},/*#__PURE__*/React.createElement(Pencil,null))),[...fieldKeys,...legacyKeys].map(key=>attrKeys.includes(key)&&/*#__PURE__*/React.createElement(AttributeValueItem,{key:key,fieldName:key,fieldsMap:fieldsMap,values:frameAttributes})));});export default FrameAttributes;","map":{"version":3,"names":["React","useMemo","useRef","observer","cx","parseFields","Pencil","AttributeValueItem","store","FrameAttributes","_ref","_attributes$camera","camera","cameraIndex","ref","fieldsMap","frame","frameConfig","currentCamera","currentFrame","isSingleCamera","attributes","frameAttributes","fieldKeys","Object","keys","attrKeys","legacyKeys","filter","key","includes","createElement","className","selected","concat","readonly","onClick","e","stopPropagation","config","setFrameAttributesModalVisible","map","fieldName","values"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/attributes/FrameAttributes.tsx"],"sourcesContent":["import React, { useMemo, useRef } from 'react';\nimport { observer } from 'mobx-react';\nimport cx from 'classnames';\nimport { parseFields } from '../../utils';\nimport { Pencil } from '../../../common/icons';\nimport AttributeValueItem from './AttributeValueItem';\nimport store from '../../store/RootStore';\nimport './FrameAttributes.scss';\n\nconst FrameAttributes = observer((\n  { camera, cameraIndex }:\n  {\n    camera: string;\n    cameraIndex: number;\n  }\n) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const fieldsMap = useMemo(() => parseFields(store.frame.frameConfig), [store.frame.frameConfig]);\n  const { currentCamera, currentFrame, isSingleCamera, attributes, frameConfig } = store.frame;\n  const { attributes: frameAttributes = {} } = attributes[camera]?.[currentFrame] || {};\n  const fieldKeys = Object.keys(fieldsMap);\n\n  const attrKeys = Object.keys(frameAttributes);\n  const legacyKeys = attrKeys.filter((key) => !fieldKeys.includes(key));\n\n  return (\n    <div\n      ref={ref}\n      className={cx('frame-attributes', {\n        selected: !isSingleCamera && currentCamera === camera,\n      })}\n    >\n      {!isSingleCamera && frameConfig && (\n        <div className=\"title\">\n          {`C${cameraIndex + 1}-${camera}`}\n          {!store.readonly && (\n            <div\n              className=\"collapse-panel-icon\"\n              onClick={(e) => {\n                e.stopPropagation();\n                store.config.setFrameAttributesModalVisible(true);\n              }}\n            >\n              <Pencil />\n            </div>\n          )}\n        </div>\n      )}\n      {\n        [...fieldKeys, ...legacyKeys].map((key) => attrKeys.includes(key) && (\n          <AttributeValueItem\n            key={key}\n            fieldName={key}\n            fieldsMap={fieldsMap}\n            values={frameAttributes}\n          />\n        ))\n      }\n    </div>\n  );\n});\n\nexport default FrameAttributes;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,OAAO,CAAEC,MAAM,KAAQ,OAAO,CAC9C,OAASC,QAAQ,KAAQ,YAAY,CACrC,MAAO,CAAAC,EAAE,KAAM,YAAY,CAC3B,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,MAAM,KAAQ,uBAAuB,CAC9C,MAAO,CAAAC,kBAAkB,KAAM,sBAAsB,CACrD,MAAO,CAAAC,KAAK,KAAM,uBAAuB,CACzC,MAAO,wBAAwB,CAE/B,KAAM,CAAAC,eAAe,CAAGN,QAAQ,CAACO,IAAA,EAM5B,KAAAC,kBAAA,IALH,CAAEC,MAAM,CAAEC,WAIV,CAAC,CAAAH,IAAA,CAED,KAAM,CAAAI,GAAG,CAAGZ,MAAM,CAAiB,IAAI,CAAC,CACxC,KAAM,CAAAa,SAAS,CAAGd,OAAO,CAAC,IAAMI,WAAW,CAACG,KAAK,CAACQ,KAAK,CAACC,WAAW,CAAC,CAAE,CAACT,KAAK,CAACQ,KAAK,CAACC,WAAW,CAAC,CAAC,CAChG,KAAM,CAAEC,aAAa,CAAEC,YAAY,CAAEC,cAAc,CAAEC,UAAU,CAAEJ,WAAY,CAAC,CAAGT,KAAK,CAACQ,KAAK,CAC5F,KAAM,CAAEK,UAAU,CAAEC,eAAe,CAAG,CAAC,CAAE,CAAC,CAAG,EAAAX,kBAAA,CAAAU,UAAU,CAACT,MAAM,CAAC,UAAAD,kBAAA,iBAAlBA,kBAAA,CAAqBQ,YAAY,CAAC,GAAI,CAAC,CAAC,CACrF,KAAM,CAAAI,SAAS,CAAGC,MAAM,CAACC,IAAI,CAACV,SAAS,CAAC,CAExC,KAAM,CAAAW,QAAQ,CAAGF,MAAM,CAACC,IAAI,CAACH,eAAe,CAAC,CAC7C,KAAM,CAAAK,UAAU,CAAGD,QAAQ,CAACE,MAAM,CAAEC,GAAG,EAAK,CAACN,SAAS,CAACO,QAAQ,CAACD,GAAG,CAAC,CAAC,CAErE,mBACE7B,KAAA,CAAA+B,aAAA,QACEjB,GAAG,CAAEA,GAAI,CACTkB,SAAS,CAAE5B,EAAE,CAAC,kBAAkB,CAAE,CAChC6B,QAAQ,CAAE,CAACb,cAAc,EAAIF,aAAa,GAAKN,MACjD,CAAC,CAAE,EAEF,CAACQ,cAAc,EAAIH,WAAW,eAC7BjB,KAAA,CAAA+B,aAAA,QAAKC,SAAS,CAAC,OAAO,MAAAE,MAAA,CACfrB,WAAW,CAAG,CAAC,MAAAqB,MAAA,CAAItB,MAAM,EAC7B,CAACJ,KAAK,CAAC2B,QAAQ,eACdnC,KAAA,CAAA+B,aAAA,QACEC,SAAS,CAAC,qBAAqB,CAC/BI,OAAO,CAAGC,CAAC,EAAK,CACdA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnB9B,KAAK,CAAC+B,MAAM,CAACC,8BAA8B,CAAC,IAAI,CAAC,CACnD,CAAE,eAEFxC,KAAA,CAAA+B,aAAA,CAACzB,MAAM,KAAE,CACN,CAEJ,CACN,CAEC,CAAC,GAAGiB,SAAS,CAAE,GAAGI,UAAU,CAAC,CAACc,GAAG,CAAEZ,GAAG,EAAKH,QAAQ,CAACI,QAAQ,CAACD,GAAG,CAAC,eAC/D7B,KAAA,CAAA+B,aAAA,CAACxB,kBAAkB,EACjBsB,GAAG,CAAEA,GAAI,CACTa,SAAS,CAAEb,GAAI,CACfd,SAAS,CAAEA,SAAU,CACrB4B,MAAM,CAAErB,eAAgB,CACzB,CACF,CAEA,CAAC,CAEV,CAAC,CAAC,CAEF,cAAe,CAAAb,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module"}