{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/excel/index.jsx\";\n/* eslint-disable no-undef */\nimport React from 'react';\nimport { Base64 } from 'js-base64';\nimport Spreadsheet from '@appen/spreadsheet';\nimport { saveAs } from 'file-saver';\nimport ExcelJS from 'exceljs';\nimport { notification, Spin } from 'antd';\nimport pako from 'pako';\nimport PaPa from 'papaparse';\nimport STATUS from './type';\nimport { isAnnotationReadonly, isPreview } from '../../utils/tool-mode';\nimport { stringToUint8Array, uint8ArrayToString, uint8ToString } from './utils';\nimport workbookToJson, { checkStyleValid } from './workbook2json';\nimport jsonToWorkbook from './json2Workbook';\nimport localMessage, { localizeSheet } from './locale';\nimport '@appen/spreadsheet/dist/index.css';\nimport './index.scss';\nnotification.config({\n  top: 60\n});\nexport default class ExcelAnnotationApp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.sheet = null;\n    this.state = {\n      status: STATUS.NONE\n    };\n  }\n  get excelLinkFile() {\n    return `${this.props.jobProxy.resultId}.excel.xlsx`;\n  }\n  get jsonLinkFile() {\n    return `${this.props.jobProxy.resultId}.excel.json`;\n  }\n  componentDidMount() {\n    // 根据浏览器语言设置显示语言\n    localizeSheet(Spreadsheet);\n    this.sheet = new Spreadsheet('#x-spreadsheet', {\n      view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth\n      },\n      toolbar: {\n        allowSave: !(isAnnotationReadonly(this.props.jobProxy.toolMode) || isPreview(this.props.jobProxy.toolMode)),\n        allowExport: false,\n        allowPrint: false\n      },\n      lockEnable: !this.props.initial_value_editable\n    });\n    this.sheet.validate();\n    this.sheet.on('table-save', this.onSubmit.bind(this, true)).on('export', this.onExport.bind(this));\n    this.onLoad();\n  }\n  async onLoad() {\n    this.setState({\n      status: STATUS.LOAD\n    });\n    try {\n      await this.props.jobProxy.loadResult().then(async res => {\n        if (res) {\n          const payload = JSON.parse(JSON.stringify(res));\n          await fetch(payload.json).then(result => result.json()).then(async compressedData => {\n            // 若能找到之前保存的资源则载入保存的资源, data格式为json\n            const depress = pako.inflate(stringToUint8Array(compressedData.saveData));\n            const str = uint8ArrayToString(depress);\n            const data = JSON.parse(str);\n            await this.sheet.loadData(data);\n            notification.success({\n              message: localMessage('loadSuccess')\n            });\n          }).catch(e => {\n            notification.error({\n              message: localMessage('loadFail'),\n              description: !(e.message instanceof Object) && e.message || localMessage('retry')\n            });\n          });\n        } else {\n          // 若找不到则在payload的url中寻找\n          await this.loadPayload();\n        }\n      });\n    } catch (e) {\n      notification.error({\n        message: localMessage('ANNOTATION_DATA_LOAD_ERROR'),\n        duration: null\n      });\n      return;\n    }\n    this.setState({\n      status: STATUS.NONE\n    });\n  }\n  onSubmit(normalSave) {\n    let result;\n    if (!isAnnotationReadonly(this.props.jobProxy.toolMode)) {\n      result = this.onSave(!normalSave).catch(e => {\n        if (!normalSave) {\n          throw new Error(localMessage('saveFail'), e);\n        }\n      });\n    } else {\n      notification.warning({\n        message: localMessage('saveNotAllow')\n      });\n    }\n    return result;\n  }\n  async onSave(isSubmit) {\n    const uploadPromise = new Promise((resolve, reject) => {\n      this.setState({\n        status: STATUS.SAVE\n      }, () => {\n        setTimeout(async () => {\n          let excelLink;\n          let jsonLink;\n          let dataLink;\n          try {\n            const saveData = this.sheet.getData();\n            const workbook = jsonToWorkbook(saveData);\n            await workbook.xlsx.writeBuffer().then(async data => {\n              try {\n                excelLink = await this.props.saveContent(window.btoa(uint8ToString(data)), 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8', `${isSubmit ? `R.${new Date().getTime()}` : ''}${this.excelLinkFile}`, this.props.job_id);\n              } catch (err) {\n                reject(err);\n              }\n            });\n            const compress = pako.gzip(JSON.stringify(saveData), {\n              to: 'String'\n            });\n            jsonLink = await this.props.saveContent(Base64.encode(JSON.stringify({\n              saveData: uint8ToString(compress)\n            })), 'text/plain', `${isSubmit ? `R.${new Date().getTime()}` : ''}${this.jsonLinkFile}`, this.props.job_id);\n            dataLink = this.props.jobProxy.saveResult({\n              excel: excelLink,\n              json: jsonLink\n            }, isSubmit);\n            this.setState({\n              status: STATUS.NONE\n            });\n            resolve(dataLink);\n          } catch (e) {\n            this.setState({\n              status: STATUS.NONE\n            });\n            reject(e);\n          }\n        }, 0);\n      });\n    });\n    let result;\n    await uploadPromise.then(res => {\n      result = res;\n      notification.success({\n        message: localMessage('saveSuccess')\n      });\n    }).catch(e => {\n      notification.error({\n        message: localMessage('saveFail'),\n        description: !(e.message instanceof Object) && e.message || localMessage('retry')\n      });\n      throw new Error(e);\n    });\n    return result;\n  }\n  async onExport() {\n    this.setState({\n      status: STATUS.EXPORT\n    });\n    try {\n      const workbook = jsonToWorkbook(this.sheet.getData());\n      await workbook.xlsx.writeBuffer().then(buff => {\n        const blob = new Blob([buff], {\n          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8'\n        });\n        saveAs(blob, 'Excel.xlsx'); // 浏览器下载文件\n        notification.success({\n          message: localMessage('exportSuccess')\n        });\n      });\n    } catch (e) {\n      notification.error({\n        message: localMessage('exportFail'),\n        description: !(e.message instanceof Object) && e.message || localMessage('retry')\n      });\n    } finally {\n      this.setState({\n        status: STATUS.NONE\n      });\n    }\n  }\n  async loadPayload() {\n    let loadPromise;\n    let res = await fetch(this.props.excel);\n    res = res.blob();\n    await res.then(data => {\n      const reader = new FileReader();\n      loadPromise = new Promise((resolve, reject) => {\n        switch (data.type) {\n          case 'text/csv':\n            reader.onload = () => {\n              try {\n                PaPa.parse(reader.result, {\n                  complete: csv => {\n                    this.resolveCsv(csv.data);\n                    resolve(true);\n                  }\n                });\n              } catch (err) {\n                reject(err);\n              }\n            };\n            reader.readAsText(data);\n            break;\n          case 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet':\n            reader.onload = async () => {\n              try {\n                const result = new Uint8Array(reader.result);\n                const workbook = new ExcelJS.Workbook();\n                await workbook.xlsx.load(result);\n                if (!checkStyleValid(workbook)) notification.warning({\n                  message: localMessage('loadStyleWarning')\n                });\n                const json = workbookToJson(workbook);\n                this.sheet.loadData(json);\n                this.sheet.reRender();\n                resolve(true);\n              } catch (err) {\n                reject(err);\n              }\n            };\n            reader.readAsArrayBuffer(data);\n            break;\n          default:\n            throw new Error();\n        }\n      });\n    });\n    await loadPromise.then(() => {\n      notification.success({\n        message: localMessage('loadSuccess')\n      });\n    }).catch(err => {\n      notification.error({\n        message: localMessage('loadFail')\n      });\n      throw new Error(err);\n    });\n  }\n  resolveCsv(data) {\n    for (let i = 0; i < data.length; i += 1) {\n      const cols = data[i];\n      for (let j = 0; j < cols.length; j += 1) {\n        this.sheet.cellText(i, j, cols[j]);\n        this.sheet.cell(i, j).locked = true;\n      }\n    }\n    this.sheet.lockSheet(0);\n    this.sheet.reRender();\n  }\n  spinTip() {\n    switch (this.state.status) {\n      case STATUS.LOAD:\n        return `${localMessage('loading')}...`;\n      case STATUS.EXPORT:\n        return `${localMessage('exporting')}...`;\n      case STATUS.SAVE:\n        return `${localMessage('saving')}...`;\n      default:\n        return '';\n    }\n    ;\n  }\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"excel-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Spin, {\n      spinning: this.state.status !== STATUS.NONE,\n      delay: 0,\n      tip: this.spinTip(),\n      size: \"large\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"x-spreadsheet\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 11\n      }\n    })));\n  }\n}","map":{"version":3,"names":["React","Base64","Spreadsheet","saveAs","ExcelJS","notification","Spin","pako","PaPa","STATUS","isAnnotationReadonly","isPreview","stringToUint8Array","uint8ArrayToString","uint8ToString","workbookToJson","checkStyleValid","jsonToWorkbook","localMessage","localizeSheet","config","top","ExcelAnnotationApp","Component","constructor","props","sheet","state","status","NONE","excelLinkFile","jobProxy","resultId","jsonLinkFile","componentDidMount","view","height","document","documentElement","clientHeight","width","clientWidth","toolbar","allowSave","toolMode","allowExport","allowPrint","lockEnable","initial_value_editable","validate","on","onSubmit","bind","onExport","onLoad","setState","LOAD","loadResult","then","res","payload","JSON","parse","stringify","fetch","json","result","compressedData","depress","inflate","saveData","str","data","loadData","success","message","catch","e","error","description","Object","loadPayload","duration","normalSave","onSave","Error","warning","isSubmit","uploadPromise","Promise","resolve","reject","SAVE","setTimeout","excelLink","jsonLink","dataLink","getData","workbook","xlsx","writeBuffer","saveContent","window","btoa","Date","getTime","job_id","err","compress","gzip","to","encode","saveResult","excel","EXPORT","buff","blob","Blob","type","loadPromise","reader","FileReader","onload","complete","csv","resolveCsv","readAsText","Uint8Array","Workbook","load","reRender","readAsArrayBuffer","i","length","cols","j","cellText","cell","locked","lockSheet","spinTip","render","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","spinning","delay","tip","size","id"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/excel/index.jsx"],"sourcesContent":["/* eslint-disable no-undef */\nimport React from 'react';\nimport { Base64 } from 'js-base64';\nimport Spreadsheet from '@appen/spreadsheet';\nimport { saveAs } from 'file-saver';\nimport ExcelJS from 'exceljs';\nimport { notification, Spin } from 'antd';\nimport pako from 'pako';\nimport PaPa from 'papaparse';\nimport STATUS from './type';\nimport { isAnnotationReadonly, isPreview } from '../../utils/tool-mode';\nimport { stringToUint8Array, uint8ArrayToString, uint8ToString } from './utils';\nimport workbookToJson, { checkStyleValid } from './workbook2json';\nimport jsonToWorkbook from './json2Workbook';\nimport localMessage, { localizeSheet } from './locale';\nimport '@appen/spreadsheet/dist/index.css';\nimport './index.scss';\n\nnotification.config({ top: 60 });\n\nexport default class ExcelAnnotationApp extends React.Component {\n  sheet = null;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: STATUS.NONE,\n    };\n  }\n\n  get excelLinkFile() {\n    return `${this.props.jobProxy.resultId}.excel.xlsx`;\n  }\n\n  get jsonLinkFile() {\n    return `${this.props.jobProxy.resultId}.excel.json`;\n  }\n\n  componentDidMount() {\n    // 根据浏览器语言设置显示语言\n    localizeSheet(Spreadsheet);\n    this.sheet = new Spreadsheet('#x-spreadsheet', {\n      view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n      },\n      toolbar: {\n        allowSave: !(isAnnotationReadonly(this.props.jobProxy.toolMode) || isPreview(this.props.jobProxy.toolMode)),\n        allowExport: false,\n        allowPrint: false,\n      },\n      lockEnable: !this.props.initial_value_editable,\n    });\n    this.sheet.validate();\n    this.sheet\n      .on('table-save', this.onSubmit.bind(this, true))\n      .on('export', this.onExport.bind(this));\n    this.onLoad();\n  }\n\n  async onLoad() {\n    this.setState({ status: STATUS.LOAD });\n    try {\n      await this.props.jobProxy.loadResult().then(async (res) => {\n        if (res) {\n          const payload = JSON.parse(JSON.stringify(res));\n          await fetch(payload.json)\n            .then((result) => result.json())\n            .then(async (compressedData) => { // 若能找到之前保存的资源则载入保存的资源, data格式为json\n              const depress = pako.inflate(stringToUint8Array(compressedData.saveData));\n              const str = uint8ArrayToString(depress);\n              const data = JSON.parse(str);\n              await this.sheet.loadData(data);\n              notification.success({ message: localMessage('loadSuccess') });\n            }).catch((e) => {\n              notification.error({ message: localMessage('loadFail'), description: (!(e.message instanceof Object) && e.message) || localMessage('retry') });\n            });\n        } else { // 若找不到则在payload的url中寻找\n          await this.loadPayload();\n        }\n      });\n    } catch (e) {\n      notification.error({ message: localMessage('ANNOTATION_DATA_LOAD_ERROR'), duration: null });\n      return;\n    }\n    this.setState({ status: STATUS.NONE });\n  }\n\n  onSubmit(normalSave) {\n    let result;\n    if (!isAnnotationReadonly(this.props.jobProxy.toolMode)) {\n      result = this.onSave(!normalSave).catch((e) => {\n        if (!normalSave) {\n          throw new Error(localMessage('saveFail'), e);\n        }\n      });\n    } else {\n      notification.warning({ message: localMessage('saveNotAllow') });\n    }\n    return result;\n  };\n\n  async onSave(isSubmit) {\n    const uploadPromise = new Promise((resolve, reject) => {\n      this.setState({ status: STATUS.SAVE }, () => {\n        setTimeout(async () => {\n          let excelLink;\n          let jsonLink;\n          let dataLink;\n          try {\n            const saveData = this.sheet.getData();\n            const workbook = jsonToWorkbook(saveData);\n            await workbook.xlsx.writeBuffer()\n              .then(async (data) => {\n                try {\n                  excelLink = await this.props.saveContent(\n                    window.btoa(uint8ToString(data)),\n                    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8',\n                    `${isSubmit ? `R.${new Date().getTime()}` : ''}${this.excelLinkFile}`,\n                    this.props.job_id,\n                  );\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            const compress = pako.gzip(JSON.stringify(saveData), { to: 'String' });\n            jsonLink = await this.props.saveContent(\n              Base64.encode(JSON.stringify({ saveData: uint8ToString(compress) })),\n              'text/plain',\n              `${isSubmit ? `R.${new Date().getTime()}` : ''}${this.jsonLinkFile}`,\n              this.props.job_id,\n            );\n\n            dataLink = this.props.jobProxy.saveResult({\n              excel: excelLink,\n              json: jsonLink,\n            }, isSubmit);\n            this.setState({ status: STATUS.NONE });\n            resolve(dataLink);\n          } catch (e) {\n            this.setState({ status: STATUS.NONE });\n            reject(e);\n          }\n        }, 0);\n      });\n    });\n    let result;\n    await uploadPromise.then((res) => {\n      result = res;\n      notification.success({ message: localMessage('saveSuccess') });\n    }).catch((e) => {\n      notification.error({ message: localMessage('saveFail'), description: (!(e.message instanceof Object) && e.message) || localMessage('retry') });\n      throw new Error(e);\n    });\n    return result;\n  }\n\n  async onExport() {\n    this.setState({ status: STATUS.EXPORT });\n    try {\n      const workbook = jsonToWorkbook(this.sheet.getData());\n      await workbook.xlsx.writeBuffer()\n        .then((buff) => {\n          const blob = new Blob([buff], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8' });\n          saveAs(blob, 'Excel.xlsx'); // 浏览器下载文件\n          notification.success({ message: localMessage('exportSuccess') });\n        });\n    } catch (e) {\n      notification.error({ message: localMessage('exportFail'), description: (!(e.message instanceof Object) && e.message) || localMessage('retry') });\n    } finally {\n      this.setState({ status: STATUS.NONE });\n    }\n  }\n\n  async loadPayload() {\n    let loadPromise;\n    let res = await fetch(this.props.excel);\n    res = res.blob();\n    await res.then((data) => {\n      const reader = new FileReader();\n      loadPromise = new Promise((resolve, reject) => {\n        switch (data.type) {\n          case 'text/csv':\n            reader.onload = () => {\n              try {\n                PaPa.parse(reader.result, {\n                  complete: (csv) => {\n                    this.resolveCsv(csv.data);\n                    resolve(true);\n                  }\n                });\n              } catch (err) {\n                reject(err);\n              }\n            };\n            reader.readAsText(data);\n            break;\n          case 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet':\n            reader.onload = async () => {\n              try {\n                const result = new Uint8Array(reader.result);\n                const workbook = new ExcelJS.Workbook();\n                await workbook.xlsx.load(result);\n                if (!checkStyleValid(workbook)) notification.warning({ message: localMessage('loadStyleWarning') });\n                const json = workbookToJson(workbook);\n                this.sheet.loadData(json);\n                this.sheet.reRender();\n                resolve(true);\n              } catch (err) {\n                reject(err);\n              }\n            };\n            reader.readAsArrayBuffer(data);\n            break;\n          default:\n            throw new Error();\n        }\n      });\n    });\n    await loadPromise.then(() => {\n      notification.success({ message: localMessage('loadSuccess') });\n    }).catch((err) => {\n      notification.error({ message: localMessage('loadFail') });\n      throw new Error(err);\n    });\n  }\n\n  resolveCsv(data) {\n    for (let i = 0; i < data.length; i += 1) {\n      const cols = data[i];\n      for (let j = 0; j < cols.length; j += 1) {\n        this.sheet.cellText(i, j, cols[j]);\n        this.sheet.cell(i, j).locked = true;\n      }\n    }\n    this.sheet.lockSheet(0);\n    this.sheet.reRender();\n  }\n\n  spinTip() {\n    switch (this.state.status) {\n      case STATUS.LOAD: return `${localMessage('loading')}...`;\n      case STATUS.EXPORT: return `${localMessage('exporting')}...`;\n      case STATUS.SAVE: return `${localMessage('saving')}...`;\n      default: return '';\n    };\n  }\n\n  render() {\n    return (\n      <div className=\"excel-container\">\n        <Spin\n          spinning={this.state.status !== STATUS.NONE}\n          delay={0}\n          tip={this.spinTip()}\n          size=\"large\"\n        >\n          <div id=\"x-spreadsheet\" />\n        </Spin>\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}