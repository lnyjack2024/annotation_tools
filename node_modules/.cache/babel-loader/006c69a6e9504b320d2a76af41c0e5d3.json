{"ast":null,"code":"import { v4 as uuidv4 } from 'uuid';\nimport { Point, Graphics, Text } from 'pixi.js';\nimport Cursor from '../../../common/Cursor';\nexport default class AddBar {\n  constructor(options) {\n    this.id = uuidv4();\n    this.addColor = 0x000000;\n    this.lineColor = 0xDADFE2;\n    this.container = void 0;\n    this.cursor = Cursor.POINTER;\n    /**\n     * container index\n     */\n    this.index = 0;\n    /**\n     * position x\n     */\n    this.x = 0;\n    /**\n     * width\n     */\n    this.width = 3;\n    /**\n     * circle button radius\n     */\n    this.radius = 8;\n    /**\n     * height\n     */\n    this.height = 0;\n    /**\n     * PIXI instance\n     * @member {Graphics}\n     */\n    this.line = new Graphics();\n    /**\n     * PIXI instance\n     * @member {Graphics}\n     */\n    this.add = new Graphics();\n    /**\n     * tier category\n     */\n    this.category = void 0;\n    /**\n     * ctrl key hold on\n     */\n    this._ctrlKey = false;\n    /**\n    * PIXI application\n    * @member {PIXI.Application}\n    */\n    this.app = void 0;\n    /**\n     * handle add\n     */\n    this.handleAdd = void 0;\n    /**\n     * process pointerdown\n     * @param event\n     * @param frontTargets\n     */\n    this.processPointerDown = event => {\n      if (event.data.button === 2 && this._ctrlKey) {\n        return;\n      }\n      this.handleAdd(this.category, this.index);\n    };\n    /**\n     * process key down\n     * @param e\n     */\n    this.processGlobalKeyDown = e => {\n      if (e.ctrlKey) {\n        this._ctrlKey = true;\n      }\n    };\n    /**\n     * process key up\n     */\n    this.processGlobalKeyUp = () => {\n      this._ctrlKey = false;\n    };\n    const {\n      index,\n      category,\n      height,\n      x,\n      container,\n      app,\n      onAdd\n    } = options;\n    this.app = app;\n    this.category = category;\n    this.height = height;\n    this.x = x;\n    this.container = container;\n    this.index = index;\n    this.add.interactive = true;\n    this.handleAdd = onAdd;\n    document.addEventListener('keydown', this.processGlobalKeyDown);\n    document.addEventListener('keyup', this.processGlobalKeyUp);\n    this.add.on('pointerdown', this.processPointerDown);\n    this.add.on('pointerover', () => {\n      this.add.cursor = Cursor.POINTER;\n    });\n    this.add.on('pointerout', () => {\n      this.add.cursor = Cursor.DEFAULT;\n    });\n    this.normalize();\n  }\n  remove() {\n    this.container.removeChild(this.line);\n    this.container.removeChild(this.add);\n    this.line.destroy();\n    this.add.destroy();\n  }\n  normalize() {\n    this.container.addChild(this.line);\n    this.container.addChild(this.add);\n    this._drawAddShape();\n    this._drawShapeLine();\n  }\n\n  /**\n   * draw container fill\n   */\n  _drawAddShape() {\n    this.add.beginFill(this.addColor);\n    this.add.drawCircle(0, 0, this.radius);\n    this.add.endFill();\n    const y = this.index * this.height + this.radius * 1.5;\n    const text = new Text('+', {\n      fill: 0xffffff,\n      fontSize: 16\n    });\n    this.add.addChild(text);\n    text.position.set(-0.6 * this.radius, -1.2 * this.radius);\n    this.add.x = this.x;\n    this.add.y = y;\n  }\n\n  /**\n   * draw container border\n   */\n  _drawShapeLine() {\n    const y = this.index * this.height;\n    this.line.lineStyle(this.width, this.lineColor);\n    this.line.moveTo(this.x, y);\n    this.line.lineTo(this.x, y + this.height - 0.5);\n  }\n  /**\n   * map screen position to stage position as a PIXI point\n   * @protected\n   * @param x screen position x\n   * @param y screen position y\n   */\n  _mapScreenToStagePosition(x, y) {\n    const point = new Point();\n    this.app.renderer.plugins.interaction.mapPositionToPoint(point, x, y);\n    return point;\n  }\n}","map":{"version":3,"names":["v4","uuidv4","Point","Graphics","Text","Cursor","AddBar","constructor","options","id","addColor","lineColor","container","cursor","POINTER","index","x","width","radius","height","line","add","category","_ctrlKey","app","handleAdd","processPointerDown","event","data","button","processGlobalKeyDown","e","ctrlKey","processGlobalKeyUp","onAdd","interactive","document","addEventListener","on","DEFAULT","normalize","remove","removeChild","destroy","addChild","_drawAddShape","_drawShapeLine","beginFill","drawCircle","endFill","y","text","fill","fontSize","position","set","lineStyle","moveTo","lineTo","_mapScreenToStagePosition","point","renderer","plugins","interaction","mapPositionToPoint"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/phonetic-transcription/common/controls/AddBar.ts"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\nimport { Application, Point, Graphics, InteractionEvent, Container, Text } from 'pixi.js';\nimport Cursor from '../../../common/Cursor';\n\nexport interface AddBarOptions {\n  x: number;\n  index: number;\n  height: number;\n  category: string;\n  container: Container;\n  app: Application;\n  onAdd: (className: string, index: number) => void;\n}\n\nexport default class AddBar {\n  id = uuidv4();\n\n  addColor = 0x000000;\n\n  lineColor = 0xDADFE2;\n\n  container: Container;\n\n  cursor = Cursor.POINTER;\n\n  /**\n   * container index\n   */\n  index = 0;\n\n  /**\n   * position x\n   */\n  x = 0;\n\n  /**\n   * width\n   */\n  width = 3;\n\n  /**\n   * circle button radius\n   */\n  radius = 8;\n\n  /**\n   * height\n   */\n  height = 0;\n\n  /**\n   * PIXI instance\n   * @member {Graphics}\n   */\n  line = new Graphics();\n\n  /**\n   * PIXI instance\n   * @member {Graphics}\n   */\n  add = new Graphics();\n\n  /**\n   * tier category\n   */\n  category: string;\n\n  /**\n   * ctrl key hold on\n   */\n  _ctrlKey = false;\n\n  /**\n  * PIXI application\n  * @member {PIXI.Application}\n  */\n  app: Application;\n\n  /**\n   * handle add\n   */\n  handleAdd: (category: string, index: number) => void;\n\n  constructor(options: AddBarOptions) {\n    const { index, category, height, x, container, app, onAdd } = options;\n    this.app = app;\n    this.category = category;\n    this.height = height;\n    this.x = x;\n    this.container = container;\n    this.index = index;\n    this.add.interactive = true;\n    this.handleAdd = onAdd;\n    document.addEventListener('keydown', this.processGlobalKeyDown);\n    document.addEventListener('keyup', this.processGlobalKeyUp);\n    this.add.on('pointerdown', this.processPointerDown);\n    this.add.on('pointerover', () => {\n      this.add.cursor = Cursor.POINTER;\n    });\n    this.add.on('pointerout', () => {\n      this.add.cursor = Cursor.DEFAULT;\n    });\n    this.normalize();\n  }\n\n  remove() {\n    this.container.removeChild(this.line);\n    this.container.removeChild(this.add);\n    this.line.destroy();\n    this.add.destroy();\n  }\n\n  normalize() {\n    this.container.addChild(this.line);\n    this.container.addChild(this.add);\n    this._drawAddShape();\n    this._drawShapeLine();\n  }\n\n  /**\n   * draw container fill\n   */\n  private _drawAddShape() {\n    this.add.beginFill(this.addColor);\n    this.add.drawCircle(0, 0, this.radius);\n    this.add.endFill();\n    const y = this.index * this.height + this.radius * 1.5;\n    const text = new Text('+', { fill: 0xffffff, fontSize: 16 });\n    this.add.addChild(text);\n    text.position.set(-0.6 * this.radius, -1.2 * this.radius);\n    this.add.x = this.x;\n    this.add.y = y;\n  }\n\n  /**\n   * draw container border\n   */\n  private _drawShapeLine() {\n    const y = this.index * this.height;\n    this.line.lineStyle(this.width, this.lineColor);\n    this.line.moveTo(this.x, y);\n    this.line.lineTo(this.x, y + this.height - 0.5);\n  }\n\n  /**\n   * process pointerdown\n   * @param event\n   * @param frontTargets\n   */\n  processPointerDown = (event: InteractionEvent) => {\n    if (event.data.button === 2 && this._ctrlKey) {\n      return;\n    }\n    this.handleAdd(this.category, this.index);\n  };\n\n  /**\n   * process key down\n   * @param e\n   */\n  processGlobalKeyDown = (e: KeyboardEvent) => {\n    if (e.ctrlKey) {\n      this._ctrlKey = true;\n    }\n  };\n\n  /**\n   * process key up\n   */\n  processGlobalKeyUp = () => {\n    this._ctrlKey = false;\n  };\n\n  /**\n   * map screen position to stage position as a PIXI point\n   * @protected\n   * @param x screen position x\n   * @param y screen position y\n   */\n  protected _mapScreenToStagePosition(x: number, y: number) {\n    const point = new Point();\n    this.app.renderer.plugins.interaction.mapPositionToPoint(point, x, y);\n    return point;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}