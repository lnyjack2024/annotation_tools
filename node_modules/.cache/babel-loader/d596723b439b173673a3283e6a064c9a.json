{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/index.tsx\";\nimport React from 'react';\nimport { makeObservable, observable, action } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { message, notification, Modal } from 'antd';\nimport { isEqual } from 'lodash';\nimport AutoSaver from '../common/AutoSaver';\nimport LayoutWrapper from '../common/layout/LayoutWrapper';\nimport AppWrapper from '../common/shapes/wrapper/AppWrapper';\nimport CamerasContainer from './components/cameras/CamerasContainer';\nimport GridView from './components/grid/GridView';\nimport Toolbar from './components/toolbar/Toolbar';\nimport Sidebar from './components/sidebar/Sidebar';\nimport FrameControl from './components/frames/FrameControl';\nimport AttributesPanel from './components/attributes/AttributesPanel';\nimport AttributesModal from './components/attributes/AttributesModal';\nimport PointAttributesModal from './components/attributes/PointAttributesModal';\nimport FrameAttributesModal from './components/attributes/FrameAttributesModal';\nimport MovingModal from './components/move/MovingModal';\nimport ReviewModal from './components/review/ReviewModal';\nimport ReviewComment from './components/review/ReviewComment';\nimport RelationshipModal from './components/relationship/RelationshipModal';\nimport RelationshipMenu from './components/relationship/RelationshipMenu';\nimport store from './store/RootStore';\nimport bindKeyboardEvents from './keyboard-events';\nimport i18n from './locales';\nimport { getToolTypeFromFrameData } from './utils';\nimport { ViewMode, ReviewResult, ValidationType } from './types';\nimport { TOOLBAR_HEIGHT, SIDEBAR_WIDTH, ATTR_PANEL_WIDTH } from './constants';\nimport { methods } from './payload';\nimport './index.scss';\nexport class VideoTracking extends React.Component {\n  constructor(props) {\n    super(props);\n    /**\n     * auto saver reference\n     */\n    this.saverRef = React.createRef();\n    /**\n     * frame control height (default is 48 + 56 = 104)\n     */\n    this.frameControlHeight = 104;\n    /**\n     * keyboard events\n     */\n    this.removeKeyboardEvents = () => {};\n    /**\n     * save annotation data\n     */\n    this.saveResult = async () => {\n      var _this$saverRef$curren;\n      (_this$saverRef$curren = this.saverRef.current) === null || _this$saverRef$curren === void 0 ? void 0 : _this$saverRef$curren.disableLeaveCheck();\n      if (store.config.submitCheck || store.config.validationConfig[ValidationType.FRAME_VALID_ANNOTATE]) {\n        // validate before submit\n        await store.validation.defaultSync(true);\n        if (store.validation.blocked) {\n          throw new Error(i18n.translate('SUBMIT_CHECK_FAIL'));\n        }\n      }\n      return store.saveResult(true);\n    };\n    /**\n     * save review data\n     */\n    this.saveReviews = () => {\n      var _this$saverRef$curren2;\n      (_this$saverRef$curren2 = this.saverRef.current) === null || _this$saverRef$curren2 === void 0 ? void 0 : _this$saverRef$curren2.disableLeaveCheck();\n      return store.saveReviews();\n    };\n    /**\n     * save data\n     * @param isAutoSave\n     */\n    this.save = async (isAutoSave = false) => {\n      if (!store.initialized || store.isPreview) {\n        // not initialized, or is preview mode\n        return;\n      }\n      const promises = [];\n      if (!store.readonly) {\n        promises.push(store.saveResult());\n      }\n      if (store.reviewable) {\n        promises.push(store.saveReviews());\n      }\n      if (promises.length > 0) {\n        try {\n          var _this$saverRef$curren3;\n          await Promise.all(promises);\n          message.success(i18n.translate(isAutoSave ? 'SAVE_AUTO_SUCCESS' : 'SAVE_SUCCESS'));\n          // update tempSaved flag\n          (_this$saverRef$curren3 = this.saverRef.current) === null || _this$saverRef$curren3 === void 0 ? void 0 : _this$saverRef$curren3.setTempSaved(true);\n        } catch (e) {\n          if (!isAutoSave) {\n            message.error(i18n.translate('SAVE_FAIL'));\n          } else {\n            throw e;\n          }\n        }\n      }\n    };\n    /**\n     * is annotation modified\n     */\n    this.isModified = () => {\n      const {\n        instances,\n        frames,\n        relationships\n      } = store.initialData || {};\n      const currInstances = store.instance.instancesJSON();\n      const currFrames = store.frame.framesJSON();\n      const currRelationships = store.relationship.relationshipsJSON();\n      return !isEqual(currInstances, instances) || !isEqual(currFrames, frames) || !isEqual(relationships, currRelationships);\n    };\n    /**\n     * get review statistics\n     */\n    this.getStatistics = () => {\n      const shapes = {};\n      const objects = {\n        total: 0,\n        approved: 0,\n        rejected: 0,\n        suspended: 0,\n        missed: 0\n      };\n      const {\n        instances: instancesMap\n      } = store.instance;\n      const instances = Object.values(instancesMap);\n      for (let i = 0; i < instances.length; i += 1) {\n        const instance = instances[i];\n        const items = Object.values(instance.items);\n        for (let j = 0; j < items.length; j += 1) {\n          const item = items[j];\n          const cameras = Object.values(item.cameras);\n          for (let k = 0; k < cameras.length; k += 1) {\n            const camera = cameras[k];\n            const frames = Object.values(camera.frames);\n            for (let l = 0; l < frames.length; l += 1) {\n              const frame = frames[l];\n              const shape = `${getToolTypeFromFrameData(frame)}`;\n              if (!shapes[shape]) {\n                shapes[shape] = {\n                  total: 0,\n                  approved: 0,\n                  rejected: 0,\n                  suspended: 0,\n                  missed: 0\n                };\n              }\n              objects.total += 1;\n              shapes[shape].total += 1;\n              const reviewResult = store.review.getReviewForInstanceItem(item, camera.camera, frame.frameIndex);\n              if (reviewResult === ReviewResult.REJECT) {\n                shapes[shape].rejected += 1;\n                objects.rejected += 1;\n              } else if (reviewResult === ReviewResult.SUSPEND) {\n                shapes[shape].suspended += 1;\n                objects.suspended += 1;\n              } else {\n                shapes[shape].approved += 1;\n                objects.approved += 1;\n              }\n            }\n          }\n        }\n      }\n      const frameReviewStatus = Array.from({\n        length: store.frame.frameCount\n      }).fill(ReviewResult.APPROVE);\n      store.review.allReviews.forEach(({\n        frameIndex,\n        result,\n        instanceId,\n        instanceItemId,\n        camera\n      }) => {\n        if (result === ReviewResult.REJECT) {\n          frameReviewStatus[frameIndex] = ReviewResult.REJECT;\n          // calc missed\n          let shapeExisted = true;\n          if (!instanceId || !instanceItemId) {\n            shapeExisted = false;\n          } else {\n            const instance = instancesMap[instanceId];\n            if (!instance) {\n              shapeExisted = false;\n            } else {\n              const item = instance.items[instanceItemId];\n              if (!item) {\n                shapeExisted = false;\n              } else {\n                const cameraData = item.cameras[camera];\n                if (!cameraData) {\n                  shapeExisted = false;\n                } else {\n                  const frameData = cameraData.frames[frameIndex];\n                  if (!frameData) {\n                    shapeExisted = false;\n                  }\n                }\n              }\n            }\n          }\n          if (!shapeExisted) {\n            objects.total += 1;\n            objects.missed += 1;\n          }\n        } else if (result === ReviewResult.SUSPEND && frameReviewStatus[frameIndex] !== ReviewResult.REJECT) {\n          frameReviewStatus[frameIndex] = ReviewResult.SUSPEND;\n        }\n      });\n      return {\n        objects,\n        shapes,\n        frames: {\n          total: frameReviewStatus.length,\n          approved: frameReviewStatus.filter(i => i === ReviewResult.APPROVE).length,\n          rejected: frameReviewStatus.filter(i => i === ReviewResult.REJECT).length,\n          suspended: frameReviewStatus.filter(i => i === ReviewResult.SUSPEND).length,\n          missed: 0\n        }\n      };\n    };\n    /**\n     * handle hotkey events\n     * @param hotkey\n     */\n    this.handleHotkey = hotkey => {\n      if (store.readonly || store.isPreview) {\n        return;\n      }\n      const pointHotkeyItems = store.config.pointHotkeyMap[hotkey];\n      if (pointHotkeyItems.length > 0) {\n        // affect point, set polygon point\n        if (store.config.viewMode === ViewMode.DEFAULT) {\n          const {\n            drawingShape,\n            selectedShapes\n          } = store.shape;\n          const selectedShape = selectedShapes.length === 1 ? selectedShapes[0] : undefined;\n          const shape = store.config.addMode ? drawingShape : selectedShape;\n          if (shape) {\n            store.shape.setPointsUserDataByHotkey(shape, hotkey);\n          }\n        } else if (store.config.viewMode === ViewMode.GRID) {\n          const shape = store.config.addMode ? store.grid.getCurrentDrawingShape() : store.grid.getCurrentSelectedShape();\n          if (shape) {\n            store.shape.setPointsUserDataByHotkey(shape, hotkey);\n          }\n        }\n      }\n    };\n    /**\n     * update frame control height\n     * @param height\n     */\n    this.updateFrameControlHeight = height => {\n      this.frameControlHeight = height;\n    };\n    makeObservable(this, {\n      frameControlHeight: observable,\n      updateFrameControlHeight: action\n    });\n\n    // setup i18n\n    i18n.setLocale(this.props.locale);\n    // set props\n    store.jobProxy = this.props.jobProxy;\n  }\n  async componentDidMount() {\n    this.removeKeyboardEvents = bindKeyboardEvents(this);\n    // init store\n    try {\n      await store.init(this.props);\n    } catch (e) {\n      notification.error({\n        message: e.message,\n        duration: null\n      });\n      return;\n    }\n    // render completed\n    this.props.renderComplete();\n    if (this.props.jobProxy.savedDataLoadError) {\n      Modal.info({\n        title: i18n.translate('TEMP_SAVED_LOAD_ERROR'),\n        okText: i18n.translate('TEMP_SAVED_LOAD_ERROR_OK'),\n        autoFocusButton: null,\n        onOk: () => {\n          var _this$saverRef$curren4;\n          // set temp saved to true to disable leave check\n          (_this$saverRef$curren4 = this.saverRef.current) === null || _this$saverRef$curren4 === void 0 ? void 0 : _this$saverRef$curren4.setTempSaved(true);\n          window.location.reload();\n        },\n        onCancel: () => {\n          // set to false to enable result save\n          this.props.jobProxy.savedDataLoadError = false;\n        }\n      });\n    }\n  }\n  componentWillUnmount() {\n    this.removeKeyboardEvents();\n    store.terminate();\n  }\n  render() {\n    const {\n      viewMode\n    } = store.config;\n    const {\n      loading,\n      frameCount\n    } = store.frame;\n    const hasFrameControl = frameCount > 1;\n    return /*#__PURE__*/React.createElement(LayoutWrapper, {\n      className: \"video-tracking-app\",\n      loading: loading || store.shape.projecting || !store.initialized,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(AutoSaver, {\n      ref: this.saverRef,\n      leaveCheck: true,\n      data: {\n        storePointer: store.undo.pointer,\n        storeId: store.undo.lastStoreId\n      },\n      save: () => this.save(true),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Toolbar, {\n      onSave: () => this.save(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      style: {\n        height: `calc(100% - ${hasFrameControl ? `${this.frameControlHeight + TOOLBAR_HEIGHT}px` : `${TOOLBAR_HEIGHT}px`})`\n        // transition: 'height 0.15s',\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Sidebar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: `calc(100% - ${SIDEBAR_WIDTH + ATTR_PANEL_WIDTH}px)`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 11\n      }\n    }, viewMode === ViewMode.DEFAULT && /*#__PURE__*/React.createElement(CamerasContainer, {\n      app: this.props.app,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 15\n      }\n    }), viewMode === ViewMode.GRID && /*#__PURE__*/React.createElement(GridView, {\n      app: this.props.app,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(AttributesPanel, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 11\n      }\n    })), hasFrameControl && /*#__PURE__*/React.createElement(FrameControl, {\n      onHeightChange: this.updateFrameControlHeight,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(AttributesModal, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(PointAttributesModal, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(FrameAttributesModal, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(MovingModal, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(ReviewModal, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(ReviewComment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(RelationshipModal, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(RelationshipMenu, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }\n    }));\n  }\n}\nexport default AppWrapper(observer(VideoTracking), {\n  mappingMethods: Object.values(methods)\n});","map":{"version":3,"names":["React","makeObservable","observable","action","observer","message","notification","Modal","isEqual","AutoSaver","LayoutWrapper","AppWrapper","CamerasContainer","GridView","Toolbar","Sidebar","FrameControl","AttributesPanel","AttributesModal","PointAttributesModal","FrameAttributesModal","MovingModal","ReviewModal","ReviewComment","RelationshipModal","RelationshipMenu","store","bindKeyboardEvents","i18n","getToolTypeFromFrameData","ViewMode","ReviewResult","ValidationType","TOOLBAR_HEIGHT","SIDEBAR_WIDTH","ATTR_PANEL_WIDTH","methods","VideoTracking","Component","constructor","props","saverRef","createRef","frameControlHeight","removeKeyboardEvents","saveResult","_this$saverRef$curren","current","disableLeaveCheck","config","submitCheck","validationConfig","FRAME_VALID_ANNOTATE","validation","defaultSync","blocked","Error","translate","saveReviews","_this$saverRef$curren2","save","isAutoSave","initialized","isPreview","promises","readonly","push","reviewable","length","_this$saverRef$curren3","Promise","all","success","setTempSaved","e","error","isModified","instances","frames","relationships","initialData","currInstances","instance","instancesJSON","currFrames","frame","framesJSON","currRelationships","relationship","relationshipsJSON","getStatistics","shapes","objects","total","approved","rejected","suspended","missed","instancesMap","Object","values","i","items","j","item","cameras","k","camera","l","shape","reviewResult","review","getReviewForInstanceItem","frameIndex","REJECT","SUSPEND","frameReviewStatus","Array","from","frameCount","fill","APPROVE","allReviews","forEach","result","instanceId","instanceItemId","shapeExisted","cameraData","frameData","filter","handleHotkey","hotkey","pointHotkeyItems","pointHotkeyMap","viewMode","DEFAULT","drawingShape","selectedShapes","selectedShape","undefined","addMode","setPointsUserDataByHotkey","GRID","grid","getCurrentDrawingShape","getCurrentSelectedShape","updateFrameControlHeight","height","setLocale","locale","jobProxy","componentDidMount","init","duration","renderComplete","savedDataLoadError","info","title","okText","autoFocusButton","onOk","_this$saverRef$curren4","window","location","reload","onCancel","componentWillUnmount","terminate","render","loading","hasFrameControl","createElement","className","projecting","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","leaveCheck","data","storePointer","undo","pointer","storeId","lastStoreId","onSave","style","width","app","onHeightChange","mappingMethods"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/index.tsx"],"sourcesContent":["import React from 'react';\nimport { makeObservable, observable, action } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { message, notification, Modal } from 'antd';\nimport { isEqual } from 'lodash';\nimport AutoSaver from '../common/AutoSaver';\nimport LayoutWrapper from '../common/layout/LayoutWrapper';\nimport AppWrapper from '../common/shapes/wrapper/AppWrapper';\nimport CamerasContainer from './components/cameras/CamerasContainer';\nimport GridView from './components/grid/GridView';\nimport Toolbar from './components/toolbar/Toolbar';\nimport Sidebar from './components/sidebar/Sidebar';\nimport FrameControl from './components/frames/FrameControl';\nimport AttributesPanel from './components/attributes/AttributesPanel';\nimport AttributesModal from './components/attributes/AttributesModal';\nimport PointAttributesModal from './components/attributes/PointAttributesModal';\nimport FrameAttributesModal from './components/attributes/FrameAttributesModal';\nimport MovingModal from './components/move/MovingModal';\nimport ReviewModal from './components/review/ReviewModal';\nimport ReviewComment from './components/review/ReviewComment';\nimport RelationshipModal from './components/relationship/RelationshipModal';\nimport RelationshipMenu from './components/relationship/RelationshipMenu';\nimport store from './store/RootStore';\nimport bindKeyboardEvents from './keyboard-events';\nimport i18n from './locales';\nimport { getToolTypeFromFrameData } from './utils';\nimport { Payload, ViewMode, ReviewResult, ValidationType } from './types';\nimport { TOOLBAR_HEIGHT, SIDEBAR_WIDTH, ATTR_PANEL_WIDTH } from './constants';\nimport { methods } from './payload';\nimport './index.scss';\n\ninterface VideoTrackingProps extends Payload {\n  renderComplete: () => Promise<void>;\n}\n\nexport class VideoTracking extends React.Component<VideoTrackingProps> {\n  /**\n   * auto saver reference\n   */\n  saverRef = React.createRef<AutoSaver>();\n\n  /**\n   * frame control height (default is 48 + 56 = 104)\n   */\n  frameControlHeight = 104;\n\n  /**\n   * keyboard events\n   */\n  removeKeyboardEvents = () => {};\n\n  constructor(props: VideoTrackingProps) {\n    super(props);\n\n    makeObservable(this, {\n      frameControlHeight: observable,\n      updateFrameControlHeight: action,\n    });\n\n    // setup i18n\n    i18n.setLocale(this.props.locale);\n    // set props\n    store.jobProxy = this.props.jobProxy;\n  }\n\n  async componentDidMount() {\n    this.removeKeyboardEvents = bindKeyboardEvents(this);\n    // init store\n    try {\n      await store.init(this.props);\n    } catch (e) {\n      notification.error({ message: (e as Error).message, duration: null });\n      return;\n    }\n    // render completed\n    this.props.renderComplete();\n\n    if (this.props.jobProxy.savedDataLoadError) {\n      Modal.info({\n        title: i18n.translate('TEMP_SAVED_LOAD_ERROR'),\n        okText: i18n.translate('TEMP_SAVED_LOAD_ERROR_OK'),\n        autoFocusButton: null,\n        onOk: () => {\n          // set temp saved to true to disable leave check\n          this.saverRef.current?.setTempSaved(true);\n          window.location.reload();\n        },\n        onCancel: () => {\n          // set to false to enable result save\n          this.props.jobProxy.savedDataLoadError = false;\n        },\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeKeyboardEvents();\n    store.terminate();\n  }\n\n  /**\n   * save annotation data\n   */\n  saveResult = async () => {\n    this.saverRef.current?.disableLeaveCheck();\n    if (store.config.submitCheck || store.config.validationConfig[ValidationType.FRAME_VALID_ANNOTATE]) {\n      // validate before submit\n      await store.validation.defaultSync(true);\n      if (store.validation.blocked) {\n        throw new Error(i18n.translate('SUBMIT_CHECK_FAIL'));\n      }\n    }\n    return store.saveResult(true);\n  };\n\n  /**\n   * save review data\n   */\n  saveReviews = () => {\n    this.saverRef.current?.disableLeaveCheck();\n    return store.saveReviews();\n  };\n\n  /**\n   * save data\n   * @param isAutoSave\n   */\n  save = async (isAutoSave = false) => {\n    if (!store.initialized || store.isPreview) { // not initialized, or is preview mode\n      return;\n    }\n\n    const promises = [];\n    if (!store.readonly) {\n      promises.push(store.saveResult());\n    }\n    if (store.reviewable) {\n      promises.push(store.saveReviews());\n    }\n    if (promises.length > 0) {\n      try {\n        await Promise.all(promises);\n        message.success(i18n.translate(isAutoSave ? 'SAVE_AUTO_SUCCESS' : 'SAVE_SUCCESS'));\n        // update tempSaved flag\n        this.saverRef.current?.setTempSaved(true);\n      } catch (e) {\n        if (!isAutoSave) {\n          message.error(i18n.translate('SAVE_FAIL'));\n        } else {\n          throw e;\n        }\n      }\n    }\n  };\n\n  /**\n   * is annotation modified\n   */\n  isModified = () => {\n    const { instances, frames, relationships } = store.initialData || {};\n    const currInstances = store.instance.instancesJSON();\n    const currFrames = store.frame.framesJSON();\n    const currRelationships = store.relationship.relationshipsJSON();\n    return !isEqual(currInstances, instances) || !isEqual(currFrames, frames) || !isEqual(relationships, currRelationships);\n  };\n\n  /**\n   * get review statistics\n   */\n  getStatistics = () => {\n    const shapes: {\n      [shape: string]: { total: number; approved: number; rejected: number; suspended: number; missed: number };\n    } = {};\n    const objects = { total: 0, approved: 0, rejected: 0, suspended: 0, missed: 0 };\n\n    const { instances: instancesMap } = store.instance;\n    const instances = Object.values(instancesMap);\n    for (let i = 0; i < instances.length; i += 1) {\n      const instance = instances[i];\n      const items = Object.values(instance.items);\n      for (let j = 0; j < items.length; j += 1) {\n        const item = items[j];\n        const cameras = Object.values(item.cameras);\n        for (let k = 0; k < cameras.length; k += 1) {\n          const camera = cameras[k];\n          const frames = Object.values(camera.frames);\n          for (let l = 0; l < frames.length; l += 1) {\n            const frame = frames[l];\n            const shape = `${getToolTypeFromFrameData(frame)}`;\n            if (!shapes[shape]) {\n              shapes[shape] = { total: 0, approved: 0, rejected: 0, suspended: 0, missed: 0 };\n            }\n            objects.total += 1;\n            shapes[shape].total += 1;\n            const reviewResult = store.review.getReviewForInstanceItem(item, camera.camera, frame.frameIndex);\n            if (reviewResult === ReviewResult.REJECT) {\n              shapes[shape].rejected += 1;\n              objects.rejected += 1;\n            } else if (reviewResult === ReviewResult.SUSPEND) {\n              shapes[shape].suspended += 1;\n              objects.suspended += 1;\n            } else {\n              shapes[shape].approved += 1;\n              objects.approved += 1;\n            }\n          }\n        }\n      }\n    }\n    const frameReviewStatus = Array.from({ length: store.frame.frameCount }).fill(ReviewResult.APPROVE);\n    store.review.allReviews.forEach(({ frameIndex, result, instanceId, instanceItemId, camera }) => {\n      if (result === ReviewResult.REJECT) {\n        frameReviewStatus[frameIndex] = ReviewResult.REJECT;\n        // calc missed\n        let shapeExisted = true;\n        if (!instanceId || !instanceItemId) {\n          shapeExisted = false;\n        } else {\n          const instance = instancesMap[instanceId];\n          if (!instance) {\n            shapeExisted = false;\n          } else {\n            const item = instance.items[instanceItemId];\n            if (!item) {\n              shapeExisted = false;\n            } else {\n              const cameraData = item.cameras[camera];\n              if (!cameraData) {\n                shapeExisted = false;\n              } else {\n                const frameData = cameraData.frames[frameIndex];\n                if (!frameData) {\n                  shapeExisted = false;\n                }\n              }\n            }\n          }\n        }\n        if (!shapeExisted) {\n          objects.total += 1;\n          objects.missed += 1;\n        }\n      } else if (result === ReviewResult.SUSPEND && frameReviewStatus[frameIndex] !== ReviewResult.REJECT) {\n        frameReviewStatus[frameIndex] = ReviewResult.SUSPEND;\n      }\n    });\n    return {\n      objects,\n      shapes,\n      frames: {\n        total: frameReviewStatus.length,\n        approved: frameReviewStatus.filter((i) => i === ReviewResult.APPROVE).length,\n        rejected: frameReviewStatus.filter((i) => i === ReviewResult.REJECT).length,\n        suspended: frameReviewStatus.filter((i) => i === ReviewResult.SUSPEND).length,\n        missed: 0,\n      },\n    };\n  };\n\n  /**\n   * handle hotkey events\n   * @param hotkey\n   */\n  handleHotkey = (hotkey: string) => {\n    if (store.readonly || store.isPreview) {\n      return;\n    }\n    const pointHotkeyItems = store.config.pointHotkeyMap[hotkey];\n    if (pointHotkeyItems.length > 0) {\n      // affect point, set polygon point\n      if (store.config.viewMode === ViewMode.DEFAULT) {\n        const { drawingShape, selectedShapes } = store.shape;\n        const selectedShape = selectedShapes.length === 1 ? selectedShapes[0] : undefined;\n        const shape = store.config.addMode ? drawingShape : selectedShape;\n        if (shape) {\n          store.shape.setPointsUserDataByHotkey(shape, hotkey);\n        }\n      } else if (store.config.viewMode === ViewMode.GRID) {\n        const shape = store.config.addMode ? store.grid.getCurrentDrawingShape() : store.grid.getCurrentSelectedShape();\n        if (shape) {\n          store.shape.setPointsUserDataByHotkey(shape, hotkey);\n        }\n      }\n    }\n  };\n\n  /**\n   * update frame control height\n   * @param height\n   */\n  updateFrameControlHeight = (height: number) => {\n    this.frameControlHeight = height;\n  };\n\n  render() {\n    const { viewMode } = store.config;\n    const { loading, frameCount } = store.frame;\n    const hasFrameControl = frameCount > 1;\n    return (\n      <LayoutWrapper\n        className=\"video-tracking-app\"\n        loading={loading || store.shape.projecting || !store.initialized}\n      >\n        <AutoSaver\n          ref={this.saverRef}\n          leaveCheck\n          data={{ storePointer: store.undo.pointer, storeId: store.undo.lastStoreId }}\n          save={() => this.save(true)}\n        />\n        <Toolbar onSave={() => this.save()} />\n        <div\n          className=\"container\"\n          style={{\n            height: `calc(100% - ${hasFrameControl ? `${this.frameControlHeight + TOOLBAR_HEIGHT}px` : `${TOOLBAR_HEIGHT}px`})`,\n            // transition: 'height 0.15s',\n          }}\n        >\n          <Sidebar />\n          <div style={{ width: `calc(100% - ${SIDEBAR_WIDTH + ATTR_PANEL_WIDTH}px)` }}>\n            {viewMode === ViewMode.DEFAULT && (\n              <CamerasContainer app={this.props.app} />\n            )}\n            {viewMode === ViewMode.GRID && (\n              <GridView app={this.props.app} />\n            )}\n          </div>\n          <AttributesPanel />\n        </div>\n        {hasFrameControl && (\n          <FrameControl onHeightChange={this.updateFrameControlHeight} />\n        )}\n        <AttributesModal />\n        <PointAttributesModal />\n        <FrameAttributesModal />\n        <MovingModal />\n        <ReviewModal />\n        <ReviewComment />\n        <RelationshipModal />\n        <RelationshipMenu />\n      </LayoutWrapper>\n    );\n  }\n}\n\nexport default AppWrapper(observer(VideoTracking), {\n  mappingMethods: Object.values(methods),\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}