{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/SidebarInstance.tsx\";\nimport React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport cx from 'classnames';\nimport { CaretDownOutlined, PlusCircleFilled } from '@ant-design/icons';\nimport CameraInstanceItemList from './CameraInstanceItemList';\nimport InstanceItemMenu from './InstanceItemMenu';\nimport InstanceItemReviewIcon from './InstanceItemReviewIcon';\nimport RelationshipsCount from './RelationshipsCount';\nimport ShapeLabel from './ShapeLabel';\nimport store from '../../store/RootStore';\nconst SidebarInstance = observer(({\n  instance\n}) => {\n  const [hovered, setHovered] = useState(false);\n  const [menuVisible, setMenuVisible] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({\n    x: -1,\n    y: -1\n  });\n  const collapse = e => {\n    e.stopPropagation();\n    instance.setCollapsed(!instance.collapsed);\n  };\n  const {\n    currentCamera,\n    currentFrame,\n    isSingleCamera,\n    cameraNames\n  } = store.frame;\n  const isSingle = instance.isSingle && isSingleCamera;\n  const isHidden = instance.frameStatus[currentFrame] === undefined;\n  const isSelected = isSingle ? instance.selected : instance.selected && store.instance.selectedInstanceItems.filter(item => item.instance).length <= 0;\n  if (!store.config.autoTracking && isHidden) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: `sidebar-category-instance-${instance.id}`,\n    className: \"sidebar-category-instance\",\n    onMouseEnter: () => setHovered(true),\n    onMouseLeave: () => setHovered(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx('sidebar-category-instance__label', {\n      single: isSingle,\n      hidden: isHidden,\n      selected: isSelected\n    }),\n    onClick: () => {\n      if (!isSingle) {\n        store.instance.selectInstanceItem(null);\n      }\n      store.instance.selectInstance(instance, true);\n    },\n    onContextMenu: e => {\n      e.preventDefault();\n      store.instance.selectInstance(instance);\n      if (isSingle && !isHidden) {\n        setMenuPosition({\n          x: e.clientX,\n          y: e.clientY\n        });\n        setMenuVisible(true);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }\n  }, isSingle ? /*#__PURE__*/React.createElement(ShapeLabel, {\n    item: Object.values(instance.items)[0],\n    camera: currentCamera,\n    label: instance.label,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }\n  }, instance.label), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar-category-action\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, !isSingle && /*#__PURE__*/React.createElement(CaretDownOutlined, {\n    className: \"sidebar-category-icon\",\n    style: {\n      transform: instance.collapsed ? 'rotate(270deg)' : ''\n    },\n    onClick: collapse,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }), isSingle && /*#__PURE__*/React.createElement(RelationshipsCount, {\n    item: Object.values(instance.items)[0],\n    camera: currentCamera,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }\n  }), !store.readonly && isSingle && isHidden && hovered && /*#__PURE__*/React.createElement(PlusCircleFilled, {\n    style: {\n      cursor: 'pointer'\n    },\n    onClick: () => store.addToCurrentFrame(Object.values(instance.items)[0]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }\n  }), isSingle && !isHidden && /*#__PURE__*/React.createElement(InstanceItemReviewIcon, {\n    item: Object.values(instance.items)[0],\n    camera: currentCamera,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }))), !instance.collapsed && !isSingle && cameraNames.map((c, i) => /*#__PURE__*/React.createElement(CameraInstanceItemList, {\n    key: c,\n    instance: instance,\n    camera: c,\n    cameraIndex: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  })), isSingle && /*#__PURE__*/React.createElement(InstanceItemMenu, {\n    instanceItem: Object.values(instance.items)[0],\n    camera: currentCamera,\n    position: menuPosition,\n    visible: menuVisible,\n    onClose: () => setMenuVisible(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }));\n});\nexport default SidebarInstance;","map":{"version":3,"names":["React","useState","observer","cx","CaretDownOutlined","PlusCircleFilled","CameraInstanceItemList","InstanceItemMenu","InstanceItemReviewIcon","RelationshipsCount","ShapeLabel","store","SidebarInstance","instance","hovered","setHovered","menuVisible","setMenuVisible","menuPosition","setMenuPosition","x","y","collapse","e","stopPropagation","setCollapsed","collapsed","currentCamera","currentFrame","isSingleCamera","cameraNames","frame","isSingle","isHidden","frameStatus","undefined","isSelected","selected","selectedInstanceItems","filter","item","length","config","autoTracking","createElement","id","className","onMouseEnter","onMouseLeave","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","single","hidden","onClick","selectInstanceItem","selectInstance","onContextMenu","preventDefault","clientX","clientY","Object","values","items","camera","label","style","transform","readonly","cursor","addToCurrentFrame","map","c","i","key","cameraIndex","instanceItem","position","visible","onClose"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/SidebarInstance.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport cx from 'classnames';\nimport { CaretDownOutlined, PlusCircleFilled } from '@ant-design/icons';\nimport CameraInstanceItemList from './CameraInstanceItemList';\nimport InstanceItemMenu from './InstanceItemMenu';\nimport InstanceItemReviewIcon from './InstanceItemReviewIcon';\nimport RelationshipsCount from './RelationshipsCount';\nimport ShapeLabel from './ShapeLabel';\nimport Instance from '../../model/Instance';\nimport store from '../../store/RootStore';\n\ninterface SidebarInstanceProps {\n  instance: Instance;\n}\n\nconst SidebarInstance = observer(({ instance }: SidebarInstanceProps) => {\n  const [hovered, setHovered] = useState(false);\n  const [menuVisible, setMenuVisible] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({ x: -1, y: -1 });\n\n  const collapse = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    instance.setCollapsed(!instance.collapsed);\n  };\n\n  const { currentCamera, currentFrame, isSingleCamera, cameraNames } = store.frame;\n  const isSingle = instance.isSingle && isSingleCamera;\n  const isHidden = instance.frameStatus[currentFrame] === undefined;\n  const isSelected = isSingle ? instance.selected : instance.selected && store.instance.selectedInstanceItems.filter((item) => item.instance).length <= 0;\n  if (!store.config.autoTracking && isHidden) {\n    return null;\n  }\n  return (\n    <div\n      id={`sidebar-category-instance-${instance.id}`}\n      className=\"sidebar-category-instance\"\n      onMouseEnter={() => setHovered(true)}\n      onMouseLeave={() => setHovered(false)}\n    >\n      <div\n        className={cx('sidebar-category-instance__label', {\n          single: isSingle,\n          hidden: isHidden,\n          selected: isSelected,\n        })}\n        onClick={() => {\n          if (!isSingle) {\n            store.instance.selectInstanceItem(null);\n          }\n          store.instance.selectInstance(instance, true);\n        }}\n        onContextMenu={(e) => {\n          e.preventDefault();\n          store.instance.selectInstance(instance);\n          if (isSingle && !isHidden) {\n            setMenuPosition({ x: e.clientX, y: e.clientY });\n            setMenuVisible(true);\n          }\n        }}\n      >\n        {isSingle ? (\n          <ShapeLabel item={Object.values(instance.items)[0]} camera={currentCamera} label={instance.label} />\n        ) : <div>{instance.label}</div>}\n        <div className=\"sidebar-category-action\">\n          {!isSingle && (\n            <CaretDownOutlined\n              className=\"sidebar-category-icon\"\n              style={{\n                transform: instance.collapsed ? 'rotate(270deg)' : '',\n              }}\n              onClick={collapse}\n            />\n          )}\n          {isSingle && (\n            <RelationshipsCount item={Object.values(instance.items)[0]} camera={currentCamera} />\n          )}\n          {!store.readonly && isSingle && isHidden && hovered && (\n            <PlusCircleFilled\n              style={{ cursor: 'pointer' }}\n              onClick={() => store.addToCurrentFrame(Object.values(instance.items)[0])}\n            />\n          )}\n          {isSingle && !isHidden && (\n            <InstanceItemReviewIcon item={Object.values(instance.items)[0]} camera={currentCamera} />\n          )}\n        </div>\n      </div>\n      {!instance.collapsed && !isSingle && cameraNames.map((c, i) => (\n        <CameraInstanceItemList key={c} instance={instance} camera={c} cameraIndex={i} />\n      ))}\n      {isSingle && (\n        <InstanceItemMenu\n          instanceItem={Object.values(instance.items)[0]}\n          camera={currentCamera}\n          position={menuPosition}\n          visible={menuVisible}\n          onClose={() => setMenuVisible(false)}\n        />\n      )}\n    </div>\n  );\n});\n\nexport default SidebarInstance;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}