{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/withConnect.tsx\";\n/* eslint-disable @typescript-eslint/no-explicit-any, no-plusplus */\nimport React, { useState, useEffect, useRef } from 'react';\nimport { connectToParent } from 'penpal';\nimport { useActivityDispatcher } from 'use-activity-dispatcher';\nimport { checkRunningMode, fetchResultByUrl, getLocale } from '../utils';\nimport { RunningMode, SubmitChannel, SubmitChannelPayload } from '../types';\nimport { isLabel, isQA, isPreview, isTemplatePreview, isAudit } from '../utils/tool-mode';\nimport JobProxy from '../libs/JobProxy';\nimport tracker from '../utils/tracker';\nimport advanceJob, { AdvanceMessage } from '../libs/advanceJob';\n;\nconst isCallableFunc = func => func && ({}.toString.call(func) === '[object Function]' || {}.toString.call(func) === '[object AsyncFunction]');\nconst withConnect = ({\n  type,\n  methods = {},\n  samplePayload\n}) => WrappedComponent => () => {\n  useActivityDispatcher();\n  const tool = useRef();\n  const mode = checkRunningMode();\n  const [payload, setPayload] = useState(null);\n  // functions that parent provides\n  const saveContent = useRef(() => {});\n  const loadContent = useRef(() => {});\n  const renderComplete = useRef(() => {});\n  const onShortcutsClick = useRef(() => {});\n  const validateContent = useRef(() => {});\n  const trackingStats = useRef(() => {});\n  // job proxy\n  const jobProxy = useRef();\n  useEffect(() => {\n    window.T = {\n      reloadResultByUrl: async url => {\n        try {\n          const result = await fetchResultByUrl(url);\n          advanceJob.emit(AdvanceMessage.UPDATE_RESULT, {\n            result\n          });\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.log('Reload result error:', e);\n        }\n      }\n    };\n  }, []);\n  useEffect(() => {\n    if (mode === RunningMode.IFRAME) {\n      // set up iframe connection when the app is running in an iframe\n      const connection = connectToParent({\n        methods: {\n          onSubmit: async (...args) => {\n            const func = methods.onSubmit || 'onSubmit';\n            if (isCallableFunc(tool.current[func])) {\n              const values = await tool.current[func](...args);\n              // make sure onSubmit returns a string\n              // consume this value in each tool itself or its custom tag in mashup\n              return typeof values === 'string' ? values : JSON.stringify(values);\n            }\n            return '';\n          },\n          cleanData: () => {\n            const func = methods.cleanData || 'cleanData';\n            if (isCallableFunc(tool.current[func])) {\n              tool.current[func]();\n            }\n          },\n          isModified: () => {\n            const func = methods.isModified || 'isModified';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            // return null if this method not provided\n            return null;\n          },\n          getStatistics: () => {\n            const func = methods.getStatistics || 'getStatistics';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            return undefined;\n          },\n          getReviews: () => {\n            // eslint-disable-next-line no-console\n            console.log('in get reviews');\n            const func = methods.getReviews || 'getReviews';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            return undefined;\n          },\n          submitReviews: () => {\n            // eslint-disable-next-line no-console\n            console.log('in submit reviews');\n            const func = methods.submitReviews || 'submitReviews';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            return undefined;\n          },\n          updateResource: data => {\n            const func = methods.updateResource || 'updateResource';\n            if (isCallableFunc(tool.current[func])) {\n              tool.current[func](data);\n            }\n          }\n        }\n      });\n      saveContent.current = args => new Promise((resolve, reject) => {\n        connection.promise.then(parent => parent.saveNewContent ? parent.saveNewContent(args) : parent.saveContent(args.b64Content, args.type, args.filename, args.filePrefix, args.jobId, args.projectId, args.recordId, args.toolFileType, args.flowId, args.businessType)).then(url => {\n          resolve(url);\n        }).catch(e => {\n          reject(e);\n        });\n      });\n      loadContent.current = (...args) => new Promise((resolve, reject) => {\n        connection.promise.then(parent => parent.loadContent(...args)).then(data => {\n          resolve(data);\n        }).catch(e => {\n          reject(e);\n        });\n      });\n      renderComplete.current = () => {\n        advanceJob.startInterval();\n        connection.promise.then(parent => parent.renderComplete());\n      };\n      validateContent.current = (content, flowData, timeout) => new Promise((resolve, reject) => {\n        connection.promise.then(parent => parent.validateContent(JSON.stringify({\n          content,\n          flowData: JSON.parse(flowData || '{}')\n        }), timeout)).then(res => {\n          resolve(res);\n        }).catch(e => {\n          reject(e);\n        });\n      });\n      trackingStats.current = statsPayload => new Promise((resolve, reject) => {\n        connection.promise.then(async parent => {\n          if (isCallableFunc(parent.trackingStats)) {\n            await parent.trackingStats(statsPayload);\n          }\n          resolve();\n        }).catch(e => {\n          reject(e);\n        });\n      });\n\n      // get payload from parent\n      connection.promise.then(parent => parent.getPayload()).then(p => {\n        initTrack(p);\n        initJobProxy(p);\n        setPayload(p);\n      });\n      onShortcutsClick.current = (...args) => connection.promise.then(parent => parent.onShortcutsClick(...args));\n      window.addEventListener('keydown', initShortcutsEvent);\n    }\n    if (mode === RunningMode.STANDALONE) {\n      saveContent.current = async params => {\n        function binaryStringToArrayBuffer(binary) {\n          const length = binary.length;\n          const buf = new ArrayBuffer(length);\n          const arr = new Uint8Array(buf);\n          let i = -1;\n          while (++i < length) {\n            arr[i] = binary.charCodeAt(i);\n          }\n          return buf;\n        }\n        function b64toBlob(dataURI) {\n          /**\n           * eg1: dataURI: data:text/plain;base64,abcd... => type: data:text/plain, content: abcd...\n           * eg2: dataURI: data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8;base64,abcd...\n           * => type: data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8, content: abcd...\n           */\n          const index = dataURI.indexOf(';base64,');\n          const fileType = dataURI.slice(0, index).split(':')[1];\n          const content = dataURI.slice(index).split(',')[1];\n          return new Blob([binaryStringToArrayBuffer(atob(content))], {\n            type: fileType\n          });\n        }\n        const {\n          b64Content,\n          type: saveType,\n          filename,\n          jobId,\n          filePrefix,\n          projectId,\n          recordId,\n          toolFileType\n        } = params;\n        const formData = new FormData();\n        let dataUrl;\n        if ((b64Content === null || b64Content === void 0 ? void 0 : b64Content.startsWith('data:')) && b64Content.includes(';base64,')) {\n          dataUrl = b64Content;\n        } else {\n          dataUrl = `data:${saveType};base64,${b64Content}`;\n        }\n        const blob = b64toBlob(dataUrl);\n        formData.append('file', blob, filename);\n        formData.append('jobId', jobId);\n        return fetch(`/devapi/project/v3/job/resource/tool-upload?filePrefix=${filePrefix}&projectId=${projectId}&recordId=${recordId}&toolFileType=${toolFileType}`, {\n          method: 'POST',\n          body: formData\n        }).then(res => res.json()).then(res => {\n          if (res === null || res === void 0 ? void 0 : res.data) {\n            return res.data;\n          }\n          throw new Error('save error');\n        });\n      };\n      loadContent.current = async (fileName, fileFolder) => fetch(`/devapi/project/v3/job/resource/download?fileName=${fileName}&jobId=${fileFolder}`).then(async res => {\n        let result;\n        try {\n          result = await res.json();\n        } catch (error) {\n          console.log('load content error', error);\n        }\n        return result;\n      }).then(res => {\n        var _res$data;\n        const data = res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.data;\n        if (typeof data === 'string') {\n          return data;\n        }\n        if (typeof data === 'object' && (data === null || data === void 0 ? void 0 : data.existed)) {\n          return data.data;\n        }\n        throw new Error('failed to load content');\n      });\n\n      // get sample payload\n      initJobProxy(samplePayload);\n      setPayload(samplePayload);\n    }\n    return () => {\n      window.removeEventListener('keydown', initShortcutsEvent);\n    };\n  }, [type, mode]);\n\n  // short\n  const initShortcutsEvent = e => {\n    if (e.shiftKey && e.ctrlKey && jobProxy.current) {\n      let name;\n      let key;\n      const {\n        toolMode\n      } = jobProxy.current;\n      if (Object.values(SubmitChannelPayload).indexOf(e.key) >= 0) {\n        key = e.key;\n      }\n      if (isLabel(toolMode)) {\n        name = SubmitChannel.Label;\n      } else if (isQA(toolMode)) {\n        name = SubmitChannel.Qa;\n      } else if (isAudit(toolMode)) {\n        name = SubmitChannel.Audit;\n      }\n      ;\n      if (name && key) {\n        e.preventDefault();\n        onShortcutsClick.current(name, key);\n      }\n    }\n  };\n  const initJobProxy = p => {\n    var _p$flowData, _p$flowData2, _p$flowData3, _p$flowData4, _p$flowData5, _p$flowData6;\n    const {\n      flowData\n    } = p;\n    jobProxy.current = new JobProxy({\n      locale: p.locale,\n      toolName: type,\n      toolMode: p.tool_mode || p.mode,\n      projectId: p.project_id || ((_p$flowData = p.flowData) === null || _p$flowData === void 0 ? void 0 : _p$flowData.PROJECT_ID),\n      flowId: p.flow_id,\n      jobId: p.job_id || ((_p$flowData2 = p.flowData) === null || _p$flowData2 === void 0 ? void 0 : _p$flowData2.JOB_ID),\n      taskId: p.task_id || ((_p$flowData3 = p.flowData) === null || _p$flowData3 === void 0 ? void 0 : _p$flowData3.TASK_ID),\n      recordId: p.record_id || ((_p$flowData4 = p.flowData) === null || _p$flowData4 === void 0 ? void 0 : _p$flowData4.RECORD_ID),\n      workerId: p.worker_id || ((_p$flowData5 = p.flowData) === null || _p$flowData5 === void 0 ? void 0 : _p$flowData5.WORKER_ID),\n      workerName: (_p$flowData6 = p.flowData) === null || _p$flowData6 === void 0 ? void 0 : _p$flowData6.WORKER_NAME,\n      reviewUrl: p._reviews,\n      reviewFrom: p.review_from,\n      flowData: p.flowData,\n      templateConfig: p,\n      scriptCheckTimeout: p.script_check_timeout,\n      auditId: flowData === null || flowData === void 0 ? void 0 : flowData.AUDIT_ID,\n      auditCycle: flowData === null || flowData === void 0 ? void 0 : flowData.CYCLE,\n      businessType: flowData === null || flowData === void 0 ? void 0 : flowData.BUSINESS_TYPE,\n      saveContent: saveContent.current,\n      loadContent: loadContent.current,\n      validateContent: validateContent.current,\n      trackingStats: trackingStats.current\n    });\n  };\n  const initTrack = p => {\n    const toolMode = p.tool_mode || p.mode;\n    if (toolMode && !isPreview(toolMode) && !isTemplatePreview(toolMode)) {\n      var _p$flowData7;\n      tracker.init({\n        locale: getLocale(p.locale),\n        toolName: type,\n        toolMode,\n        projectId: p.project_id || ((_p$flowData7 = p.flowData) === null || _p$flowData7 === void 0 ? void 0 : _p$flowData7.PROJECT_ID),\n        flowId: p.flow_id,\n        jobId: p.job_id,\n        taskId: p.task_id,\n        recordId: p.record_id,\n        auditId: `${p.job_id}.${p.record_id}.audit`\n      });\n    }\n  };\n  return payload && /*#__PURE__*/React.createElement(WrappedComponent, Object.assign({\n    ref: tool,\n    saveContent: saveContent.current,\n    loadContent: loadContent.current,\n    renderComplete: renderComplete.current,\n    jobProxy: jobProxy.current\n  }, payload, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 5\n    }\n  }));\n};\nexport default withConnect;","map":{"version":3,"names":["React","useState","useEffect","useRef","connectToParent","useActivityDispatcher","checkRunningMode","fetchResultByUrl","getLocale","RunningMode","SubmitChannel","SubmitChannelPayload","isLabel","isQA","isPreview","isTemplatePreview","isAudit","JobProxy","tracker","advanceJob","AdvanceMessage","isCallableFunc","func","toString","call","withConnect","type","methods","samplePayload","WrappedComponent","tool","mode","payload","setPayload","saveContent","loadContent","renderComplete","onShortcutsClick","validateContent","trackingStats","jobProxy","window","T","reloadResultByUrl","url","result","emit","UPDATE_RESULT","e","console","log","IFRAME","connection","onSubmit","args","current","values","JSON","stringify","cleanData","isModified","getStatistics","undefined","getReviews","submitReviews","updateResource","data","Promise","resolve","reject","promise","then","parent","saveNewContent","b64Content","filename","filePrefix","jobId","projectId","recordId","toolFileType","flowId","businessType","catch","startInterval","content","flowData","timeout","parse","res","statsPayload","getPayload","p","initTrack","initJobProxy","addEventListener","initShortcutsEvent","STANDALONE","params","binaryStringToArrayBuffer","binary","length","buf","ArrayBuffer","arr","Uint8Array","i","charCodeAt","b64toBlob","dataURI","index","indexOf","fileType","slice","split","Blob","atob","saveType","formData","FormData","dataUrl","startsWith","includes","blob","append","fetch","method","body","json","Error","fileName","fileFolder","error","_res$data","existed","removeEventListener","shiftKey","ctrlKey","name","key","toolMode","Object","Label","Qa","Audit","preventDefault","_p$flowData","_p$flowData2","_p$flowData3","_p$flowData4","_p$flowData5","_p$flowData6","locale","toolName","tool_mode","project_id","PROJECT_ID","flow_id","job_id","JOB_ID","taskId","task_id","TASK_ID","record_id","RECORD_ID","workerId","worker_id","WORKER_ID","workerName","WORKER_NAME","reviewUrl","_reviews","reviewFrom","review_from","templateConfig","scriptCheckTimeout","script_check_timeout","auditId","AUDIT_ID","auditCycle","CYCLE","BUSINESS_TYPE","_p$flowData7","init","createElement","assign","ref","__self","__source","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/withConnect.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any, no-plusplus */\nimport React, { useState, useEffect, useRef } from 'react';\nimport { connectToParent } from 'penpal';\nimport { useActivityDispatcher } from 'use-activity-dispatcher';\nimport { checkRunningMode, fetchResultByUrl, getLocale } from '../utils';\nimport { AnnotationType, RunningMode, SubmitChannel, SubmitChannelPayload } from '../types';\nimport { ToolMode, isLabel, isQA, isPreview, isTemplatePreview, isAudit } from '../utils/tool-mode';\nimport JobProxy, { SaveContentParams } from '../libs/JobProxy';\nimport tracker from '../utils/tracker';\nimport advanceJob, { AdvanceMessage } from '../libs/advanceJob';\n\ndeclare global {\n  interface Window {\n    T: {\n      reloadResultByUrl: (url: string) => Promise<void>;\n    },\n    pdfjsLib: any;\n    pdfjsViewer: any;\n  }\n\n  interface Array<T> {\n    findLastIndex(\n      predicate: (value: T, index: number, obj: T[]) => unknown,\n      thisArg?: any\n    ): number\n  }\n}\n\ninterface ConnectProps {\n  type: AnnotationType; // annotation tool type\n  methods?: { // methods connected to the iframe and tool function names map\n    [name: string]: string;\n  },\n  samplePayload: any; // sample payload to render each tool when not running in an iframe\n};\n\ninterface Payload {\n  locale?: string;\n  tool_mode?: string;\n  mode?: string; // some tool, it pass tool_mode, others mode\n  project_id?: string;\n  flow_id?: string;\n  job_id?: string;\n  task_id?: string;\n  record_id?: string;\n  worker_id?: string;\n  _reviews?: string;\n  review_from?: any;\n  flowData?: any;\n  script_check_timeout?: string;\n}\n\nconst isCallableFunc = (func: unknown) => func && (\n  {}.toString.call(func) === '[object Function]' ||\n  {}.toString.call(func) === '[object AsyncFunction]'\n);\n\nconst withConnect = ({ type, methods = {}, samplePayload }: ConnectProps) => (WrappedComponent: any) => () => {\n  useActivityDispatcher();\n  const tool = useRef<any>();\n  const mode = checkRunningMode();\n  const [payload, setPayload] = useState<Payload | null>(null);\n  // functions that parent provides\n  const saveContent = useRef<any>(() => {});\n  const loadContent = useRef<any>(() => {});\n  const renderComplete = useRef<any>(() => {});\n  const onShortcutsClick = useRef<any>(() => {});\n  const validateContent = useRef<any>(() => {});\n  const trackingStats = useRef<any>(() => {});\n  // job proxy\n  const jobProxy = useRef<JobProxy>();\n\n  useEffect(() => {\n    window.T = {\n      reloadResultByUrl: async (url: string) => {\n        try {\n          const result = await fetchResultByUrl(url);\n          advanceJob.emit(AdvanceMessage.UPDATE_RESULT, { result });\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.log('Reload result error:', e);\n        }\n      },\n    };\n  }, []);\n\n  useEffect(() => {\n    if (mode === RunningMode.IFRAME) {\n      // set up iframe connection when the app is running in an iframe\n      const connection = connectToParent({\n        methods: {\n          onSubmit: async (...args: any) => {\n            const func = methods.onSubmit || 'onSubmit';\n            if (isCallableFunc(tool.current[func])) {\n              const values = await tool.current[func](...args);\n              // make sure onSubmit returns a string\n              // consume this value in each tool itself or its custom tag in mashup\n              return typeof values === 'string' ? values : JSON.stringify(values);\n            }\n            return '';\n          },\n          cleanData: () => {\n            const func = methods.cleanData || 'cleanData';\n            if (isCallableFunc(tool.current[func])) {\n              tool.current[func]();\n            }\n          },\n          isModified: () => {\n            const func = methods.isModified || 'isModified';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            // return null if this method not provided\n            return null;\n          },\n          getStatistics: () => {\n            const func = methods.getStatistics || 'getStatistics';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            return undefined;\n          },\n          getReviews: () => {\n            // eslint-disable-next-line no-console\n            console.log('in get reviews');\n            const func = methods.getReviews || 'getReviews';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            return undefined;\n          },\n          submitReviews: () => {\n            // eslint-disable-next-line no-console\n            console.log('in submit reviews');\n            const func = methods.submitReviews || 'submitReviews';\n            if (isCallableFunc(tool.current[func])) {\n              return tool.current[func]();\n            }\n            return undefined;\n          },\n          updateResource: (data: unknown) => {\n            const func = methods.updateResource || 'updateResource';\n            if (isCallableFunc(tool.current[func])) {\n              tool.current[func](data);\n            }\n          },\n        },\n      });\n\n      saveContent.current = (args: SaveContentParams) => new Promise((resolve, reject) => {\n        connection.promise\n          .then((parent: any) => (\n            parent.saveNewContent ?\n              parent.saveNewContent(args) :\n              parent.saveContent(\n                args.b64Content,\n                args.type,\n                args.filename,\n                args.filePrefix,\n                args.jobId,\n                args.projectId,\n                args.recordId,\n                args.toolFileType,\n                args.flowId,\n                args.businessType,\n              )\n          ))\n          .then((url: string) => {\n            resolve(url);\n          })\n          .catch((e: any) => {\n            reject(e);\n          });\n      });\n\n      loadContent.current = (...args: any) => new Promise((resolve, reject) => {\n        connection.promise\n          .then((parent: any) => parent.loadContent(...args))\n          .then((data: any) => {\n            resolve(data);\n          })\n          .catch((e: any) => {\n            reject(e);\n          });\n      });\n\n      renderComplete.current = () => {\n        advanceJob.startInterval();\n        connection.promise.then((parent: any) => parent.renderComplete());\n      };\n\n      validateContent.current = (content: string, flowData: any, timeout?: number) => new Promise((resolve, reject) => {\n        connection.promise\n          .then((parent: any) => parent.validateContent(JSON.stringify({\n            content,\n            flowData: JSON.parse(flowData || '{}')\n          }), timeout))\n          .then((res: any) => {\n            resolve(res);\n          })\n          .catch((e: any) => {\n            reject(e);\n          });\n      });\n\n      trackingStats.current = (statsPayload: unknown) => new Promise<void>((resolve, reject) => {\n        connection.promise\n          .then(async (parent: any) => {\n            if (isCallableFunc(parent.trackingStats)) {\n              await parent.trackingStats(statsPayload);\n            }\n            resolve();\n          })\n          .catch((e: any) => {\n            reject(e);\n          });\n      });\n\n      // get payload from parent\n      connection.promise\n        .then((parent: any) => parent.getPayload())\n        .then((p: any) => {\n          initTrack(p);\n          initJobProxy(p);\n          setPayload(p);\n        });\n\n      onShortcutsClick.current = (...args: any) => connection.promise.then((parent: any) => parent.onShortcutsClick(...args));\n\n      window.addEventListener('keydown', initShortcutsEvent);\n    }\n\n    if (mode === RunningMode.STANDALONE) {\n      saveContent.current = async (params: SaveContentParams) => {\n        function binaryStringToArrayBuffer(binary: string) {\n          const length = binary.length;\n          const buf = new ArrayBuffer(length);\n          const arr = new Uint8Array(buf);\n          let i = -1;\n          while (++i < length) {\n            arr[i] = binary.charCodeAt(i);\n          }\n          return buf;\n        }\n\n        function b64toBlob(dataURI: string) {\n          /**\n           * eg1: dataURI: data:text/plain;base64,abcd... => type: data:text/plain, content: abcd...\n           * eg2: dataURI: data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8;base64,abcd...\n           * => type: data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8, content: abcd...\n           */\n          const index = dataURI.indexOf(';base64,');\n          const fileType = dataURI.slice(0, index).split(':')[1];\n          const content = dataURI.slice(index).split(',')[1];\n          return new Blob([binaryStringToArrayBuffer(atob(content))], {\n            type: fileType,\n          });\n        }\n        const { b64Content, type: saveType, filename, jobId, filePrefix, projectId, recordId, toolFileType } =\n          params;\n        const formData = new FormData();\n\n        let dataUrl;\n        if (b64Content?.startsWith('data:') && b64Content.includes(';base64,')) {\n          dataUrl = b64Content;\n        } else {\n          dataUrl = `data:${saveType};base64,${b64Content}`;\n        }\n\n        const blob = b64toBlob(dataUrl);\n        formData.append('file', blob, filename);\n        formData.append('jobId', jobId);\n\n        return fetch(\n          `/devapi/project/v3/job/resource/tool-upload?filePrefix=${filePrefix}&projectId=${projectId}&recordId=${recordId}&toolFileType=${toolFileType}`,\n          {\n            method: 'POST',\n            body: formData,\n          },\n        )\n          .then((res) => res.json())\n          .then((res) => {\n            if (res?.data) {\n              return res.data;\n            }\n            throw new Error('save error');\n          });\n      };\n\n      loadContent.current = async (fileName: string, fileFolder: string) => fetch(\n        `/devapi/project/v3/job/resource/download?fileName=${fileName}&jobId=${fileFolder}`,\n      )\n        .then(async (res) => {\n          let result;\n          try {\n            result = await res.json();\n          } catch (error) {\n            console.log('load content error', error);\n          }\n          return result;\n        })\n        .then((res) => {\n          const data = res?.data?.data;\n\n          if (typeof data === 'string') {\n            return data;\n          }\n\n          if (typeof data === 'object' && data?.existed) {\n            return data.data;\n          }\n\n          throw new Error('failed to load content');\n        });\n\n      // get sample payload\n      initJobProxy(samplePayload);\n      setPayload(samplePayload);\n    }\n\n    return () => {\n      window.removeEventListener('keydown', initShortcutsEvent);\n    };\n  }, [type, mode]);\n\n  // short\n  const initShortcutsEvent = (e: KeyboardEvent) => {\n    if (e.shiftKey && e.ctrlKey && jobProxy.current) {\n      let name: undefined | SubmitChannel;\n      let key: undefined | string;\n      const { toolMode } = jobProxy.current;\n      if (Object.values(SubmitChannelPayload).indexOf(e.key as any) >= 0) {\n        key = e.key;\n      }\n      if (isLabel(toolMode)) {\n        name = SubmitChannel.Label;\n      } else if (isQA(toolMode)) {\n        name = SubmitChannel.Qa;\n      } else if (isAudit(toolMode)) {\n        name = SubmitChannel.Audit;\n      };\n\n      if (name && key) {\n        e.preventDefault();\n        onShortcutsClick.current(name, key);\n      }\n    }\n  };\n\n  const initJobProxy = (p: Payload) => {\n    const { flowData } = p;\n    jobProxy.current = new JobProxy({\n      locale: p.locale,\n      toolName: type,\n      toolMode: p.tool_mode || p.mode,\n      projectId: p.project_id || p.flowData?.PROJECT_ID,\n      flowId: p.flow_id,\n      jobId: p.job_id || p.flowData?.JOB_ID,\n      taskId: p.task_id || p.flowData?.TASK_ID,\n      recordId: p.record_id || p.flowData?.RECORD_ID,\n      workerId: p.worker_id || p.flowData?.WORKER_ID,\n      workerName: p.flowData?.WORKER_NAME,\n      reviewUrl: p._reviews,\n      reviewFrom: p.review_from,\n      flowData: p.flowData,\n      templateConfig: p,\n      scriptCheckTimeout: p.script_check_timeout,\n      auditId: flowData?.AUDIT_ID,\n      auditCycle: flowData?.CYCLE,\n      businessType: flowData?.BUSINESS_TYPE,\n      saveContent: saveContent.current,\n      loadContent: loadContent.current,\n      validateContent: validateContent.current,\n      trackingStats: trackingStats.current,\n    });\n  };\n\n  const initTrack = (p: Payload) => {\n    const toolMode = (p.tool_mode || p.mode) as ToolMode;\n    if (toolMode && !isPreview(toolMode) && !isTemplatePreview(toolMode)) {\n      tracker.init({\n        locale: getLocale(p.locale),\n        toolName: type,\n        toolMode,\n        projectId: p.project_id || p.flowData?.PROJECT_ID,\n        flowId: p.flow_id,\n        jobId: p.job_id,\n        taskId: p.task_id,\n        recordId: p.record_id,\n        auditId: `${p.job_id}.${p.record_id}.audit`,\n      });\n    }\n  };\n\n  return payload && (\n    <WrappedComponent\n      ref={tool}\n      saveContent={saveContent.current}\n      loadContent={loadContent.current}\n      renderComplete={renderComplete.current}\n      jobProxy={jobProxy.current}\n      {...payload}\n    />\n  );\n};\n\nexport default withConnect;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}