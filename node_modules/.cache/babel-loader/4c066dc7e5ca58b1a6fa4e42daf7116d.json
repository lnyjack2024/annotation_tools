{"ast":null,"code":"import * as alawmulaw from 'alawmulaw';\nimport { parseAlawPcmToAudioData } from './pcm';\nimport { Language } from './constants';\nimport { RunningMode } from '../types';\nimport * as storage from './storage';\nexport const store = storage;\nexport function checkRunningMode() {\n  let inIframe = false;\n  try {\n    inIframe = window.self !== window.top;\n  } catch (e) {\n    inIframe = false;\n  }\n  return inIframe ? RunningMode.IFRAME : RunningMode.STANDALONE;\n}\nexport function getLocale(locale) {\n  const languages = Object.values(Language);\n  if (locale !== undefined) {\n    // get from provided string\n    if (languages.includes(locale)) {\n      return locale;\n    }\n  }\n  if (navigator.language) {\n    // get from browser\n    const language = languages.find(l => l.slice(0, 2) === navigator.language.slice(0, 2));\n    if (language) {\n      return language;\n    }\n  }\n  return Language.EN_US;\n}\nexport function fetchResultByUrl(url) {\n  return new Promise((resolve, reject) => {\n    fetch(url, {\n      cache: 'no-store'\n    }).then(res => {\n      if (res.ok) {\n        return res.json();\n      }\n      reject(new Error('http request error'));\n    }).then(data => resolve(data)).catch(e => reject(e));\n  });\n}\nexport function preloadImage(src, crossOrigin = '') {\n  const img = new Image();\n  img.crossOrigin = crossOrigin;\n  img.src = src;\n}\nexport function isAppenCloud() {\n  const {\n    hostname\n  } = window.location;\n  return hostname.endsWith('.appen.com.cn');\n}\nexport function getOrigin() {\n  const {\n    origin\n  } = window.location;\n  switch (origin) {\n    case 'https://tools-dev.appen.com.cn':\n    case 'http://tools.devk.appen.com.cn':\n      return 'https://request-proxy-dev.appen.com.cn';\n    case 'https://tools-stg.appen.com.cn':\n    case 'http://tools.stg.appen.com.cn':\n      return 'https://request-proxy-stg.appen.com.cn';\n    case 'https://tools.appen.com.cn':\n      return 'https://request-proxy.appen.com.cn';\n    default:\n  }\n  return '';\n}\nexport function getAPIGateway() {\n  const {\n    origin\n  } = window.location;\n  switch (origin) {\n    case 'https://tools-dev.appen.com.cn':\n      return 'https://ui-dev.appen.com.cn/api-gw';\n    case 'https://tools-stg.appen.com.cn':\n      return 'https://ui-stg.appen.com.cn/api-gw';\n    case 'https://tools.appen.com.cn':\n      return 'https://ui.appen.com.cn/api-gw';\n    default:\n  }\n  return '/api-gw';\n}\nexport function runScript(id, annotation, data) {\n  const origin = getOrigin();\n  return new Promise(resolve => {\n    fetch(`${origin}/ai/v2/script/invoke?id=${id}`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        annotation,\n        data\n      })\n    }).then(resp => {\n      if (resp.status !== 200) {\n        resolve({\n          error: `Failed to run script: ${id}`\n        });\n      }\n      return resp.json();\n    }).then(res => {\n      if (res.data && res.data.status === 'SUCCESS') {\n        try {\n          const parsedData = JSON.parse(res.data.result);\n          resolve(parsedData);\n        } catch (e) {\n          resolve({\n            error: `Failed to parse result for script: ${id}`\n          });\n        }\n      }\n      resolve({\n        error: `Failed to run script: ${id}`\n      });\n    }).catch(() => {\n      resolve({\n        error: `Failed to run script: ${id}`\n      });\n    });\n  });\n}\nexport const setStyle = (el, styles) => {\n  Object.keys(styles).forEach(prop => {\n    if (el.style[prop] !== styles[prop]) {\n      el.style[prop] = styles[prop];\n    }\n  });\n  return el;\n};\nexport function wordCount(words, wordCountItems) {\n  return getWords(words, wordCountItems).length;\n}\nexport function getWords(str, wordCountItems) {\n  const words = [];\n  let wordStart = 0;\n  if (typeof str !== 'string') return words;\n  let strLen = 0;\n  const regStr = wordCountItems && wordCountItems.length > 0 ? wordCountItems.map(i => `\\\\p{${i}}`).join('|') : '';\n  const reg = regStr ? new RegExp(regStr, 'u') : undefined;\n  for (let i = 0; i < str.length; i += 1) {\n    const c = str.charAt(i);\n    if (c.match(/[\\u2E80-\\u2FDF\\u3040-\\u318F\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FFF\\uA960-\\uA97F\\uAC00-\\uD7FF|\\u3002|\\uff1f|\\uff01|\\uff0c|\\u3001|\\uff1b|\\uff1a|\\u201c|\\u201d|\\u2018|\\u2019|\\uff08|\\uff09|\\u300a|\\u300b|\\u3008|\\u3009|\\u3010|\\u3011|\\u300e|\\u300f|\\u300c|\\u300d|\\ufe43|\\ufe44|\\u3014|\\u3015|\\u2026|\\u2014|\\uff5e|\\ufe4f|\\uffe5]/) || reg && c.match(reg)) {\n      if (strLen > 0) {\n        words.push(str.slice(wordStart, wordStart + strLen));\n      }\n      wordStart = i + 1;\n      strLen = 0;\n      words.push(c);\n    } else if (c && !c.match(/\\r|\\n|\\s|\\\\s/)) {\n      strLen += 1;\n    } else if (!c || c.match(/\\r|\\n|\\s|\\\\s/)) {\n      if (strLen > 0) {\n        words.push(str.slice(wordStart, wordStart + strLen));\n      }\n      strLen = 0;\n      wordStart = i + 1;\n    }\n  }\n  if (strLen > 0) {\n    words.push(str.slice(wordStart, wordStart + strLen));\n  }\n  return words;\n}\nexport const isInput = () => {\n  var _document$activeEleme;\n  return document.activeElement.tagName === 'INPUT' && (document.activeElement.type === 'text' || document.activeElement.type === 'number') || document.activeElement.tagName === 'TEXTAREA' || ((_document$activeEleme = document.activeElement) === null || _document$activeEleme === void 0 ? void 0 : _document$activeEleme.getAttribute('contenteditable')) === 'true';\n};\nexport const lawToWav = (buffer, format) => {\n  const alawOriginData = new Uint8Array(buffer);\n  const decodeAlaw = format === 'alaw' ? alawmulaw.alaw.decode(alawOriginData) : alawmulaw.mulaw.decode(alawOriginData);\n  const audioBuffer = parseAlawPcmToAudioData(decodeAlaw.buffer);\n  return audioBuffer;\n};\nexport function escapeRegExp(str) {\n  // eslint-disable-next-line no-useless-escape\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\nexport function isEasyformSelectDropdown(ele) {\n  if (ele) {\n    const easyformSelectDropdownList = Array.from(document.querySelectorAll('.easyform-select-dropdown'));\n    const findEasyFormParent = easyformSelectDropdownList && easyformSelectDropdownList.find(item => item.contains(ele));\n    return !!findEasyFormParent;\n  }\n  return false;\n}\n;\nexport function containsRTLLanguage(text = '') {\n  // https://en.wikipedia.org/wiki/Arabic_script_in_Unicode\n  return Array.from(text).some(c => {\n    const code = c.codePointAt(0);\n    return code !== undefined && (code >= 0x0600 && code <= 0x06ff || code >= 0x0750 && code <= 0x077f || code >= 0x08a0 && code <= 0x08ff || code >= 0xfb50 && code <= 0xfdff || code >= 0xfe70 && code <= 0xfeff || code >= 0x10e60 && code <= 0x10e7f || code >= 0x1ec70 && code <= 0x1ecbf || code >= 0x1ed00 && code <= 0x1ed4f || code >= 0x1ee00 && code <= 0x1eeff);\n  });\n}\nexport const copyTextToClipboard = async text => new Promise(async (resolve, reject) => {\n  try {\n    if (navigator.clipboard && window.isSecureContext) {\n      await navigator.clipboard.writeText(text);\n      resolve(true);\n    } else {\n      const input = document.createElement('textarea');\n      input.value = text;\n      document.body.appendChild(input);\n      input.select();\n      if (document.execCommand('copy')) {\n        document.execCommand('copy');\n        resolve(true);\n      } else {\n        reject();\n      }\n      input.blur();\n      document.body.removeChild(input);\n    }\n  } catch (error) {\n    reject(error);\n  }\n});\nexport function getFileExtension(url) {\n  var _split$pop;\n  return (_split$pop = url.split('?').shift().split('.').pop()) === null || _split$pop === void 0 ? void 0 : _split$pop.toLocaleLowerCase();\n}","map":{"version":3,"names":["alawmulaw","parseAlawPcmToAudioData","Language","RunningMode","storage","store","checkRunningMode","inIframe","window","self","top","e","IFRAME","STANDALONE","getLocale","locale","languages","Object","values","undefined","includes","navigator","language","find","l","slice","EN_US","fetchResultByUrl","url","Promise","resolve","reject","fetch","cache","then","res","ok","json","Error","data","catch","preloadImage","src","crossOrigin","img","Image","isAppenCloud","hostname","location","endsWith","getOrigin","origin","getAPIGateway","runScript","id","annotation","method","credentials","headers","body","JSON","stringify","resp","status","error","parsedData","parse","result","setStyle","el","styles","keys","forEach","prop","style","wordCount","words","wordCountItems","getWords","length","str","wordStart","strLen","regStr","map","i","join","reg","RegExp","c","charAt","match","push","isInput","_document$activeEleme","document","activeElement","tagName","type","getAttribute","lawToWav","buffer","format","alawOriginData","Uint8Array","decodeAlaw","alaw","decode","mulaw","audioBuffer","escapeRegExp","replace","isEasyformSelectDropdown","ele","easyformSelectDropdownList","Array","from","querySelectorAll","findEasyFormParent","item","contains","containsRTLLanguage","text","some","code","codePointAt","copyTextToClipboard","clipboard","isSecureContext","writeText","input","createElement","value","appendChild","select","execCommand","blur","removeChild","getFileExtension","_split$pop","split","shift","pop","toLocaleLowerCase"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/utils/index.ts"],"sourcesContent":["import * as alawmulaw from 'alawmulaw';\nimport { parseAlawPcmToAudioData } from './pcm';\nimport { Language } from './constants';\nimport { RunningMode } from '../types';\nimport * as storage from './storage';\n\nexport const store = storage;\nexport function checkRunningMode() {\n  let inIframe = false;\n  try {\n    inIframe = window.self !== window.top;\n  } catch (e) {\n    inIframe = false;\n  }\n  return inIframe ? RunningMode.IFRAME : RunningMode.STANDALONE;\n}\n\nexport function getLocale(locale?: string): Language {\n  const languages = Object.values(Language);\n  if (locale !== undefined) {\n    // get from provided string\n    if (languages.includes(locale as Language)) {\n      return locale as Language;\n    }\n  }\n  if (navigator.language) {\n    // get from browser\n    const language = languages.find((l) => l.slice(0, 2) === navigator.language.slice(0, 2));\n    if (language) {\n      return language;\n    }\n  }\n  return Language.EN_US;\n}\n\nexport function fetchResultByUrl(url: string) {\n  return new Promise((resolve, reject) => {\n    fetch(url, {\n      cache: 'no-store',\n    })\n      .then((res) => {\n        if (res.ok) {\n          return res.json();\n        }\n        reject(new Error('http request error'));\n      })\n      .then((data) => resolve(data))\n      .catch((e) => reject(e));\n  });\n}\n\nexport function preloadImage(src: string, crossOrigin = '') {\n  const img = new Image();\n  img.crossOrigin = crossOrigin;\n  img.src = src;\n}\n\nexport function isAppenCloud() {\n  const { hostname } = window.location;\n  return hostname.endsWith('.appen.com.cn');\n}\n\nexport function getOrigin() {\n  const { origin } = window.location;\n  switch (origin) {\n    case 'https://tools-dev.appen.com.cn':\n    case 'http://tools.devk.appen.com.cn':\n      return 'https://request-proxy-dev.appen.com.cn';\n    case 'https://tools-stg.appen.com.cn':\n    case 'http://tools.stg.appen.com.cn':\n      return 'https://request-proxy-stg.appen.com.cn';\n    case 'https://tools.appen.com.cn':\n      return 'https://request-proxy.appen.com.cn';\n    default:\n  }\n  return '';\n}\n\nexport function getAPIGateway() {\n  const { origin } = window.location;\n  switch (origin) {\n    case 'https://tools-dev.appen.com.cn':\n      return 'https://ui-dev.appen.com.cn/api-gw';\n    case 'https://tools-stg.appen.com.cn':\n      return 'https://ui-stg.appen.com.cn/api-gw';\n    case 'https://tools.appen.com.cn':\n      return 'https://ui.appen.com.cn/api-gw';\n    default:\n  }\n  return '/api-gw';\n}\n\nexport function runScript(id: string, annotation: string, data?: string) {\n  const origin = getOrigin();\n  return new Promise((resolve) => {\n    fetch(`${origin}/ai/v2/script/invoke?id=${id}`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'content-type': 'application/json',\n      },\n      body: JSON.stringify({\n        annotation,\n        data,\n      }),\n    }).then((resp) => {\n      if (resp.status !== 200) {\n        resolve({ error: `Failed to run script: ${id}` });\n      }\n      return resp.json();\n    }).then((res) => {\n      if (res.data && res.data.status === 'SUCCESS') {\n        try {\n          const parsedData = JSON.parse(res.data.result);\n          resolve(parsedData);\n        } catch (e) {\n          resolve({ error: `Failed to parse result for script: ${id}` });\n        }\n      }\n      resolve({ error: `Failed to run script: ${id}` });\n    }).catch(() => {\n      resolve({ error: `Failed to run script: ${id}` });\n    });\n  });\n}\n\nexport const setStyle = (el: HTMLElement, styles: { [key: string]: any }) => {\n  Object.keys(styles).forEach((prop) => {\n    if ((el.style as any)[prop] !== styles[prop]) {\n      (el.style as any)[prop] = styles[prop];\n    }\n  });\n  return el;\n};\n\nexport function wordCount(words?: string, wordCountItems?: string[]) {\n  return getWords(words, wordCountItems).length;\n}\n\nexport function getWords(str?: string, wordCountItems?: string[]) {\n  const words: string[] = [];\n  let wordStart = 0;\n  if (typeof str !== 'string') return words;\n  let strLen = 0;\n  const regStr = (wordCountItems && wordCountItems.length > 0) ? wordCountItems.map((i) => `\\\\p{${i}}`).join('|') : '';\n  const reg = regStr ? new RegExp(regStr, 'u') : undefined;\n  for (let i = 0; i < str.length; i += 1) {\n    const c = str.charAt(i);\n    if (\n      c.match(/[\\u2E80-\\u2FDF\\u3040-\\u318F\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FFF\\uA960-\\uA97F\\uAC00-\\uD7FF|\\u3002|\\uff1f|\\uff01|\\uff0c|\\u3001|\\uff1b|\\uff1a|\\u201c|\\u201d|\\u2018|\\u2019|\\uff08|\\uff09|\\u300a|\\u300b|\\u3008|\\u3009|\\u3010|\\u3011|\\u300e|\\u300f|\\u300c|\\u300d|\\ufe43|\\ufe44|\\u3014|\\u3015|\\u2026|\\u2014|\\uff5e|\\ufe4f|\\uffe5]/)\n      || (reg && c.match(reg))\n    ) {\n      if (strLen > 0) {\n        words.push(str.slice(wordStart, wordStart + strLen));\n      }\n      wordStart = i + 1;\n      strLen = 0;\n      words.push(c);\n    } else if (c && !c.match(/\\r|\\n|\\s|\\\\s/)) {\n      strLen += 1;\n    } else if (!c || c.match(/\\r|\\n|\\s|\\\\s/)) {\n      if (strLen > 0) {\n        words.push(str.slice(wordStart, wordStart + strLen));\n      }\n      strLen = 0;\n      wordStart = i + 1;\n    }\n  }\n  if (strLen > 0) {\n    words.push(str.slice(wordStart, wordStart + strLen));\n  }\n  return words;\n}\n\nexport const isInput = () => (document.activeElement as HTMLFormElement).tagName === 'INPUT' &&\n  ((document.activeElement as HTMLFormElement).type === 'text' || (document.activeElement as HTMLFormElement).type === 'number') ||\n  (document.activeElement as HTMLFormElement).tagName === 'TEXTAREA' || document.activeElement?.getAttribute('contenteditable') === 'true';\n\nexport const lawToWav = (buffer: ArrayBuffer, format: 'alaw' | 'ulaw') => {\n  const alawOriginData = new Uint8Array(buffer);\n  const decodeAlaw = format === 'alaw' ?\n    alawmulaw.alaw.decode(alawOriginData) :\n    alawmulaw.mulaw.decode(alawOriginData);\n  const audioBuffer = parseAlawPcmToAudioData(decodeAlaw.buffer);\n  return audioBuffer;\n};\n\nexport function escapeRegExp(str: string) {\n  // eslint-disable-next-line no-useless-escape\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\n\nexport function isEasyformSelectDropdown(ele: HTMLElement) {\n  if (ele) {\n    const easyformSelectDropdownList = Array.from(document.querySelectorAll('.easyform-select-dropdown'));\n    const findEasyFormParent =\n      easyformSelectDropdownList && easyformSelectDropdownList.find((item: Element) => item.contains(ele));\n    return !!findEasyFormParent;\n  }\n  return false;\n};\n\nexport function containsRTLLanguage(text = '') {\n  // https://en.wikipedia.org/wiki/Arabic_script_in_Unicode\n  return Array.from(text).some((c) => {\n    const code = c.codePointAt(0);\n    return code !== undefined && (\n      (code >= 0x0600 && code <= 0x06ff) ||\n      (code >= 0x0750 && code <= 0x077f) ||\n      (code >= 0x08a0 && code <= 0x08ff) ||\n      (code >= 0xfb50 && code <= 0xfdff) ||\n      (code >= 0xfe70 && code <= 0xfeff) ||\n      (code >= 0x10e60 && code <= 0x10e7f) ||\n      (code >= 0x1ec70 && code <= 0x1ecbf) ||\n      (code >= 0x1ed00 && code <= 0x1ed4f) ||\n      (code >= 0x1ee00 && code <= 0x1eeff)\n    );\n  });\n}\n\nexport const copyTextToClipboard = async (text: string) => new Promise(async (resolve, reject) => {\n  try {\n    if (navigator.clipboard && window.isSecureContext) {\n      await navigator.clipboard.writeText(text);\n      resolve(true);\n    } else {\n      const input = document.createElement('textarea');\n      input.value = text;\n      document.body.appendChild(input);\n      input.select();\n      if (document.execCommand('copy')) {\n        document.execCommand('copy');\n        resolve(true);\n      } else {\n        reject();\n      }\n      input.blur();\n      document.body.removeChild(input);\n    }\n  } catch (error) {\n    reject(error);\n  }\n});\n\nexport function getFileExtension(url: string) {\n  return url.split('?').shift()!.split('.').pop()?.toLocaleLowerCase();\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}