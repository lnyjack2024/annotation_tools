{"ast":null,"code":"import _applyDecoratedDescriptor from \"/Users/qzheng/Documents/webroot/annotation_tools/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nvar _class;\nimport { observable, computed, action, makeObservable } from 'mobx';\nlet UndoStore = (_class = class UndoStore {\n  constructor(rootStore) {\n    this.rootStore = void 0;\n    this.savedStatus = [];\n    this.pointer = 0;\n    this.actionPointer = 0;\n    makeObservable(this, {\n      pointer: observable,\n      undo: action,\n      redo: action,\n      saveStatus: action\n    });\n    this.rootStore = rootStore;\n  }\n  get undoDisabled() {\n    return this.pointer <= 0;\n  }\n  get redoDisabled() {\n    return this.pointer >= this.savedStatus.length;\n  }\n  undo() {\n    if (this.pointer > 0) {\n      this.pointer -= 1;\n      this.actionPointer -= 1;\n      return this.savedStatus[this.pointer];\n    }\n    return null;\n  }\n  redo() {\n    if (this.pointer < this.savedStatus.length) {\n      this.pointer += 1;\n      this.actionPointer += 1;\n      return this.savedStatus[this.pointer - 1];\n    }\n    return null;\n  }\n  saveStatus(before, after) {\n    this.savedStatus = this.savedStatus.slice(0, this.pointer);\n    this.savedStatus.push({\n      before,\n      after\n    });\n    if (this.savedStatus.length > 30) {\n      this.savedStatus.shift();\n    } else {\n      this.pointer += 1;\n    }\n    this.actionPointer += 1;\n  }\n}, _applyDecoratedDescriptor(_class.prototype, \"undoDisabled\", [computed], Object.getOwnPropertyDescriptor(_class.prototype, \"undoDisabled\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"redoDisabled\", [computed], Object.getOwnPropertyDescriptor(_class.prototype, \"redoDisabled\"), _class.prototype), _class);\nexport default UndoStore;","map":{"version":3,"names":["observable","computed","action","makeObservable","UndoStore","_class","constructor","rootStore","savedStatus","pointer","actionPointer","undo","redo","saveStatus","undoDisabled","redoDisabled","length","before","after","slice","push","shift","_applyDecoratedDescriptor","prototype","Object","getOwnPropertyDescriptor"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/keypoint/store/UndoStore.ts"],"sourcesContent":["import { observable, computed, action, makeObservable } from 'mobx';\nimport { RootStoreType } from './RootStore';\nimport { UpdatedShape, CategoryPathShapeStatus, InstanceStatus, GroupStatus, Review } from '../types';\n\nexport interface StatusItem {\n  before: Status[];\n  after: Status[];\n}\n\nexport type Status =\n  { type: 'shape'; status: UpdatedShape; } |\n  { type: 'pointCategory-path-shape'; status: CategoryPathShapeStatus; } |\n  { type: 'instance'; status: InstanceStatus; } |\n  { type: 'group'; status: GroupStatus; } |\n  { type: 'reviews'; status: Review[]; };\n\nclass UndoStore {\n  rootStore: RootStoreType;\n\n  savedStatus: StatusItem[] = [];\n\n  pointer = 0;\n\n  actionPointer = 0;\n\n  constructor(rootStore: RootStoreType) {\n    makeObservable(this, {\n      pointer: observable,\n      undo: action,\n      redo: action,\n      saveStatus: action\n    });\n    this.rootStore = rootStore;\n  }\n\n  @computed get undoDisabled() {\n    return this.pointer <= 0;\n  }\n\n  @computed get redoDisabled() {\n    return this.pointer >= this.savedStatus.length;\n  }\n\n  undo() {\n    if (this.pointer > 0) {\n      this.pointer -= 1;\n      this.actionPointer -= 1;\n      return this.savedStatus[this.pointer];\n    }\n    return null;\n  }\n\n  redo() {\n    if (this.pointer < this.savedStatus.length) {\n      this.pointer += 1;\n      this.actionPointer += 1;\n      return this.savedStatus[this.pointer - 1];\n    }\n    return null;\n  }\n\n  saveStatus(before: Status[], after: Status[]) {\n    this.savedStatus = this.savedStatus.slice(0, this.pointer);\n    this.savedStatus.push({ before, after });\n    if (this.savedStatus.length > 30) {\n      this.savedStatus.shift();\n    } else {\n      this.pointer += 1;\n    }\n    this.actionPointer += 1;\n  }\n}\n\nexport default UndoStore;\n"],"mappings":";;AAAA,SAASA,UAAU,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,cAAc,QAAQ,MAAM;AAAC,IAgB9DC,SAAS,IAAAC,MAAA,GAAf,MAAMD,SAAS,CAAC;EASdE,WAAWA,CAACC,SAAwB,EAAE;IAAA,KARtCA,SAAS;IAAA,KAETC,WAAW,GAAiB,EAAE;IAAA,KAE9BC,OAAO,GAAG,CAAC;IAAA,KAEXC,aAAa,GAAG,CAAC;IAGfP,cAAc,CAAC,IAAI,EAAE;MACnBM,OAAO,EAAET,UAAU;MACnBW,IAAI,EAAET,MAAM;MACZU,IAAI,EAAEV,MAAM;MACZW,UAAU,EAAEX;IACd,CAAC,CAAC;IACF,IAAI,CAACK,SAAS,GAAGA,SAAS;EAC5B;EAEA,IAAcO,YAAYA,CAAA,EAAG;IAC3B,OAAO,IAAI,CAACL,OAAO,IAAI,CAAC;EAC1B;EAEA,IAAcM,YAAYA,CAAA,EAAG;IAC3B,OAAO,IAAI,CAACN,OAAO,IAAI,IAAI,CAACD,WAAW,CAACQ,MAAM;EAChD;EAEAL,IAAIA,CAAA,EAAG;IACL,IAAI,IAAI,CAACF,OAAO,GAAG,CAAC,EAAE;MACpB,IAAI,CAACA,OAAO,IAAI,CAAC;MACjB,IAAI,CAACC,aAAa,IAAI,CAAC;MACvB,OAAO,IAAI,CAACF,WAAW,CAAC,IAAI,CAACC,OAAO,CAAC;IACvC;IACA,OAAO,IAAI;EACb;EAEAG,IAAIA,CAAA,EAAG;IACL,IAAI,IAAI,CAACH,OAAO,GAAG,IAAI,CAACD,WAAW,CAACQ,MAAM,EAAE;MAC1C,IAAI,CAACP,OAAO,IAAI,CAAC;MACjB,IAAI,CAACC,aAAa,IAAI,CAAC;MACvB,OAAO,IAAI,CAACF,WAAW,CAAC,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC;IAC3C;IACA,OAAO,IAAI;EACb;EAEAI,UAAUA,CAACI,MAAgB,EAAEC,KAAe,EAAE;IAC5C,IAAI,CAACV,WAAW,GAAG,IAAI,CAACA,WAAW,CAACW,KAAK,CAAC,CAAC,EAAE,IAAI,CAACV,OAAO,CAAC;IAC1D,IAAI,CAACD,WAAW,CAACY,IAAI,CAAC;MAAEH,MAAM;MAAEC;IAAM,CAAC,CAAC;IACxC,IAAI,IAAI,CAACV,WAAW,CAACQ,MAAM,GAAG,EAAE,EAAE;MAChC,IAAI,CAACR,WAAW,CAACa,KAAK,CAAC,CAAC;IAC1B,CAAC,MAAM;MACL,IAAI,CAACZ,OAAO,IAAI,CAAC;IACnB;IACA,IAAI,CAACC,aAAa,IAAI,CAAC;EACzB;AACF,CAAC,EAAAY,yBAAA,CAAAjB,MAAA,CAAAkB,SAAA,mBApCEtB,QAAQ,GAAAuB,MAAA,CAAAC,wBAAA,CAAApB,MAAA,CAAAkB,SAAA,mBAAAlB,MAAA,CAAAkB,SAAA,GAAAD,yBAAA,CAAAjB,MAAA,CAAAkB,SAAA,mBAIRtB,QAAQ,GAAAuB,MAAA,CAAAC,wBAAA,CAAApB,MAAA,CAAAkB,SAAA,mBAAAlB,MAAA,CAAAkB,SAAA,GAAAlB,MAAA;AAkCX,eAAeD,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module"}