{"ast":null,"code":"import { EditorState, ContentState, getDefaultKeyBinding, RichUtils, CompositeDecorator, Editor, DefaultDraftBlockRenderMap } from 'draft-js';\nimport Immutable, { List, Map } from 'immutable';\nimport PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\n/**\n * Create an editor state with some text in it already\n */\nfunction createEditorStateWithText$1(text) {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  if (EditorState.createWithText) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return EditorState.createWithText(text);\n  }\n  return EditorState.createWithContent(ContentState.createFromText(text));\n}\n\n// This code originally has been copied from Recompose\n// https://github.com/acdlite/recompose/blob/master/src/packages/recompose/compose.js\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction composeDecorators$1() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n  var last = funcs[funcs.length - 1];\n  return function () {\n    var result = last.apply(void 0, arguments);\n    for (var i = funcs.length - 2; i >= 0; i -= 1) {\n      var f = funcs[i];\n      result = f(result);\n    }\n    return result;\n  };\n}\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nfunction keyBindingFn(event) {\n  return getDefaultKeyBinding(event);\n}\nfunction handleKeyCommand(command, editorState, eventTimeStamp, _ref) {\n  var setEditorState = _ref.setEditorState;\n  var newState;\n  switch (command) {\n    case 'backspace':\n    case 'backspace-word':\n    case 'backspace-to-start-of-line':\n      newState = RichUtils.onBackspace(editorState);\n      break;\n    case 'delete':\n    case 'delete-word':\n    case 'delete-to-end-of-block':\n      newState = RichUtils.onDelete(editorState);\n      break;\n    default:\n      return 'not-handled';\n  }\n  if (newState != null) {\n    setEditorState(newState);\n    return 'handled';\n  }\n  return 'not-handled';\n}\nvar _excluded$1 = [\"props\"],\n  _excluded2 = [\"props\"];\nfunction isEditorHandleKey(key) {\n  return key.startsWith('handle');\n}\nfunction isEditorEventKey(key) {\n  return key.startsWith('on');\n}\nfunction isEditorFnKey(key) {\n  return key.endsWith('Fn');\n}\nfunction blockRendererFnHook(plugins, pluginMethods) {\n  return function (block) {\n    var resultBlock = {\n      props: {}\n    };\n    plugins.forEach(function (plugin) {\n      if (typeof plugin.blockRendererFn !== 'function') {\n        return;\n      }\n      var result = plugin.blockRendererFn(block, pluginMethods);\n      if (result !== undefined && result !== null) {\n        var pluginProps = result.props,\n          pluginRest = _objectWithoutPropertiesLoose(result, _excluded$1); // eslint-disable-line no-use-before-define\n        var _resultBlock = resultBlock,\n          props = _resultBlock.props,\n          rest = _objectWithoutPropertiesLoose(_resultBlock, _excluded2); // eslint-disable-line no-use-before-define\n        resultBlock = _extends({}, rest, pluginRest, {\n          props: _extends({}, props, pluginProps)\n        });\n      }\n    });\n    return resultBlock.component ? resultBlock : false;\n  };\n}\nfunction blockStyleFnHook(plugins, pluginMethods) {\n  return function (block) {\n    var styles = [];\n    plugins.forEach(function (plugin) {\n      if (typeof plugin.blockStyleFn !== 'function') {\n        return;\n      }\n      var result = plugin.blockStyleFn(block, pluginMethods);\n      if (result !== undefined && result !== null) {\n        styles.push(result);\n      }\n    });\n    return styles.join(' ');\n  };\n}\nfunction customStyleFnHook(plugins, pluginMethods) {\n  return function (style, block) {\n    var result;\n    var wasHandled = plugins.some(function (plugin) {\n      if (typeof plugin.customStyleFn !== 'function') {\n        return false;\n      }\n      result = plugin.customStyleFn(style, block, pluginMethods);\n      return result !== undefined;\n    });\n    return wasHandled && result ? result : {};\n  };\n}\nfunction keyBindingFnHook(plugins, pluginMethods) {\n  return function (event) {\n    var result = null;\n    var wasHandled = plugins.some(function (plugin) {\n      if (typeof plugin.keyBindingFn !== 'function') {\n        return false;\n      }\n      result = plugin.keyBindingFn(event, pluginMethods);\n      return result !== undefined;\n    });\n    return wasHandled ? result : null;\n  };\n}\nfunction createHandleHooks(methodName, plugins, pluginMethods) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return plugins.some(function (plugin) {\n      var fn = plugin[methodName];\n      return (\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        typeof fn === 'function' && fn.apply(void 0, args.concat([pluginMethods])) === 'handled'\n      );\n    }) ? 'handled' : 'not-handled';\n  };\n}\nfunction createEventHooks(methodName, plugins, pluginMethods) {\n  return function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return plugins.some(function (plugin) {\n      var fn = plugin[methodName];\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return typeof fn === 'function' && fn.apply(void 0, args.concat([pluginMethods])) === true;\n    });\n  };\n}\nfunction createPluginHooks(plugins, pluginFunction) {\n  var pluginHooks = {};\n\n  //onchange is here ignored\n  var handledAttributes = new Set(['onChange']);\n  plugins.forEach(function (plugin) {\n    Object.keys(plugin).forEach(function (attrName) {\n      // if `attrName` has been added as a hook key already, ignore this one\n      if (handledAttributes.has(attrName)) {\n        return;\n      }\n      handledAttributes.add(attrName);\n      if (isEditorEventKey(attrName)) {\n        pluginHooks[attrName] = createEventHooks(attrName, plugins, pluginFunction);\n      } else if (isEditorHandleKey(attrName)) {\n        pluginHooks[attrName] = createHandleHooks(attrName, plugins, pluginFunction);\n      } else if (isEditorFnKey(attrName)) {\n        if (attrName === 'blockRendererFn') {\n          pluginHooks.blockRendererFn = blockRendererFnHook(plugins, pluginFunction);\n        } else if (attrName === 'blockStyleFn') {\n          pluginHooks.blockStyleFn = blockStyleFnHook(plugins, pluginFunction);\n        } else if (attrName === 'customStyleFn') {\n          pluginHooks.customStyleFn = customStyleFnHook(plugins, pluginFunction);\n        } else if (attrName === 'keyBindingFn') {\n          pluginHooks.keyBindingFn = keyBindingFnHook(plugins, pluginFunction);\n        }\n      }\n    });\n  });\n  return pluginHooks;\n}\nfunction createCompositeDecorator(decorators, getEditorState, setEditorState) {\n  var convertedDecorators = List(decorators).map(function (decorator) {\n    var Component = decorator.component;\n    var DecoratedComponent = function DecoratedComponent(props) {\n      return /*#__PURE__*/React.createElement(Component, _extends({}, props, {\n        getEditorState: getEditorState,\n        setEditorState: setEditorState\n      }));\n    };\n    return _extends({}, decorator, {\n      component: DecoratedComponent\n    });\n  }).toJS();\n  return new CompositeDecorator(convertedDecorators);\n}\nvar KEY_SEPARATOR = '-';\nvar MultiDecorator = /*#__PURE__*/function () {\n  function MultiDecorator(decorators) {\n    this.decorators = Immutable.List(decorators);\n  }\n\n  /**\n   * Return list of decoration IDs per character\n   */\n  var _proto = MultiDecorator.prototype;\n  _proto.getDecorations = function getDecorations(block, contentState) {\n    var decorations = new Array(block.getText().length).fill(null);\n    this.decorators.forEach(function (decorator, i) {\n      var subDecorations = decorator.getDecorations(block, contentState);\n      subDecorations.forEach(function (key, offset) {\n        if (!key) {\n          return;\n        }\n        decorations[offset] = i + KEY_SEPARATOR + key;\n      });\n    });\n    return Immutable.List(decorations);\n  }\n\n  /**\n   * Return component to render a decoration\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  ;\n  _proto.getComponentForKey = function getComponentForKey(key) {\n    var decorator = this.getDecoratorForKey(key);\n    return decorator.getComponentForKey(MultiDecorator.getInnerKey(key));\n  }\n\n  /**\n   * Return props to render a decoration\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  ;\n  _proto.getPropsForKey = function getPropsForKey(key) {\n    var decorator = this.getDecoratorForKey(key);\n    return decorator.getPropsForKey(MultiDecorator.getInnerKey(key));\n  }\n\n  /**\n   * Return a decorator for a specific key\n   */;\n  _proto.getDecoratorForKey = function getDecoratorForKey(key) {\n    var parts = key.split(KEY_SEPARATOR);\n    var index = Number(parts[0]);\n    return this.decorators.get(index);\n  }\n\n  /**\n   * Return inner key for a decorator\n   */;\n  MultiDecorator.getInnerKey = function getInnerKey(key) {\n    var parts = key.split(KEY_SEPARATOR);\n    return parts.slice(1).join(KEY_SEPARATOR);\n  };\n  return MultiDecorator;\n}();\n\n// Return true if decorator implements the DraftDecoratorType interface\n// @see https://github.com/facebook/draft-js/blob/master/src/model/decorators/DraftDecoratorType.js\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar decoratorIsCustom = function decoratorIsCustom(decorator) {\n  return typeof decorator.getDecorations === 'function' && typeof decorator.getComponentForKey === 'function' && typeof decorator.getPropsForKey === 'function';\n};\nvar getDecoratorsFromProps = function getDecoratorsFromProps(_ref) {\n  var decorators = _ref.decorators,\n    _ref$plugins = _ref.plugins,\n    plugins = _ref$plugins === void 0 ? [] : _ref$plugins;\n  return List([{\n    decorators: decorators\n  }].concat(plugins)).filter(function (plugin) {\n    return (plugin == null ? void 0 : plugin.decorators) !== undefined;\n  }).flatMap(function (plugin) {\n    return plugin == null ? void 0 : plugin.decorators;\n  });\n};\nfunction resolveDecorators(props, getEditorState, onChange) {\n  var decorators = getDecoratorsFromProps(props);\n  var compositeDecorator = createCompositeDecorator(decorators.filter(function (decorator) {\n    return !decoratorIsCustom(decorator);\n  }), getEditorState, onChange);\n  var customDecorators = decorators.filter(function (decorator) {\n    return decoratorIsCustom(decorator);\n  });\n  return new MultiDecorator(customDecorators.push(compositeDecorator));\n}\nvar _excluded = [\"keyBindingFn\"];\n\n// should be DraftDecoratorType but it is not accessible and does not habe decorators or _decorators\n\nvar getDecoratorLength = function getDecoratorLength(obj) {\n  if ((obj == null ? void 0 : obj.decorators) != null) {\n    var _obj$decorators;\n    return (_obj$decorators = obj.decorators) == null ? void 0 : _obj$decorators.size;\n  } else if ((obj == null ? void 0 : obj._decorators) != null) {\n    var _obj$_decorators;\n    return (_obj$_decorators = obj._decorators) == null ? void 0 : _obj$_decorators.length;\n  }\n  return undefined;\n};\n\n/**\n * The main editor component\n */\nvar PluginEditor = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(PluginEditor, _Component);\n  function PluginEditor(_props) {\n    var _this;\n    _this = _Component.call(this, _props) || this;\n    _this.editor = null;\n    _this.state = {\n      readOnly: false // TODO for Nik: ask ben why this is relevent\n    };\n    // Cycle through the plugins, changing the editor state with what the plugins\n    // changed (or didn't)\n    _this.onChange = function (editorState) {\n      var newEditorState = editorState;\n      _this.resolvePlugins().forEach(function (plugin) {\n        if (plugin.onChange) {\n          newEditorState = plugin.onChange(newEditorState, _this.getPluginMethods());\n        }\n      });\n      if (_this.props.onChange) {\n        _this.props.onChange(newEditorState);\n      }\n    };\n    _this.getPlugins = function () {\n      return [].concat(_this.props.plugins);\n    };\n    _this.getProps = function () {\n      return _extends({}, _this.props);\n    };\n    // TODO further down in render we use readOnly={this.props.readOnly || this.state.readOnly}. Ask Ben why readOnly is here just from the props? Why would plugins use this instead of just taking it from getProps?\n    _this.getReadOnly = function () {\n      return _this.props.readOnly || _this.state.readOnly;\n    };\n    _this.setReadOnly = function (readOnly) {\n      if (readOnly !== _this.state.readOnly) {\n        _this.setState({\n          readOnly: readOnly\n        });\n      }\n    };\n    //the editors editor html element is not supported in the draft js typescript interface\n    _this.getEditorRef = function () {\n      return _this.editor;\n    };\n    _this.getEditorState = function () {\n      return _this.props.editorState;\n    };\n    _this.getPluginMethods = function () {\n      return {\n        getPlugins: _this.getPlugins,\n        getProps: _this.getProps,\n        setEditorState: _this.onChange,\n        getEditorState: _this.getEditorState,\n        getReadOnly: _this.getReadOnly,\n        setReadOnly: _this.setReadOnly,\n        getEditorRef: _this.getEditorRef\n      };\n    };\n    _this.createPluginHooks = function () {\n      var plugins = [_this.props].concat(_this.resolvePlugins());\n      return createPluginHooks(plugins, _this.getPluginMethods());\n    };\n    _this.resolvePlugins = function () {\n      var plugins = _this.getPlugins();\n      if (_this.props.defaultKeyBindings === true) {\n        plugins.push({\n          keyBindingFn: keyBindingFn\n        });\n      }\n      if (_this.props.defaultKeyCommands === true) {\n        plugins.push({\n          handleKeyCommand: handleKeyCommand\n        });\n      }\n      return plugins;\n    };\n    _this.resolveCustomStyleMap = function () {\n      var customStyleMap = _this.props.plugins.filter(function (plug) {\n        return plug.customStyleMap !== undefined;\n      }).map(function (plug) {\n        return plug.customStyleMap;\n      });\n      return customStyleMap.concat([_this.props.customStyleMap]).reduce(function (styles, style) {\n        return _extends({}, styles, style);\n      }, {});\n    };\n    _this.resolveblockRenderMap = function () {\n      var blockRenderMap = _this.props.plugins.filter(function (plug) {\n        return plug.blockRenderMap !== undefined;\n      }).reduce(function (maps, plug) {\n        return maps.merge(plug.blockRenderMap);\n      }, Map({}));\n      if (_this.props.defaultBlockRenderMap) {\n        blockRenderMap = DefaultDraftBlockRenderMap.merge(blockRenderMap);\n      }\n      if (_this.props.blockRenderMap) {\n        blockRenderMap = blockRenderMap.merge(_this.props.blockRenderMap);\n      }\n      return blockRenderMap;\n    };\n    _this.resolveAccessibilityProps = function () {\n      var accessibilityProps = {};\n      _this.resolvePlugins().forEach(function (plugin) {\n        if (typeof plugin.getAccessibilityProps !== 'function') {\n          return;\n        }\n        var props = plugin.getAccessibilityProps();\n        var popupProps = {};\n        if (accessibilityProps.ariaHasPopup === undefined) {\n          popupProps.ariaHasPopup = props.ariaHasPopup;\n        } else if (props.ariaHasPopup === 'true') {\n          popupProps.ariaHasPopup = 'true';\n        }\n        if (accessibilityProps.ariaExpanded === undefined) {\n          popupProps.ariaExpanded = props.ariaExpanded;\n        } else if (props.ariaExpanded === true) {\n          popupProps.ariaExpanded = true;\n        }\n        accessibilityProps = _extends({}, accessibilityProps, props, popupProps);\n      });\n      return accessibilityProps;\n    };\n    var _plugins = [_this.props].concat(_this.resolvePlugins());\n    _plugins.forEach(function (plugin) {\n      if (plugin && typeof plugin.initialize === 'function') {\n        plugin.initialize(_this.getPluginMethods());\n      }\n    });\n    return _this;\n  }\n  var _proto = PluginEditor.prototype;\n  _proto.focus = function focus() {\n    if (this.editor) {\n      this.editor.focus();\n    }\n  };\n  _proto.blur = function blur() {\n    if (this.editor) {\n      this.editor.blur();\n    }\n  };\n  _proto.componentDidMount = function componentDidMount() {\n    var decorator = resolveDecorators(this.props, this.getEditorState, this.onChange);\n    var editorState = EditorState.set(this.props.editorState, {\n      decorator: decorator\n    });\n    this.onChange(EditorState.moveSelectionToEnd(editorState));\n  };\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var next = this.props;\n    var currDec = prevProps.editorState.getDecorator();\n    var nextDec = next.editorState.getDecorator();\n\n    // If there is not current decorator, there's nothing to carry over to the next editor state\n    if (!currDec) {\n      return;\n    }\n    // If the current decorator is the same as the new one, don't call onChange to avoid infinite loops\n    if (currDec === nextDec) {\n      return;\n    }\n    // If the old and the new decorator are the same, but no the same object, also don't call onChange to avoid infinite loops\n    if (currDec && nextDec && getDecoratorLength(currDec) === getDecoratorLength(nextDec)) {\n      return;\n    }\n    var editorState = EditorState.set(next.editorState, {\n      decorator: currDec\n    });\n    this.onChange(EditorState.moveSelectionToEnd(editorState));\n  };\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    var _this2 = this;\n    this.resolvePlugins().forEach(function (plugin) {\n      if (plugin.willUnmount) {\n        plugin.willUnmount({\n          getEditorState: _this2.getEditorState,\n          setEditorState: _this2.onChange\n        });\n      }\n    });\n  };\n  _proto.render = function render() {\n    var _this3 = this;\n    var pluginHooks = this.createPluginHooks();\n    var customStyleMap = this.resolveCustomStyleMap();\n    var accessibilityProps = this.resolveAccessibilityProps();\n    var blockRenderMap = this.resolveblockRenderMap();\n    var _this$props = this.props;\n    _this$props.keyBindingFn;\n    var editorProps = _objectWithoutPropertiesLoose(_this$props, _excluded);\n    return /*#__PURE__*/React.createElement(Editor, _extends({}, editorProps, accessibilityProps, pluginHooks, {\n      readOnly: this.props.readOnly || this.state.readOnly,\n      customStyleMap: customStyleMap,\n      blockRenderMap: blockRenderMap,\n      onChange: this.onChange,\n      editorState: this.props.editorState,\n      ref: function ref(element) {\n        _this3.editor = element;\n      }\n    }));\n  };\n  return PluginEditor;\n}(Component);\nPluginEditor.propTypes = {\n  editorState: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired,\n  plugins: PropTypes.array,\n  defaultKeyBindings: PropTypes.bool,\n  defaultKeyCommands: PropTypes.bool,\n  defaultBlockRenderMap: PropTypes.bool,\n  customStyleMap: PropTypes.object,\n  // eslint-disable-next-line react/no-unused-prop-types\n  decorators: PropTypes.array\n};\nPluginEditor.defaultProps = {\n  defaultBlockRenderMap: true,\n  defaultKeyBindings: true,\n  defaultKeyCommands: true,\n  customStyleMap: {},\n  plugins: [],\n  decorators: []\n};\nvar PluginEditor$1 = PluginEditor;\nvar createEditorStateWithText = createEditorStateWithText$1;\nvar composeDecorators = composeDecorators$1;\n\n//the editors editor html element is not supported in the draft js typescript interface\n\nexport { composeDecorators, createEditorStateWithText, PluginEditor$1 as default };","map":{"version":3,"names":["EditorState","ContentState","getDefaultKeyBinding","RichUtils","CompositeDecorator","Editor","DefaultDraftBlockRenderMap","Immutable","List","Map","PropTypes","React","Component","createEditorStateWithText$1","text","createWithText","createWithContent","createFromText","composeDecorators$1","_len","arguments","length","funcs","Array","_key","arg","last","result","apply","i","f","_extends","Object","assign","bind","target","source","key","prototype","hasOwnProperty","call","_inheritsLoose","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","keyBindingFn","event","handleKeyCommand","command","editorState","eventTimeStamp","_ref","setEditorState","newState","onBackspace","onDelete","_excluded$1","_excluded2","isEditorHandleKey","startsWith","isEditorEventKey","isEditorFnKey","endsWith","blockRendererFnHook","plugins","pluginMethods","block","resultBlock","props","forEach","plugin","blockRendererFn","undefined","pluginProps","pluginRest","_resultBlock","rest","component","blockStyleFnHook","styles","blockStyleFn","push","join","customStyleFnHook","style","wasHandled","some","customStyleFn","keyBindingFnHook","createHandleHooks","methodName","args","fn","concat","createEventHooks","_len2","_key2","createPluginHooks","pluginFunction","pluginHooks","handledAttributes","Set","attrName","has","add","createCompositeDecorator","decorators","getEditorState","convertedDecorators","map","decorator","DecoratedComponent","createElement","toJS","KEY_SEPARATOR","MultiDecorator","_proto","getDecorations","contentState","decorations","getText","fill","subDecorations","offset","getComponentForKey","getDecoratorForKey","getInnerKey","getPropsForKey","parts","split","index","Number","get","slice","decoratorIsCustom","getDecoratorsFromProps","_ref$plugins","filter","flatMap","resolveDecorators","onChange","compositeDecorator","customDecorators","_excluded","getDecoratorLength","obj","_obj$decorators","size","_decorators","_obj$_decorators","PluginEditor","_Component","_props","_this","editor","state","readOnly","newEditorState","resolvePlugins","getPluginMethods","getPlugins","getProps","getReadOnly","setReadOnly","setState","getEditorRef","defaultKeyBindings","defaultKeyCommands","resolveCustomStyleMap","customStyleMap","plug","reduce","resolveblockRenderMap","blockRenderMap","maps","merge","defaultBlockRenderMap","resolveAccessibilityProps","accessibilityProps","getAccessibilityProps","popupProps","ariaHasPopup","ariaExpanded","_plugins","initialize","focus","blur","componentDidMount","set","moveSelectionToEnd","componentDidUpdate","prevProps","next","currDec","getDecorator","nextDec","componentWillUnmount","_this2","willUnmount","render","_this3","_this$props","editorProps","ref","element","propTypes","object","isRequired","func","array","bool","defaultProps","PluginEditor$1","createEditorStateWithText","composeDecorators","default"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/node_modules/@draft-js-plugins/editor/lib/index.esm.js"],"sourcesContent":["import { EditorState, ContentState, getDefaultKeyBinding, RichUtils, CompositeDecorator, Editor, DefaultDraftBlockRenderMap } from 'draft-js';\nimport Immutable, { List, Map } from 'immutable';\nimport PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\n/**\n * Create an editor state with some text in it already\n */\nfunction createEditorStateWithText$1(text) {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  if (EditorState.createWithText) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return EditorState.createWithText(text);\n  }\n  return EditorState.createWithContent(ContentState.createFromText(text));\n}\n\n// This code originally has been copied from Recompose\n// https://github.com/acdlite/recompose/blob/master/src/packages/recompose/compose.js\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction composeDecorators$1() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n  var last = funcs[funcs.length - 1];\n  return function () {\n    var result = last.apply(void 0, arguments);\n    for (var i = funcs.length - 2; i >= 0; i -= 1) {\n      var f = funcs[i];\n      result = f(result);\n    }\n    return result;\n  };\n}\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\n\nfunction keyBindingFn(event) {\n  return getDefaultKeyBinding(event);\n}\n\nfunction handleKeyCommand(command, editorState, eventTimeStamp, _ref) {\n  var setEditorState = _ref.setEditorState;\n  var newState;\n  switch (command) {\n    case 'backspace':\n    case 'backspace-word':\n    case 'backspace-to-start-of-line':\n      newState = RichUtils.onBackspace(editorState);\n      break;\n    case 'delete':\n    case 'delete-word':\n    case 'delete-to-end-of-block':\n      newState = RichUtils.onDelete(editorState);\n      break;\n    default:\n      return 'not-handled';\n  }\n  if (newState != null) {\n    setEditorState(newState);\n    return 'handled';\n  }\n  return 'not-handled';\n}\n\nvar _excluded$1 = [\"props\"],\n  _excluded2 = [\"props\"];\nfunction isEditorHandleKey(key) {\n  return key.startsWith('handle');\n}\nfunction isEditorEventKey(key) {\n  return key.startsWith('on');\n}\nfunction isEditorFnKey(key) {\n  return key.endsWith('Fn');\n}\nfunction blockRendererFnHook(plugins, pluginMethods) {\n  return function (block) {\n    var resultBlock = {\n      props: {}\n    };\n    plugins.forEach(function (plugin) {\n      if (typeof plugin.blockRendererFn !== 'function') {\n        return;\n      }\n      var result = plugin.blockRendererFn(block, pluginMethods);\n      if (result !== undefined && result !== null) {\n        var pluginProps = result.props,\n          pluginRest = _objectWithoutPropertiesLoose(result, _excluded$1); // eslint-disable-line no-use-before-define\n        var _resultBlock = resultBlock,\n          props = _resultBlock.props,\n          rest = _objectWithoutPropertiesLoose(_resultBlock, _excluded2); // eslint-disable-line no-use-before-define\n        resultBlock = _extends({}, rest, pluginRest, {\n          props: _extends({}, props, pluginProps)\n        });\n      }\n    });\n    return resultBlock.component ? resultBlock : false;\n  };\n}\nfunction blockStyleFnHook(plugins, pluginMethods) {\n  return function (block) {\n    var styles = [];\n    plugins.forEach(function (plugin) {\n      if (typeof plugin.blockStyleFn !== 'function') {\n        return;\n      }\n      var result = plugin.blockStyleFn(block, pluginMethods);\n      if (result !== undefined && result !== null) {\n        styles.push(result);\n      }\n    });\n    return styles.join(' ');\n  };\n}\nfunction customStyleFnHook(plugins, pluginMethods) {\n  return function (style, block) {\n    var result;\n    var wasHandled = plugins.some(function (plugin) {\n      if (typeof plugin.customStyleFn !== 'function') {\n        return false;\n      }\n      result = plugin.customStyleFn(style, block, pluginMethods);\n      return result !== undefined;\n    });\n    return wasHandled && result ? result : {};\n  };\n}\nfunction keyBindingFnHook(plugins, pluginMethods) {\n  return function (event) {\n    var result = null;\n    var wasHandled = plugins.some(function (plugin) {\n      if (typeof plugin.keyBindingFn !== 'function') {\n        return false;\n      }\n      result = plugin.keyBindingFn(event, pluginMethods);\n      return result !== undefined;\n    });\n    return wasHandled ? result : null;\n  };\n}\nfunction createHandleHooks(methodName, plugins, pluginMethods) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return plugins.some(function (plugin) {\n      var fn = plugin[methodName];\n      return (\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        typeof fn === 'function' && fn.apply(void 0, args.concat([pluginMethods])) === 'handled'\n      );\n    }) ? 'handled' : 'not-handled';\n  };\n}\nfunction createEventHooks(methodName, plugins, pluginMethods) {\n  return function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return plugins.some(function (plugin) {\n      var fn = plugin[methodName];\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return typeof fn === 'function' && fn.apply(void 0, args.concat([pluginMethods])) === true;\n    });\n  };\n}\nfunction createPluginHooks(plugins, pluginFunction) {\n  var pluginHooks = {};\n\n  //onchange is here ignored\n  var handledAttributes = new Set(['onChange']);\n  plugins.forEach(function (plugin) {\n    Object.keys(plugin).forEach(function (attrName) {\n      // if `attrName` has been added as a hook key already, ignore this one\n      if (handledAttributes.has(attrName)) {\n        return;\n      }\n      handledAttributes.add(attrName);\n      if (isEditorEventKey(attrName)) {\n        pluginHooks[attrName] = createEventHooks(attrName, plugins, pluginFunction);\n      } else if (isEditorHandleKey(attrName)) {\n        pluginHooks[attrName] = createHandleHooks(attrName, plugins, pluginFunction);\n      } else if (isEditorFnKey(attrName)) {\n        if (attrName === 'blockRendererFn') {\n          pluginHooks.blockRendererFn = blockRendererFnHook(plugins, pluginFunction);\n        } else if (attrName === 'blockStyleFn') {\n          pluginHooks.blockStyleFn = blockStyleFnHook(plugins, pluginFunction);\n        } else if (attrName === 'customStyleFn') {\n          pluginHooks.customStyleFn = customStyleFnHook(plugins, pluginFunction);\n        } else if (attrName === 'keyBindingFn') {\n          pluginHooks.keyBindingFn = keyBindingFnHook(plugins, pluginFunction);\n        }\n      }\n    });\n  });\n  return pluginHooks;\n}\n\nfunction createCompositeDecorator(decorators, getEditorState, setEditorState) {\n  var convertedDecorators = List(decorators).map(function (decorator) {\n    var Component = decorator.component;\n    var DecoratedComponent = function DecoratedComponent(props) {\n      return /*#__PURE__*/React.createElement(Component, _extends({}, props, {\n        getEditorState: getEditorState,\n        setEditorState: setEditorState\n      }));\n    };\n    return _extends({}, decorator, {\n      component: DecoratedComponent\n    });\n  }).toJS();\n  return new CompositeDecorator(convertedDecorators);\n}\n\nvar KEY_SEPARATOR = '-';\nvar MultiDecorator = /*#__PURE__*/function () {\n  function MultiDecorator(decorators) {\n    this.decorators = Immutable.List(decorators);\n  }\n\n  /**\n   * Return list of decoration IDs per character\n   */\n  var _proto = MultiDecorator.prototype;\n  _proto.getDecorations = function getDecorations(block, contentState) {\n    var decorations = new Array(block.getText().length).fill(null);\n    this.decorators.forEach(function (decorator, i) {\n      var subDecorations = decorator.getDecorations(block, contentState);\n      subDecorations.forEach(function (key, offset) {\n        if (!key) {\n          return;\n        }\n        decorations[offset] = i + KEY_SEPARATOR + key;\n      });\n    });\n    return Immutable.List(decorations);\n  }\n\n  /**\n   * Return component to render a decoration\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  ;\n  _proto.getComponentForKey = function getComponentForKey(key) {\n    var decorator = this.getDecoratorForKey(key);\n    return decorator.getComponentForKey(MultiDecorator.getInnerKey(key));\n  }\n\n  /**\n   * Return props to render a decoration\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  ;\n  _proto.getPropsForKey = function getPropsForKey(key) {\n    var decorator = this.getDecoratorForKey(key);\n    return decorator.getPropsForKey(MultiDecorator.getInnerKey(key));\n  }\n\n  /**\n   * Return a decorator for a specific key\n   */;\n  _proto.getDecoratorForKey = function getDecoratorForKey(key) {\n    var parts = key.split(KEY_SEPARATOR);\n    var index = Number(parts[0]);\n    return this.decorators.get(index);\n  }\n\n  /**\n   * Return inner key for a decorator\n   */;\n  MultiDecorator.getInnerKey = function getInnerKey(key) {\n    var parts = key.split(KEY_SEPARATOR);\n    return parts.slice(1).join(KEY_SEPARATOR);\n  };\n  return MultiDecorator;\n}();\n\n// Return true if decorator implements the DraftDecoratorType interface\n// @see https://github.com/facebook/draft-js/blob/master/src/model/decorators/DraftDecoratorType.js\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar decoratorIsCustom = function decoratorIsCustom(decorator) {\n  return typeof decorator.getDecorations === 'function' && typeof decorator.getComponentForKey === 'function' && typeof decorator.getPropsForKey === 'function';\n};\nvar getDecoratorsFromProps = function getDecoratorsFromProps(_ref) {\n  var decorators = _ref.decorators,\n    _ref$plugins = _ref.plugins,\n    plugins = _ref$plugins === void 0 ? [] : _ref$plugins;\n  return List([{\n    decorators: decorators\n  }].concat(plugins)).filter(function (plugin) {\n    return (plugin == null ? void 0 : plugin.decorators) !== undefined;\n  }).flatMap(function (plugin) {\n    return plugin == null ? void 0 : plugin.decorators;\n  });\n};\nfunction resolveDecorators(props, getEditorState, onChange) {\n  var decorators = getDecoratorsFromProps(props);\n  var compositeDecorator = createCompositeDecorator(decorators.filter(function (decorator) {\n    return !decoratorIsCustom(decorator);\n  }), getEditorState, onChange);\n  var customDecorators = decorators.filter(function (decorator) {\n    return decoratorIsCustom(decorator);\n  });\n  return new MultiDecorator(customDecorators.push(compositeDecorator));\n}\n\nvar _excluded = [\"keyBindingFn\"];\n\n// should be DraftDecoratorType but it is not accessible and does not habe decorators or _decorators\n\nvar getDecoratorLength = function getDecoratorLength(obj) {\n  if ((obj == null ? void 0 : obj.decorators) != null) {\n    var _obj$decorators;\n    return (_obj$decorators = obj.decorators) == null ? void 0 : _obj$decorators.size;\n  } else if ((obj == null ? void 0 : obj._decorators) != null) {\n    var _obj$_decorators;\n    return (_obj$_decorators = obj._decorators) == null ? void 0 : _obj$_decorators.length;\n  }\n  return undefined;\n};\n\n/**\n * The main editor component\n */\nvar PluginEditor = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(PluginEditor, _Component);\n  function PluginEditor(_props) {\n    var _this;\n    _this = _Component.call(this, _props) || this;\n    _this.editor = null;\n    _this.state = {\n      readOnly: false // TODO for Nik: ask ben why this is relevent\n    };\n    // Cycle through the plugins, changing the editor state with what the plugins\n    // changed (or didn't)\n    _this.onChange = function (editorState) {\n      var newEditorState = editorState;\n      _this.resolvePlugins().forEach(function (plugin) {\n        if (plugin.onChange) {\n          newEditorState = plugin.onChange(newEditorState, _this.getPluginMethods());\n        }\n      });\n      if (_this.props.onChange) {\n        _this.props.onChange(newEditorState);\n      }\n    };\n    _this.getPlugins = function () {\n      return [].concat(_this.props.plugins);\n    };\n    _this.getProps = function () {\n      return _extends({}, _this.props);\n    };\n    // TODO further down in render we use readOnly={this.props.readOnly || this.state.readOnly}. Ask Ben why readOnly is here just from the props? Why would plugins use this instead of just taking it from getProps?\n    _this.getReadOnly = function () {\n      return _this.props.readOnly || _this.state.readOnly;\n    };\n    _this.setReadOnly = function (readOnly) {\n      if (readOnly !== _this.state.readOnly) {\n        _this.setState({\n          readOnly: readOnly\n        });\n      }\n    };\n    //the editors editor html element is not supported in the draft js typescript interface\n    _this.getEditorRef = function () {\n      return _this.editor;\n    };\n    _this.getEditorState = function () {\n      return _this.props.editorState;\n    };\n    _this.getPluginMethods = function () {\n      return {\n        getPlugins: _this.getPlugins,\n        getProps: _this.getProps,\n        setEditorState: _this.onChange,\n        getEditorState: _this.getEditorState,\n        getReadOnly: _this.getReadOnly,\n        setReadOnly: _this.setReadOnly,\n        getEditorRef: _this.getEditorRef\n      };\n    };\n    _this.createPluginHooks = function () {\n      var plugins = [_this.props].concat(_this.resolvePlugins());\n      return createPluginHooks(plugins, _this.getPluginMethods());\n    };\n    _this.resolvePlugins = function () {\n      var plugins = _this.getPlugins();\n      if (_this.props.defaultKeyBindings === true) {\n        plugins.push({\n          keyBindingFn: keyBindingFn\n        });\n      }\n      if (_this.props.defaultKeyCommands === true) {\n        plugins.push({\n          handleKeyCommand: handleKeyCommand\n        });\n      }\n      return plugins;\n    };\n    _this.resolveCustomStyleMap = function () {\n      var customStyleMap = _this.props.plugins.filter(function (plug) {\n        return plug.customStyleMap !== undefined;\n      }).map(function (plug) {\n        return plug.customStyleMap;\n      });\n      return customStyleMap.concat([_this.props.customStyleMap]).reduce(function (styles, style) {\n        return _extends({}, styles, style);\n      }, {});\n    };\n    _this.resolveblockRenderMap = function () {\n      var blockRenderMap = _this.props.plugins.filter(function (plug) {\n        return plug.blockRenderMap !== undefined;\n      }).reduce(function (maps, plug) {\n        return maps.merge(plug.blockRenderMap);\n      }, Map({}));\n      if (_this.props.defaultBlockRenderMap) {\n        blockRenderMap = DefaultDraftBlockRenderMap.merge(blockRenderMap);\n      }\n      if (_this.props.blockRenderMap) {\n        blockRenderMap = blockRenderMap.merge(_this.props.blockRenderMap);\n      }\n      return blockRenderMap;\n    };\n    _this.resolveAccessibilityProps = function () {\n      var accessibilityProps = {};\n      _this.resolvePlugins().forEach(function (plugin) {\n        if (typeof plugin.getAccessibilityProps !== 'function') {\n          return;\n        }\n        var props = plugin.getAccessibilityProps();\n        var popupProps = {};\n        if (accessibilityProps.ariaHasPopup === undefined) {\n          popupProps.ariaHasPopup = props.ariaHasPopup;\n        } else if (props.ariaHasPopup === 'true') {\n          popupProps.ariaHasPopup = 'true';\n        }\n        if (accessibilityProps.ariaExpanded === undefined) {\n          popupProps.ariaExpanded = props.ariaExpanded;\n        } else if (props.ariaExpanded === true) {\n          popupProps.ariaExpanded = true;\n        }\n        accessibilityProps = _extends({}, accessibilityProps, props, popupProps);\n      });\n      return accessibilityProps;\n    };\n    var _plugins = [_this.props].concat(_this.resolvePlugins());\n    _plugins.forEach(function (plugin) {\n      if (plugin && typeof plugin.initialize === 'function') {\n        plugin.initialize(_this.getPluginMethods());\n      }\n    });\n    return _this;\n  }\n  var _proto = PluginEditor.prototype;\n  _proto.focus = function focus() {\n    if (this.editor) {\n      this.editor.focus();\n    }\n  };\n  _proto.blur = function blur() {\n    if (this.editor) {\n      this.editor.blur();\n    }\n  };\n  _proto.componentDidMount = function componentDidMount() {\n    var decorator = resolveDecorators(this.props, this.getEditorState, this.onChange);\n    var editorState = EditorState.set(this.props.editorState, {\n      decorator: decorator\n    });\n    this.onChange(EditorState.moveSelectionToEnd(editorState));\n  };\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var next = this.props;\n    var currDec = prevProps.editorState.getDecorator();\n    var nextDec = next.editorState.getDecorator();\n\n    // If there is not current decorator, there's nothing to carry over to the next editor state\n    if (!currDec) {\n      return;\n    }\n    // If the current decorator is the same as the new one, don't call onChange to avoid infinite loops\n    if (currDec === nextDec) {\n      return;\n    }\n    // If the old and the new decorator are the same, but no the same object, also don't call onChange to avoid infinite loops\n    if (currDec && nextDec && getDecoratorLength(currDec) === getDecoratorLength(nextDec)) {\n      return;\n    }\n    var editorState = EditorState.set(next.editorState, {\n      decorator: currDec\n    });\n    this.onChange(EditorState.moveSelectionToEnd(editorState));\n  };\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    var _this2 = this;\n    this.resolvePlugins().forEach(function (plugin) {\n      if (plugin.willUnmount) {\n        plugin.willUnmount({\n          getEditorState: _this2.getEditorState,\n          setEditorState: _this2.onChange\n        });\n      }\n    });\n  };\n  _proto.render = function render() {\n    var _this3 = this;\n    var pluginHooks = this.createPluginHooks();\n    var customStyleMap = this.resolveCustomStyleMap();\n    var accessibilityProps = this.resolveAccessibilityProps();\n    var blockRenderMap = this.resolveblockRenderMap();\n    var _this$props = this.props;\n      _this$props.keyBindingFn;\n      var editorProps = _objectWithoutPropertiesLoose(_this$props, _excluded);\n    return /*#__PURE__*/React.createElement(Editor, _extends({}, editorProps, accessibilityProps, pluginHooks, {\n      readOnly: this.props.readOnly || this.state.readOnly,\n      customStyleMap: customStyleMap,\n      blockRenderMap: blockRenderMap,\n      onChange: this.onChange,\n      editorState: this.props.editorState,\n      ref: function ref(element) {\n        _this3.editor = element;\n      }\n    }));\n  };\n  return PluginEditor;\n}(Component);\nPluginEditor.propTypes = {\n  editorState: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired,\n  plugins: PropTypes.array,\n  defaultKeyBindings: PropTypes.bool,\n  defaultKeyCommands: PropTypes.bool,\n  defaultBlockRenderMap: PropTypes.bool,\n  customStyleMap: PropTypes.object,\n  // eslint-disable-next-line react/no-unused-prop-types\n  decorators: PropTypes.array\n};\nPluginEditor.defaultProps = {\n  defaultBlockRenderMap: true,\n  defaultKeyBindings: true,\n  defaultKeyCommands: true,\n  customStyleMap: {},\n  plugins: [],\n  decorators: []\n};\nvar PluginEditor$1 = PluginEditor;\n\nvar createEditorStateWithText = createEditorStateWithText$1;\nvar composeDecorators = composeDecorators$1;\n\n//the editors editor html element is not supported in the draft js typescript interface\n\nexport { composeDecorators, createEditorStateWithText, PluginEditor$1 as default };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}