{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/attributes/InstanceItemAttributesForm.tsx\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport { observer } from 'mobx-react';\nimport EasyForm from '@appen-china/easy-form';\nimport store from '../../store/RootStore';\nimport { setInitialValues } from '../../utils';\nimport './AttributesModal.scss';\nconst InstanceItemAttributesForm = observer(({\n  instanceItem,\n  onSubmit\n}) => {\n  // FIXME: use current camera cause multiple cameras not supported yet\n  const {\n    currentCamera,\n    currentFrame,\n    isSingleCamera,\n    cameraNames\n  } = store.frame;\n  const frameData = instanceItem.cameras[currentCamera].frames[currentFrame];\n  const {\n    labelConfig: config\n  } = instanceItem.categoryItemRef;\n\n  // fields\n  const [fields, setFields] = useState([]);\n  // field -> applied frames mapping\n  const fieldFramesMap = useRef({});\n\n  // set initial ocr text\n  useEffect(() => {\n    setFields(setInitialValues((config === null || config === void 0 ? void 0 : config.fields) || [], frameData === null || frameData === void 0 ? void 0 : frameData.attributes));\n  }, []);\n  const handleSubmit = attributes => {\n    const allValues = {\n      attributes\n    };\n    onSubmit(allValues, fieldFramesMap.current);\n  };\n  if (!store.instance.isInstanceItemAttributesEnabled(instanceItem)) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"attributes-form-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"attributes-form-section__title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }\n  }, `${instanceItem.itemLabel}${isSingleCamera ? '' : `-C${cameraNames.indexOf(currentCamera) + 1}`}`), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"attributes-form-section__content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }\n  }, config && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"attributes-form-section__item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(EasyForm, {\n    theme: \"dark\",\n    fields: fields,\n    conditions: config.conditions,\n    effects: config.effects,\n    rules: config.rules,\n    onSubmit: v => handleSubmit(v),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }\n  }))), !config && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"easyform-btn form-btn-submit\",\n    onClick: () => handleSubmit(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  })));\n});\nexport default InstanceItemAttributesForm;","map":{"version":3,"names":["React","useState","useEffect","useRef","observer","EasyForm","store","setInitialValues","InstanceItemAttributesForm","instanceItem","onSubmit","currentCamera","currentFrame","isSingleCamera","cameraNames","frame","frameData","cameras","frames","labelConfig","config","categoryItemRef","fields","setFields","fieldFramesMap","attributes","handleSubmit","allValues","current","instance","isInstanceItemAttributesEnabled","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","itemLabel","indexOf","theme","conditions","effects","rules","v","style","display","onClick"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/attributes/InstanceItemAttributesForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { observer } from 'mobx-react';\nimport EasyForm from '@appen-china/easy-form';\nimport { Field } from '@appen-china/easy-form/es/types';\nimport InstanceItem from '../../model/InstanceItem';\nimport store from '../../store/RootStore';\nimport { setInitialValues } from '../../utils';\nimport './AttributesModal.scss';\n\ninterface InstanceItemAttributesFormProps {\n  instanceItem: InstanceItem;\n  onSubmit: (values: { attributes?: any }, fieldFramesMap: { [field: string]: number[] }) => void;\n}\n\nconst InstanceItemAttributesForm = observer(({ instanceItem, onSubmit }: InstanceItemAttributesFormProps) => {\n  // FIXME: use current camera cause multiple cameras not supported yet\n  const { currentCamera, currentFrame, isSingleCamera, cameraNames } = store.frame;\n  const frameData = instanceItem.cameras[currentCamera].frames[currentFrame];\n  const { labelConfig: config } = instanceItem.categoryItemRef;\n\n  // fields\n  const [fields, setFields] = useState<Field[]>([]);\n  // field -> applied frames mapping\n  const fieldFramesMap = useRef<{ [field: string]: number[] }>({});\n\n  // set initial ocr text\n  useEffect(() => {\n    setFields(setInitialValues(config?.fields || [], frameData?.attributes));\n  }, []);\n\n  const handleSubmit = (attributes?: any) => {\n    const allValues: { attributes?: any } = { attributes };\n    onSubmit(allValues, fieldFramesMap.current);\n  };\n\n  if (!store.instance.isInstanceItemAttributesEnabled(instanceItem)) {\n    return null;\n  }\n\n  return (\n    <div className=\"attributes-form-section\">\n      <div className=\"attributes-form-section__title\">\n        {`${instanceItem.itemLabel}${isSingleCamera ? '' : `-C${cameraNames.indexOf(currentCamera) + 1}`}`}\n      </div>\n      <div className=\"attributes-form-section__content\">\n        {config && (\n          <div className=\"attributes-form-section__item\">\n            <EasyForm\n              theme=\"dark\"\n              fields={fields}\n              conditions={config.conditions}\n              effects={config.effects}\n              rules={config.rules}\n              onSubmit={(v) => handleSubmit(v)}\n            />\n          </div>\n        )}\n      </div>\n      {!config && (\n        <div style={{ display: 'none' }}>\n          {/* eslint-disable-next-line jsx-a11y/control-has-associated-label */}\n          <button className=\"easyform-btn form-btn-submit\" onClick={() => handleSubmit()} />\n        </div>\n      )}\n    </div>\n  );\n});\n\nexport default InstanceItemAttributesForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}