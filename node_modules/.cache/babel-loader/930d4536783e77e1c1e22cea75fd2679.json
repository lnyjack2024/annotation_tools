{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/common/sidebar/ShapeMenu.tsx\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport cx from 'classnames';\nimport './ShapeMenu.scss';\nconst ShapeMenu = ({\n  position,\n  items,\n  onClose\n}) => {\n  const menuRef = useRef(null);\n  const [pos, setPos] = useState(position);\n  useEffect(() => {\n    const listener = e => {\n      var _menuRef$current;\n      if (!((_menuRef$current = menuRef.current) === null || _menuRef$current === void 0 ? void 0 : _menuRef$current.contains(e.target))) {\n        onClose();\n      }\n    };\n    window.addEventListener('mousedown', listener);\n    return () => {\n      window.removeEventListener('mousedown', listener);\n    };\n  }, []);\n  useEffect(() => {\n    if (menuRef.current) {\n      const {\n        top,\n        height,\n        left,\n        width\n      } = menuRef.current.getBoundingClientRect();\n      let {\n        x,\n        y\n      } = position;\n      if (left + width > window.innerWidth) {\n        x = window.innerWidth - width;\n      }\n      if (top + height > window.innerHeight) {\n        y = window.innerHeight - height;\n      }\n      setPos({\n        x,\n        y\n      });\n    } else {\n      setPos(position);\n    }\n  }, [position]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: menuRef,\n    className: \"shape-menu\",\n    style: {\n      top: pos.y,\n      left: pos.x\n    },\n    onContextMenu: e => e.preventDefault(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 5\n    }\n  }, items.map((sectionItems, index) => {\n    var _sectionItems$;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: (_sectionItems$ = sectionItems[0]) === null || _sectionItems$ === void 0 ? void 0 : _sectionItems$.label,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }\n    }, index !== 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"divider\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 27\n      }\n    }), sectionItems.map(item => /*#__PURE__*/React.createElement(\"div\", {\n      key: item.label,\n      className: cx('shape-menu-item', {\n        disabled: item.disabled\n      }),\n      onClick: () => {\n        if (!item.disabled) {\n          item.onClick();\n          onClose();\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 13\n      }\n    }, item.label)));\n  }));\n};\nexport default ShapeMenu;","map":{"version":3,"names":["React","useEffect","useRef","useState","cx","ShapeMenu","position","items","onClose","menuRef","pos","setPos","listener","e","_menuRef$current","current","contains","target","window","addEventListener","removeEventListener","top","height","left","width","getBoundingClientRect","x","y","innerWidth","innerHeight","createElement","ref","className","style","onContextMenu","preventDefault","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","map","sectionItems","index","_sectionItems$","key","label","item","disabled","onClick"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/common/sidebar/ShapeMenu.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport cx from 'classnames';\nimport './ShapeMenu.scss';\n\ninterface ShapeMenuProps {\n  position: { x: number; y: number };\n  items: {\n    label: string;\n    disabled?: boolean;\n    onClick: () => void;\n  }[][];\n  onClose: () => void;\n}\n\nconst ShapeMenu = ({ position, items, onClose }: ShapeMenuProps) => {\n  const menuRef = useRef<HTMLDivElement>(null);\n  const [pos, setPos] = useState(position);\n\n  useEffect(() => {\n    const listener = (e: MouseEvent) => {\n      if (!menuRef.current?.contains(e.target as Node)) {\n        onClose();\n      }\n    };\n    window.addEventListener('mousedown', listener);\n    return () => {\n      window.removeEventListener('mousedown', listener);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (menuRef.current) {\n      const { top, height, left, width } = menuRef.current.getBoundingClientRect();\n      let { x, y } = position;\n      if (left + width > window.innerWidth) {\n        x = window.innerWidth - width;\n      }\n      if (top + height > window.innerHeight) {\n        y = window.innerHeight - height;\n      }\n      setPos({ x, y });\n    } else {\n      setPos(position);\n    }\n  }, [position]);\n\n  return (\n    <div\n      ref={menuRef}\n      className=\"shape-menu\"\n      style={{ top: pos.y, left: pos.x }}\n      onContextMenu={(e) => e.preventDefault()}\n    >\n      {items.map((sectionItems, index) => (\n        <div key={sectionItems[0]?.label}>\n          {index !== 0 && <div className=\"divider\" />}\n          {sectionItems.map((item) => (\n            <div\n              key={item.label}\n              className={cx('shape-menu-item', {\n                disabled: item.disabled,\n              })}\n              onClick={() => {\n                if (!item.disabled) {\n                  item.onClick();\n                  onClose();\n                }\n              }}\n            >\n              {item.label}\n            </div>\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default ShapeMenu;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}