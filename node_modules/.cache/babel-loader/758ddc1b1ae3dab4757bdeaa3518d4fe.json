{"ast":null,"code":"import _applyDecoratedDescriptor from \"/Users/qzheng/Documents/webroot/annotation_tools/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nvar _class;\nimport { computed, makeAutoObservable } from 'mobx';\nimport { LabelItem, LabelStyle, LabelFormat } from '../types';\nexport let AttributesMode = /*#__PURE__*/function (AttributesMode) {\n  AttributesMode[\"HIDE\"] = \"hide\";\n  AttributesMode[\"HOVER\"] = \"hover\";\n  AttributesMode[\"ALWAYS\"] = \"always\";\n  return AttributesMode;\n}({});\nlet SettingStore = (_class = class SettingStore {\n  constructor(rootStore) {\n    this.rootStore = void 0;\n    this.isFullScreen = false;\n    this.isGridVisible = true;\n    this.pointSize = 4;\n    this.lineWidth = 1;\n    this.filters = {};\n    this.customCheck = [];\n    this.submitCheck = false;\n    /**\n     * active attributes mode for point\n     */\n    this.activePointAttributesMode = AttributesMode.HIDE;\n    /**\n     * active attributes mode\n     */\n    this.activeAttributesMode = AttributesMode.HIDE;\n    /**\n     * label mode\n     */\n    this.labelMode = true;\n    /**\n     * label items\n     */\n    this.labelItems = [LabelItem.CATEGORY, LabelItem.ATTRIBUTE_KEYS, LabelItem.ATTRIBUTE_VALUES];\n    /**\n     * label style\n     */\n    this.labelStyle = LabelStyle.DEFAULT;\n    /**\n     * label background color\n     */\n    this.labelBgColor = 'rgba(0,0,0,0.6)';\n    /**\n     * label format\n     */\n    this.labelFormat = LabelFormat.DEFAULT;\n    /**\n     * label items for point\n     */\n    this.pointLabelItems = [LabelItem.NUMBER, LabelItem.ATTRIBUTE_KEYS, LabelItem.ATTRIBUTE_VALUES];\n    this.displayPointIndex = true;\n    makeAutoObservable(this, {\n      rootStore: false,\n      customCheck: false,\n      submitCheck: false,\n      labelBgColor: false,\n      displayPointIndex: false\n    }, {\n      autoBind: true\n    });\n    this.rootStore = rootStore;\n  }\n  setPointSize(size) {\n    this.pointSize = size;\n  }\n  setLineWidth(width) {\n    this.lineWidth = width;\n  }\n  setFullScreen(full) {\n    this.isFullScreen = full;\n  }\n  setGridVisible(visible) {\n    this.isGridVisible = visible;\n  }\n  setLabelMode(mode) {\n    this.labelMode = mode;\n  }\n  handleFiltersChange(filters) {\n    this.filters = filters;\n  }\n  get displayCategory() {\n    return this.labelItems.includes(LabelItem.CATEGORY);\n  }\n\n  /**\n   * init by payload\n   * @param payload\n   */\n  initPayload(payload) {\n    return new Promise(resolve => {\n      // parse label mode\n      this.activeAttributesMode = Object.values(AttributesMode).includes(payload.label_mode) ? payload.label_mode : AttributesMode.HIDE;\n      // parse poiny label mode\n      this.activePointAttributesMode = Object.values(AttributesMode).includes(payload.point_label_mode) ? payload.point_label_mode : AttributesMode.ALWAYS;\n      // parse label style\n      this.labelStyle = Object.values(LabelStyle).includes(payload.label_style) ? payload.label_style : LabelStyle.DEFAULT;\n      this.labelBgColor = this.labelStyle === LabelStyle.DEFAULT ? 'rgba(0,0,0,0.6)' : 'rgba(0,0,0,0.0)';\n      // parse label format\n      this.labelFormat = Object.values(LabelFormat).includes(payload.label_format) ? payload.label_format : LabelFormat.DEFAULT;\n      // parse label items\n      if (typeof payload.label_item === 'string' && payload.label_item) {\n        this.labelItems = [];\n        payload.label_item.split(',').forEach(i => {\n          const item = i.trim();\n          if (Object.values(LabelItem).includes(item)) {\n            this.labelItems.push(item);\n          }\n        });\n      }\n      // parse point label items\n      if (typeof payload.point_label_item === 'string' && payload.point_label_item) {\n        this.pointLabelItems = [];\n        payload.point_label_item.split(',').forEach(i => {\n          const item = i.trim();\n          if (Object.values(LabelItem).includes(item)) {\n            this.pointLabelItems.push(item);\n          }\n        });\n        this.displayPointIndex = this.pointLabelItems.includes(LabelItem.NUMBER);\n      }\n\n      // parse validator\n      if (typeof payload.custom_check === 'string') {\n        const scriptIds = payload.custom_check.split(',').map(i => i.trim()).filter(i => !!i);\n        if (scriptIds.length > 0) {\n          this.customCheck = scriptIds;\n        }\n      }\n      // parse submit check config\n      this.submitCheck = payload.submit_check === 'true' || payload.submit_check === true;\n      resolve(true);\n    });\n  }\n\n  /**\n   * set active attributes mode\n   * @param activeMode\n   * @param type point or object\n   */\n  setActiveAttributesMode(activeMode, type = 'object') {\n    if (type === 'keypoint') {\n      this.activePointAttributesMode = activeMode;\n    } else {\n      this.activeAttributesMode = activeMode;\n    }\n  }\n}, _applyDecoratedDescriptor(_class.prototype, \"displayCategory\", [computed], Object.getOwnPropertyDescriptor(_class.prototype, \"displayCategory\"), _class.prototype), _class);\nexport default SettingStore;","map":{"version":3,"names":["computed","makeAutoObservable","LabelItem","LabelStyle","LabelFormat","AttributesMode","SettingStore","_class","constructor","rootStore","isFullScreen","isGridVisible","pointSize","lineWidth","filters","customCheck","submitCheck","activePointAttributesMode","HIDE","activeAttributesMode","labelMode","labelItems","CATEGORY","ATTRIBUTE_KEYS","ATTRIBUTE_VALUES","labelStyle","DEFAULT","labelBgColor","labelFormat","pointLabelItems","NUMBER","displayPointIndex","autoBind","setPointSize","size","setLineWidth","width","setFullScreen","full","setGridVisible","visible","setLabelMode","mode","handleFiltersChange","displayCategory","includes","initPayload","payload","Promise","resolve","Object","values","label_mode","point_label_mode","ALWAYS","label_style","label_format","label_item","split","forEach","i","item","trim","push","point_label_item","custom_check","scriptIds","map","filter","length","submit_check","setActiveAttributesMode","activeMode","type","_applyDecoratedDescriptor","prototype","getOwnPropertyDescriptor"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/keypoint/store/SettingsStore.ts"],"sourcesContent":["import { computed, makeAutoObservable } from 'mobx';\nimport { RootStoreType } from './RootStore';\nimport { LabelItem, LabelStyle, LabelFormat } from '../types';\n\nexport enum AttributesMode {\n  HIDE = 'hide',\n  HOVER = 'hover',\n  ALWAYS = 'always',\n}\n\nclass SettingStore {\n  rootStore: RootStoreType;\n\n  isFullScreen = false;\n\n  isGridVisible = true;\n\n  pointSize = 4;\n\n  lineWidth = 1;\n\n  filters: {[key: string]: number;} = {};\n\n  customCheck: string[] = [];\n\n  submitCheck = false;\n\n  /**\n   * active attributes mode for point\n   */\n  activePointAttributesMode = AttributesMode.HIDE;\n\n  /**\n   * active attributes mode\n   */\n  activeAttributesMode = AttributesMode.HIDE;\n\n  /**\n   * label mode\n   */\n  labelMode = true;\n\n  /**\n   * label items\n   */\n  labelItems = [LabelItem.CATEGORY, LabelItem.ATTRIBUTE_KEYS, LabelItem.ATTRIBUTE_VALUES];\n\n  /**\n   * label style\n   */\n  labelStyle = LabelStyle.DEFAULT;\n\n  /**\n   * label background color\n   */\n\n  labelBgColor = 'rgba(0,0,0,0.6)';\n\n  /**\n   * label format\n   */\n  labelFormat = LabelFormat.DEFAULT;\n\n  /**\n   * label items for point\n   */\n  pointLabelItems = [LabelItem.NUMBER, LabelItem.ATTRIBUTE_KEYS, LabelItem.ATTRIBUTE_VALUES];\n\n  displayPointIndex = true;\n\n  constructor(rootStore: RootStoreType) {\n    makeAutoObservable(this, {\n      rootStore: false,\n      customCheck: false,\n      submitCheck: false,\n      labelBgColor: false,\n      displayPointIndex: false,\n    }, {\n      autoBind: true,\n    });\n    this.rootStore = rootStore;\n  }\n\n  setPointSize(size: number) {\n    this.pointSize = size;\n  }\n\n  setLineWidth(width: number) {\n    this.lineWidth = width;\n  }\n\n  setFullScreen(full: boolean) {\n    this.isFullScreen = full;\n  }\n\n  setGridVisible(visible: boolean) {\n    this.isGridVisible = visible;\n  }\n\n  setLabelMode(mode: boolean) {\n    this.labelMode = mode;\n  }\n\n  handleFiltersChange(filters: {[key: string]: number}) {\n    this.filters = filters;\n  }\n\n  @computed get displayCategory() {\n    return this.labelItems.includes(LabelItem.CATEGORY);\n  }\n\n  /**\n   * init by payload\n   * @param payload\n   */\n  initPayload(payload: {[key: string]: any}) {\n    return new Promise((resolve) => {\n      // parse label mode\n      this.activeAttributesMode = Object.values(AttributesMode).includes(payload.label_mode) ? payload.label_mode : AttributesMode.HIDE;\n      // parse poiny label mode\n      this.activePointAttributesMode = Object.values(AttributesMode).includes(payload.point_label_mode) ? payload.point_label_mode : AttributesMode.ALWAYS;\n      // parse label style\n      this.labelStyle = Object.values(LabelStyle).includes(payload.label_style) ? payload.label_style : LabelStyle.DEFAULT;\n      this.labelBgColor = this.labelStyle === LabelStyle.DEFAULT ? 'rgba(0,0,0,0.6)' : 'rgba(0,0,0,0.0)';\n      // parse label format\n      this.labelFormat = Object.values(LabelFormat).includes(payload.label_format) ? payload.label_format : LabelFormat.DEFAULT;\n      // parse label items\n      if (typeof payload.label_item === 'string' && payload.label_item) {\n        this.labelItems = [];\n        payload.label_item.split(',').forEach((i) => {\n          const item = i.trim();\n          if ((Object.values(LabelItem) as string[]).includes(item)) {\n            this.labelItems.push(item as LabelItem);\n          }\n        });\n      }\n      // parse point label items\n      if (typeof payload.point_label_item === 'string' && payload.point_label_item) {\n        this.pointLabelItems = [];\n        payload.point_label_item.split(',').forEach((i) => {\n          const item = i.trim();\n          if ((Object.values(LabelItem) as string[]).includes(item)) {\n            this.pointLabelItems.push(item as LabelItem);\n          }\n        });\n        this.displayPointIndex = this.pointLabelItems.includes(LabelItem.NUMBER);\n      }\n\n      // parse validator\n      if (typeof payload.custom_check === 'string') {\n        const scriptIds = payload.custom_check.split(',').map((i) => i.trim()).filter((i) => !!i);\n        if (scriptIds.length > 0) {\n          this.customCheck = scriptIds;\n        }\n      }\n      // parse submit check config\n      this.submitCheck = payload.submit_check === 'true' || payload.submit_check === true;\n      resolve(true);\n    });\n  }\n\n  /**\n   * set active attributes mode\n   * @param activeMode\n   * @param type point or object\n   */\n  setActiveAttributesMode(activeMode: AttributesMode, type = 'object') {\n    if (type === 'keypoint') {\n      this.activePointAttributesMode = activeMode;\n    } else {\n      this.activeAttributesMode = activeMode;\n    }\n  };\n}\n\nexport default SettingStore;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}