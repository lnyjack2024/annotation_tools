{"ast":null,"code":"import { makeAutoObservable, toJS } from 'mobx';\nimport { parseLabelConfig, triggerForm } from '../utils';\nclass GlobalStore {\n  /**\n   * invalid annotate disabled\n   */\n  get annotateDisabled() {\n    var _this$attributes;\n    return !this.invalidAnnotatable && ((_this$attributes = this.attributes) === null || _this$attributes === void 0 ? void 0 : _this$attributes.is_valid) === 'invalid';\n  }\n  get lackGlobalAttributes() {\n    return this.globalConfig.fields.length > 0 && Object.keys(this.attributes).length === 0;\n  }\n  constructor(rootStore) {\n    this.rootStore = void 0;\n    this.attributes = {};\n    this.globalConfig = {\n      fields: []\n    };\n    this.invalidAnnotatable = true;\n    this.setAttributes = values => {\n      this.attributes = {\n        ...toJS(this.attributes),\n        ...values\n      };\n    };\n    makeAutoObservable(this, {\n      rootStore: false,\n      globalConfig: false\n    }, {\n      autoBind: true\n    });\n    this.rootStore = rootStore;\n  }\n  init(data) {\n    if (data.global_config) {\n      this.globalConfig = parseLabelConfig(data.global_config) || {\n        fields: []\n      };\n      const {\n        updatedValues\n      } = triggerForm(this.globalConfig);\n      this.setAttributes(updatedValues);\n    }\n    this.invalidAnnotatable = data.invalid_annotatable !== 'false' && data.invalid_annotatable !== false;\n  }\n}\nexport default GlobalStore;","map":{"version":3,"names":["makeAutoObservable","toJS","parseLabelConfig","triggerForm","GlobalStore","annotateDisabled","_this$attributes","invalidAnnotatable","attributes","is_valid","lackGlobalAttributes","globalConfig","fields","length","Object","keys","constructor","rootStore","setAttributes","values","autoBind","init","data","global_config","updatedValues","invalid_annotatable"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/multi-channel/store/GlobalStore.ts"],"sourcesContent":["import { makeAutoObservable, toJS } from 'mobx';\nimport { RootStoreType } from './RootStore';\nimport { parseLabelConfig, triggerForm } from '../utils';\nimport { Payload, FormConfig } from '../types';\n\nclass GlobalStore {\n  rootStore: RootStoreType;\n\n  attributes: {[key: string]: any} = {};\n\n  globalConfig: FormConfig = { fields: [] };\n\n  invalidAnnotatable = true;\n\n  /**\n   * invalid annotate disabled\n   */\n  get annotateDisabled() {\n    return !this.invalidAnnotatable && this.attributes?.is_valid === 'invalid';\n  }\n\n  get lackGlobalAttributes() {\n    return this.globalConfig.fields.length > 0 && Object.keys(this.attributes).length === 0;\n  }\n\n  constructor(rootStore: RootStoreType) {\n    makeAutoObservable(this, {\n      rootStore: false,\n      globalConfig: false,\n    }, {\n      autoBind: true,\n    });\n    this.rootStore = rootStore;\n  }\n\n  init(data: Payload) {\n    if (data.global_config) {\n      this.globalConfig = parseLabelConfig(data.global_config) || { fields: [] };\n      const { updatedValues } = triggerForm(this.globalConfig);\n      this.setAttributes(updatedValues);\n    }\n    this.invalidAnnotatable = data.invalid_annotatable !== 'false' && data.invalid_annotatable !== false;\n  }\n\n  setAttributes = (values: {[key:string]: any}) => {\n    this.attributes = {\n      ...toJS(this.attributes),\n      ...values\n    };\n  };\n}\n\nexport default GlobalStore;\n"],"mappings":"AAAA,SAASA,kBAAkB,EAAEC,IAAI,QAAQ,MAAM;AAE/C,SAASC,gBAAgB,EAAEC,WAAW,QAAQ,UAAU;AAGxD,MAAMC,WAAW,CAAC;EAShB;AACF;AACA;EACE,IAAIC,gBAAgBA,CAAA,EAAG;IAAA,IAAAC,gBAAA;IACrB,OAAO,CAAC,IAAI,CAACC,kBAAkB,IAAI,EAAAD,gBAAA,OAAI,CAACE,UAAU,cAAAF,gBAAA,uBAAfA,gBAAA,CAAiBG,QAAQ,MAAK,SAAS;EAC5E;EAEA,IAAIC,oBAAoBA,CAAA,EAAG;IACzB,OAAO,IAAI,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,GAAG,CAAC,IAAIC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACP,UAAU,CAAC,CAACK,MAAM,KAAK,CAAC;EACzF;EAEAG,WAAWA,CAACC,SAAwB,EAAE;IAAA,KAnBtCA,SAAS;IAAA,KAETT,UAAU,GAAyB,CAAC,CAAC;IAAA,KAErCG,YAAY,GAAe;MAAEC,MAAM,EAAE;IAAG,CAAC;IAAA,KAEzCL,kBAAkB,GAAG,IAAI;IAAA,KAgCzBW,aAAa,GAAIC,MAA2B,IAAK;MAC/C,IAAI,CAACX,UAAU,GAAG;QAChB,GAAGP,IAAI,CAAC,IAAI,CAACO,UAAU,CAAC;QACxB,GAAGW;MACL,CAAC;IACH,CAAC;IAvBCnB,kBAAkB,CAAC,IAAI,EAAE;MACvBiB,SAAS,EAAE,KAAK;MAChBN,YAAY,EAAE;IAChB,CAAC,EAAE;MACDS,QAAQ,EAAE;IACZ,CAAC,CAAC;IACF,IAAI,CAACH,SAAS,GAAGA,SAAS;EAC5B;EAEAI,IAAIA,CAACC,IAAa,EAAE;IAClB,IAAIA,IAAI,CAACC,aAAa,EAAE;MACtB,IAAI,CAACZ,YAAY,GAAGT,gBAAgB,CAACoB,IAAI,CAACC,aAAa,CAAC,IAAI;QAAEX,MAAM,EAAE;MAAG,CAAC;MAC1E,MAAM;QAAEY;MAAc,CAAC,GAAGrB,WAAW,CAAC,IAAI,CAACQ,YAAY,CAAC;MACxD,IAAI,CAACO,aAAa,CAACM,aAAa,CAAC;IACnC;IACA,IAAI,CAACjB,kBAAkB,GAAGe,IAAI,CAACG,mBAAmB,KAAK,OAAO,IAAIH,IAAI,CAACG,mBAAmB,KAAK,KAAK;EACtG;AAQF;AAEA,eAAerB,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module"}