{"ast":null,"code":"import React from'react';import{connect}from'react-redux';import'./SegmentDetail.scss';import EasyForm from'@appen-china/easy-form';import LineDetail from'./LineDetail/LineDetail';import{pushLine,setLineRole,setSegmentQAState,setSegmentCategory,setSegmentAttributes,setAttributeFocusInfo}from'../../redux/action';import{formatTimestamp,SegmentMode,translate,triggerForm,attributeType}from'../../constants';import{isInput}from'../../redux/reducer/segmentController';import QAForm from'./QAForm/QAForm';import{isReviewEditable,isAnnotationReadonly}from'../../../../utils/tool-mode';class SegmentDetail extends React.Component{constructor(props){super(props);this.handleFocusAttribute=()=>{const{focusAttribute:{videoIndex,segmentIndex,type,lineIndex,key},currentVideo,currentSegment}=this.props;if(videoIndex===currentVideo&&segmentIndex===currentSegment&&key){const attributeContainer=document.getElementsByClassName(type===attributeType.line?\"line-attributes-\".concat(lineIndex):'segment-attributes')[0];if(attributeContainer){let timer=setTimeout(()=>{clearTimeout(timer);timer=null;const label=attributeContainer.querySelector(\"label[for=\".concat(key,\"]\"));const attribute=attributeContainer===null||attributeContainer===void 0?void 0:attributeContainer.querySelector(\"#\".concat(key));label===null||label===void 0?void 0:label.scrollIntoView();attribute===null||attribute===void 0?void 0:attribute.focus();document.documentElement.scroll({top:0});this.props.setAttributeFocusInfo();},10);}}};this.handleKeyDown=e=>{if(isInput())return;const{currentSegment,toolMode,annotateDisabled}=this.props;if(e.keyCode===81){// q\ne.preventDefault();this.props.setCurrentSegment({index:currentSegment-1});}else if(e.keyCode===69){// e\ne.preventDefault();this.props.setCurrentSegment({index:currentSegment+1});}if(e.keyCode>=48&&e.key<=57&&!annotateDisabled){const i=parseInt(e.key,10);if(i>=this.ontologyValidKeys.length)return;const role=this.ontologyValidKeys[i];this.props.setLineRole({videoIndex:null,segmentIndex:null,lineIndex:0,role});}if(e.keyCode===13&&e.ctrlKey&&isReviewEditable(toolMode)){e.preventDefault();this.props.setSegmentQAState({qaChecked:true});this.props.setCurrentSegment({index:currentSegment+1});}};this.changeSegmentCategory=data=>{const{segmentConfig,results,currentVideo,currentSegment}=this.props;const segment=results[currentVideo][currentSegment];const attributes={...segment.attributes,...data};const{updatedValues}=triggerForm(segmentConfig,attributes);this.props.setSegmentAttributes({videoIndex:currentVideo,segmentIndex:currentSegment,attributes:updatedValues});};this.segmentRef=React.createRef();this.isPreventScroll=false;}handleButtonClick(e,type){const{currentSegment}=this.props;let newRole=null;switch(type){case'prev':this.props.setCurrentSegment({index:currentSegment-1});break;case'next':this.props.setCurrentSegment({index:currentSegment+1});break;case'push':// eslint-disable-next-line no-restricted-syntax\nfor(const value of this.allRoles){if(this.currentRoles.indexOf(value)<0){newRole=value;break;}}this.props.pushLine({videoIndex:null,segmentIndex:currentSegment,role:newRole});break;default:break;}}// eslint-disable-next-line react/no-deprecated\ncomponentWillMount(){// eslint-disable-next-line no-undef\nwindow.addEventListener('keydown',this.handleKeyDown);this.ontologyValidKeys=[];const{ontology}=this.props;ontology.forEach((value,key)=>{this.ontologyValidKeys.push(key);});}shouldComponentUpdate(nextProps){const{results,segmentConfig,currentVideo,currentSegment,keyAttribute,toolMode,annotateDisabled}=nextProps;const nextCurrentValues=results[currentVideo][currentSegment];if(currentVideo!==this.props.currentVideo||currentSegment!==this.props.currentSegment||!this.config||annotateDisabled!==this.props.annotateDisabled){this.isPreventScroll=true;const{fields}=segmentConfig;if(keyAttribute.options.length>0&&!fields.find(v=>v.name===keyAttribute.name)){fields.unshift(keyAttribute);}const readonly=isAnnotationReadonly(toolMode)||annotateDisabled;this.config={...segmentConfig,fields:fields.map(field=>({...field,readonly:readonly||field.readonly,optionType:'button',...(nextCurrentValues&&nextCurrentValues.attributes&&nextCurrentValues.attributes[field.name]!==undefined&&{defaultValue:nextCurrentValues.attributes[field.name]})})),footerVisible:false};}else{this.isPreventScroll=false;}return true;}componentDidUpdate(prevProps){var _this$props$focusAttr;if(this.segmentRef.current&&this.isPreventScroll){let timer=setTimeout(()=>{clearTimeout(timer);timer=null;this.segmentRef.current.scrollTop=0;},10);}if((_this$props$focusAttr=this.props.focusAttribute)===null||_this$props$focusAttr===void 0?void 0:_this$props$focusAttr.key){this.handleFocusAttribute();}}render(){const{results,ontology,currentVideo,currentSegment,toolMode}=this.props;this.segment=results[currentVideo][currentSegment];if(!this.segment){return null;}this.currentRoles=[];this.allRoles=[];ontology.forEach((value,key)=>{this.allRoles.push(key);});this.segment.content.forEach(value=>{this.currentRoles.push(value.role);});const segment=results[currentVideo][currentSegment];return/*#__PURE__*/React.createElement(\"div\",{className:\"segment-detail-container\",ref:this.segmentRef,key:\"\".concat(currentVideo,\"_\").concat(currentSegment,\"_\").concat(segment.id)},/*#__PURE__*/React.createElement(\"div\",{className:\"segment-detail-head\"},/*#__PURE__*/React.createElement(\"div\",{className:\"segment-detail-index\"},currentSegment+1),/*#__PURE__*/React.createElement(\"div\",{className:\"segment-detail-timestamp\"},\"\".concat(formatTimestamp(segment.start),\"~\").concat(formatTimestamp(segment.end))),/*#__PURE__*/React.createElement(SegmentDetailChangeButton,{className:\"segment-detail-change\",content:translate('next'),shortcut:\"E\",onClick:e=>this.handleButtonClick(e,'next'),disabled:currentSegment+1===results[currentVideo].length,type2:\"next\"}),/*#__PURE__*/React.createElement(SegmentDetailChangeButton,{className:\"segment-detail-change\",content:translate('prev'),shortcut:\"Q\",onClick:e=>this.handleButtonClick(e,'prev'),disabled:currentSegment===0,type2:\"prev\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"segment-detail-body\"},isReviewEditable(toolMode)?/*#__PURE__*/React.createElement(QAForm,null):null,/*#__PURE__*/React.createElement(\"div\",{className:\"segment-attributes\"},/*#__PURE__*/React.createElement(EasyForm,Object.assign({theme:\"dark\",autoFocus:false},this.config&&this.config,{onChange:this.changeSegmentCategory}))),segment.content.map((line,index)=>/*#__PURE__*/React.createElement(LineDetail/* eslint-disable-next-line react/no-array-index-key */,{key:\"line-detail-\".concat(index),line:line,currentRoles:this.currentRoles,lineIndex:index}))),this.props.overlap&&/*#__PURE__*/React.createElement(\"button\",{className:\"segment-push-line\",onClick:e=>this.handleButtonClick(e,'push'),style:{display:this.currentRoles.length===this.allRoles.length?'none':'block'},disabled:isAnnotationReadonly(this.props.toolMode)||this.props.annotateDisabled},/*#__PURE__*/React.createElement(\"div\",{className:\"add-role-icon\"},\" +\"),translate('addRole')));}}const SegmentDetailChangeButton=props=>/*#__PURE__*/React.createElement(\"button\",{className:\"segment-detail-change\",type:\"button\",onClick:e=>props.onClick(e,props.type2),style:{display:props.disabled?'none':'block'}},props.content,/*#__PURE__*/React.createElement(\"span\",null,\" {\".concat(props.shortcut,\"} \")));const mapStateToProps=state=>({results:state.results,ontology:state.ontology,segmentConfig:state.segmentConfig,lineConfig:state.lineConfig,currentVideo:state.currentVideo,currentSegment:state.currentSegment,videos:state.videos,toolMode:state.toolMode,overlap:state.overlap,keyAttribute:state.keyAttribute,segmentMode:state.segmentMode,annotateDisabled:state.annotateDisabled,focusAttribute:state.focusAttribute,loadReviewEnabled:state.loadReviewEnabled});const mapDispatchToProps={pushLine,setLineRole,setSegmentQAState,setSegmentCategory,setAttributeFocusInfo,setSegmentAttributes};export default connect(mapStateToProps,mapDispatchToProps)(SegmentDetail);","map":{"version":3,"names":["React","connect","EasyForm","LineDetail","pushLine","setLineRole","setSegmentQAState","setSegmentCategory","setSegmentAttributes","setAttributeFocusInfo","formatTimestamp","SegmentMode","translate","triggerForm","attributeType","isInput","QAForm","isReviewEditable","isAnnotationReadonly","SegmentDetail","Component","constructor","props","handleFocusAttribute","focusAttribute","videoIndex","segmentIndex","type","lineIndex","key","currentVideo","currentSegment","attributeContainer","document","getElementsByClassName","line","concat","timer","setTimeout","clearTimeout","label","querySelector","attribute","scrollIntoView","focus","documentElement","scroll","top","handleKeyDown","e","toolMode","annotateDisabled","keyCode","preventDefault","setCurrentSegment","index","i","parseInt","ontologyValidKeys","length","role","ctrlKey","qaChecked","changeSegmentCategory","data","segmentConfig","results","segment","attributes","updatedValues","segmentRef","createRef","isPreventScroll","handleButtonClick","newRole","value","allRoles","currentRoles","indexOf","componentWillMount","window","addEventListener","ontology","forEach","push","shouldComponentUpdate","nextProps","keyAttribute","nextCurrentValues","config","fields","options","find","v","name","unshift","readonly","map","field","optionType","undefined","defaultValue","footerVisible","componentDidUpdate","prevProps","_this$props$focusAttr","current","scrollTop","render","content","createElement","className","ref","id","start","end","SegmentDetailChangeButton","shortcut","onClick","disabled","type2","Object","assign","theme","autoFocus","onChange","overlap","style","display","mapStateToProps","state","lineConfig","videos","segmentMode","loadReviewEnabled","mapDispatchToProps"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/long-audio/components/SegmentDetail/SegmentDetail.jsx"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport './SegmentDetail.scss';\nimport EasyForm from '@appen-china/easy-form';\nimport LineDetail from './LineDetail/LineDetail';\nimport { pushLine, setLineRole, setSegmentQAState, setSegmentCategory, setSegmentAttributes, setAttributeFocusInfo } from '../../redux/action';\nimport { formatTimestamp, SegmentMode, translate, triggerForm, attributeType } from '../../constants';\nimport { isInput } from '../../redux/reducer/segmentController';\nimport QAForm from './QAForm/QAForm';\nimport { isReviewEditable, isAnnotationReadonly } from '../../../../utils/tool-mode';\n\nclass SegmentDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.segmentRef = React.createRef();\n    this.isPreventScroll = false;\n  }\n\n  handleButtonClick(e, type) {\n    const { currentSegment } = this.props;\n    let newRole = null;\n    switch (type) {\n      case 'prev':\n        this.props.setCurrentSegment({ index: currentSegment - 1 });\n        break;\n      case 'next':\n        this.props.setCurrentSegment({ index: currentSegment + 1 });\n        break;\n      case 'push':\n        // eslint-disable-next-line no-restricted-syntax\n        for (const value of this.allRoles) {\n          if (this.currentRoles.indexOf(value) < 0) {\n            newRole = value;\n            break;\n          }\n        }\n        this.props.pushLine({\n          videoIndex: null,\n          segmentIndex: currentSegment,\n          role: newRole,\n        });\n        break;\n      default:\n        break;\n    }\n  }\n\n  // eslint-disable-next-line react/no-deprecated\n  componentWillMount() {\n    // eslint-disable-next-line no-undef\n    window.addEventListener('keydown', this.handleKeyDown);\n    this.ontologyValidKeys = [];\n    const { ontology } = this.props;\n    ontology.forEach((value, key) => {\n      this.ontologyValidKeys.push(key);\n    });\n  }\n\n  shouldComponentUpdate(nextProps) {\n    const { results, segmentConfig, currentVideo, currentSegment, keyAttribute, toolMode, annotateDisabled } = nextProps;\n    const nextCurrentValues = results[currentVideo][currentSegment];\n    if (\n      currentVideo !== this.props.currentVideo ||\n      currentSegment !== this.props.currentSegment ||\n      !this.config ||\n      annotateDisabled !== this.props.annotateDisabled\n    ) {\n      this.isPreventScroll = true;\n      const { fields } = segmentConfig;\n      if (keyAttribute.options.length > 0 && !fields.find((v) => v.name === keyAttribute.name)) {\n        fields.unshift(keyAttribute);\n      }\n      const readonly = isAnnotationReadonly(toolMode) || annotateDisabled;\n      this.config = {\n        ...segmentConfig,\n        fields: fields.map((field) => ({\n          ...field,\n          readonly: readonly || field.readonly,\n          optionType: 'button',\n          ...nextCurrentValues && nextCurrentValues.attributes && nextCurrentValues.attributes[field.name] !== undefined && {\n            defaultValue: nextCurrentValues.attributes[field.name],\n          }\n        })),\n        footerVisible: false,\n      };\n    } else {\n      this.isPreventScroll = false;\n    }\n    return true;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.segmentRef.current && this.isPreventScroll) {\n      let timer = setTimeout(() => {\n        clearTimeout(timer);\n        timer = null;\n        this.segmentRef.current.scrollTop = 0;\n      }, 10);\n    }\n    if (this.props.focusAttribute?.key) {\n      this.handleFocusAttribute();\n    }\n  }\n\n  handleFocusAttribute = () => {\n    const { focusAttribute: { videoIndex, segmentIndex, type, lineIndex, key }, currentVideo, currentSegment } = this.props;\n    if (videoIndex === currentVideo && segmentIndex === currentSegment && key) {\n      const attributeContainer = document.getElementsByClassName(type === attributeType.line ? `line-attributes-${lineIndex}` : 'segment-attributes')[0];\n      if (attributeContainer) {\n        let timer = setTimeout(() => {\n          clearTimeout(timer);\n          timer = null;\n          const label = attributeContainer.querySelector(`label[for=${key}]`);\n          const attribute = attributeContainer?.querySelector(`#${key}`);\n          label?.scrollIntoView();\n          attribute?.focus();\n          document.documentElement.scroll({ top: 0 });\n          this.props.setAttributeFocusInfo();\n        }, 10);\n      }\n    }\n  };\n\n  handleKeyDown = (e) => {\n    if (isInput()) return;\n    const { currentSegment, toolMode, annotateDisabled } = this.props;\n    if (e.keyCode === 81) { // q\n      e.preventDefault();\n      this.props.setCurrentSegment({ index: currentSegment - 1 });\n    } else if (e.keyCode === 69) { // e\n      e.preventDefault();\n      this.props.setCurrentSegment({ index: currentSegment + 1 });\n    }\n    if (e.keyCode >= 48 && e.key <= 57 && !annotateDisabled) {\n      const i = parseInt(e.key, 10);\n      if (i >= this.ontologyValidKeys.length) return;\n      const role = this.ontologyValidKeys[i];\n      this.props.setLineRole({\n        videoIndex: null,\n        segmentIndex: null,\n        lineIndex: 0,\n        role,\n      });\n    }\n    if (e.keyCode === 13 && e.ctrlKey && isReviewEditable(toolMode)) {\n      e.preventDefault();\n      this.props.setSegmentQAState({ qaChecked: true });\n      this.props.setCurrentSegment({ index: currentSegment + 1 });\n    }\n  };\n\n  changeSegmentCategory = (data) => {\n    const { segmentConfig, results, currentVideo, currentSegment } = this.props;\n    const segment = results[currentVideo][currentSegment];\n    const attributes = {\n      ...segment.attributes,\n      ...data,\n    };\n    const { updatedValues } = triggerForm(segmentConfig, attributes);\n    this.props.setSegmentAttributes({\n      videoIndex: currentVideo,\n      segmentIndex: currentSegment,\n      attributes: updatedValues\n    });\n  };\n\n  render() {\n    const { results, ontology, currentVideo, currentSegment, toolMode } = this.props;\n    this.segment = results[currentVideo][currentSegment];\n    if (!this.segment) {\n      return null;\n    }\n    this.currentRoles = [];\n    this.allRoles = [];\n    ontology.forEach((value, key) => {\n      this.allRoles.push(key);\n    });\n    this.segment.content.forEach((value) => {\n      this.currentRoles.push(value.role);\n    });\n    const segment = results[currentVideo][currentSegment];\n    return (\n      <div className=\"segment-detail-container\" ref={this.segmentRef} key={`${currentVideo}_${currentSegment}_${segment.id}`}>\n        <div className=\"segment-detail-head\">\n          <div className=\"segment-detail-index\">{currentSegment + 1}</div>\n          <div className=\"segment-detail-timestamp\">\n            {`${formatTimestamp(segment.start)}~${formatTimestamp(segment.end)}`}\n          </div>\n          <SegmentDetailChangeButton\n            className=\"segment-detail-change\"\n            content={translate('next')}\n            shortcut=\"E\"\n            onClick={(e) => this.handleButtonClick(e, 'next')}\n            disabled={currentSegment + 1 === results[currentVideo].length}\n            type2=\"next\"\n          />\n          <SegmentDetailChangeButton\n            className=\"segment-detail-change\"\n            content={translate('prev')}\n            shortcut=\"Q\"\n            onClick={(e) => this.handleButtonClick(e, 'prev')}\n            disabled={currentSegment === 0}\n            type2=\"prev\"\n          />\n        </div>\n        <div className=\"segment-detail-body\">\n          {isReviewEditable(toolMode) ? <QAForm /> : null}\n          <div className=\"segment-attributes\">\n            <EasyForm\n              theme=\"dark\"\n              autoFocus={false}\n              {...this.config && this.config}\n              onChange={this.changeSegmentCategory}\n            />\n          </div>\n          {segment.content.map((line, index) => (\n            <LineDetail\n              /* eslint-disable-next-line react/no-array-index-key */\n              key={`line-detail-${index}`}\n              line={line}\n              currentRoles={this.currentRoles}\n              lineIndex={index}\n            />\n          ))}\n        </div>\n        {(this.props.overlap) && (\n          <button\n            className=\"segment-push-line\"\n            onClick={(e) => this.handleButtonClick(e, 'push')}\n            style={{ display: this.currentRoles.length === this.allRoles.length ? 'none' : 'block' }}\n            disabled={isAnnotationReadonly(this.props.toolMode) || this.props.annotateDisabled}\n          >\n            <div className=\"add-role-icon\"> +</div>\n            {translate('addRole')}\n          </button>\n        )}\n      </div>\n    );\n  }\n}\n\nconst SegmentDetailChangeButton = ((props) => (\n  <button\n    className=\"segment-detail-change\"\n    type=\"button\"\n    onClick={(e) => props.onClick(e, props.type2)}\n    style={{ display: props.disabled ? 'none' : 'block' }}\n  >\n    {props.content}\n    <span>\n      {` {${props.shortcut}} `}\n    </span>\n  </button>\n));\n\nconst mapStateToProps = (state) => ({\n  results: state.results,\n  ontology: state.ontology,\n  segmentConfig: state.segmentConfig,\n  lineConfig: state.lineConfig,\n  currentVideo: state.currentVideo,\n  currentSegment: state.currentSegment,\n  videos: state.videos,\n  toolMode: state.toolMode,\n  overlap: state.overlap,\n  keyAttribute: state.keyAttribute,\n  segmentMode: state.segmentMode,\n  annotateDisabled: state.annotateDisabled,\n  focusAttribute: state.focusAttribute,\n  loadReviewEnabled: state.loadReviewEnabled,\n});\nconst mapDispatchToProps = {\n  pushLine,\n  setLineRole,\n  setSegmentQAState,\n  setSegmentCategory,\n  setAttributeFocusInfo,\n  setSegmentAttributes,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(SegmentDetail);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}