{"ast":null,"code":"import{convertFromRaw,convertToRaw}from'draft-js';import{customAlphabet}from'nanoid';import{ContentItemType}from'../types';import{UNSTYLED_TYPE}from'./constants';const nanoid=customAlphabet('1234567890abcdefghijklmnopqrstuvwxyz',5);export function contentToContentState(content){const raw={entityMap:{},blocks:[]};for(let i=0;i<content.length;i+=1){const item=content[i];switch(item.type){case ContentItemType.UNSTYLED:{raw.blocks.push({key:nanoid(),type:item.type,text:item.content,depth:0,inlineStyleRanges:[],entityRanges:[],data:item.data});break;}default:}}// always add empty line\nraw.blocks.push({key:nanoid(),type:UNSTYLED_TYPE,text:'',depth:0,inlineStyleRanges:[],entityRanges:[]});return convertFromRaw(raw);}export function contentStateToContent(contentState){const{blocks,entityMap}=convertToRaw(contentState);const content=[];for(let i=0;i<blocks.length;i+=1){const block=blocks[i];switch(block.type){case UNSTYLED_TYPE:{content.push({type:ContentItemType.UNSTYLED,content:block.text});break;}default:}}// remove last empty line\nconst last=content[content.length-1];if(last.type===ContentItemType.UNSTYLED&&!last.content){content.pop();}return content;}","map":{"version":3,"names":["convertFromRaw","convertToRaw","customAlphabet","ContentItemType","UNSTYLED_TYPE","nanoid","contentToContentState","content","raw","entityMap","blocks","i","length","item","type","UNSTYLED","push","key","text","depth","inlineStyleRanges","entityRanges","data","contentStateToContent","contentState","block","last","pop"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/common/llm/input/utils.ts"],"sourcesContent":["import { ContentState, RawDraftContentState, convertFromRaw, convertToRaw } from 'draft-js';\nimport { customAlphabet } from 'nanoid';\nimport { Content, ContentItemType } from '../types';\nimport { UNSTYLED_TYPE } from './constants';\n\nconst nanoid = customAlphabet('1234567890abcdefghijklmnopqrstuvwxyz', 5);\n\nexport function contentToContentState(content: Content): ContentState {\n  const raw: RawDraftContentState = {\n    entityMap: {},\n    blocks: [],\n  };\n\n  for (let i = 0; i < content.length; i += 1) {\n    const item = content[i];\n\n    switch (item.type) {\n      case ContentItemType.UNSTYLED: {\n        raw.blocks.push({\n          key: nanoid(),\n          type: item.type,\n          text: item.content,\n          depth: 0,\n          inlineStyleRanges: [],\n          entityRanges: [],\n          data: item.data,\n        });\n        break;\n      }\n\n      default:\n    }\n  }\n\n  // always add empty line\n  raw.blocks.push({\n    key: nanoid(),\n    type: UNSTYLED_TYPE,\n    text: '',\n    depth: 0,\n    inlineStyleRanges: [],\n    entityRanges: [],\n  });\n  return convertFromRaw(raw);\n}\n\nexport function contentStateToContent(contentState: ContentState): Content {\n  const { blocks, entityMap } = convertToRaw(contentState);\n\n  const content: Content = [];\n  for (let i = 0; i < blocks.length; i += 1) {\n    const block = blocks[i];\n    switch (block.type) {\n      case UNSTYLED_TYPE: {\n        content.push({\n          type: ContentItemType.UNSTYLED,\n          content: block.text,\n        });\n        break;\n      }\n\n      default:\n    }\n  }\n\n  // remove last empty line\n  const last = content[content.length - 1];\n  if (last.type === ContentItemType.UNSTYLED && !last.content) {\n    content.pop();\n  }\n\n  return content;\n}\n"],"mappings":"AAAA,OAA6CA,cAAc,CAAEC,YAAY,KAAQ,UAAU,CAC3F,OAASC,cAAc,KAAQ,QAAQ,CACvC,OAAkBC,eAAe,KAAQ,UAAU,CACnD,OAASC,aAAa,KAAQ,aAAa,CAE3C,KAAM,CAAAC,MAAM,CAAGH,cAAc,CAAC,sCAAsC,CAAE,CAAC,CAAC,CAExE,MAAO,SAAS,CAAAI,qBAAqBA,CAACC,OAAgB,CAAgB,CACpE,KAAM,CAAAC,GAAyB,CAAG,CAChCC,SAAS,CAAE,CAAC,CAAC,CACbC,MAAM,CAAE,EACV,CAAC,CAED,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGJ,OAAO,CAACK,MAAM,CAAED,CAAC,EAAI,CAAC,CAAE,CAC1C,KAAM,CAAAE,IAAI,CAAGN,OAAO,CAACI,CAAC,CAAC,CAEvB,OAAQE,IAAI,CAACC,IAAI,EACf,IAAK,CAAAX,eAAe,CAACY,QAAQ,CAAE,CAC7BP,GAAG,CAACE,MAAM,CAACM,IAAI,CAAC,CACdC,GAAG,CAAEZ,MAAM,CAAC,CAAC,CACbS,IAAI,CAAED,IAAI,CAACC,IAAI,CACfI,IAAI,CAAEL,IAAI,CAACN,OAAO,CAClBY,KAAK,CAAE,CAAC,CACRC,iBAAiB,CAAE,EAAE,CACrBC,YAAY,CAAE,EAAE,CAChBC,IAAI,CAAET,IAAI,CAACS,IACb,CAAC,CAAC,CACF,MACF,CAEA,QACF,CACF,CAEA;AACAd,GAAG,CAACE,MAAM,CAACM,IAAI,CAAC,CACdC,GAAG,CAAEZ,MAAM,CAAC,CAAC,CACbS,IAAI,CAAEV,aAAa,CACnBc,IAAI,CAAE,EAAE,CACRC,KAAK,CAAE,CAAC,CACRC,iBAAiB,CAAE,EAAE,CACrBC,YAAY,CAAE,EAChB,CAAC,CAAC,CACF,MAAO,CAAArB,cAAc,CAACQ,GAAG,CAAC,CAC5B,CAEA,MAAO,SAAS,CAAAe,qBAAqBA,CAACC,YAA0B,CAAW,CACzE,KAAM,CAAEd,MAAM,CAAED,SAAU,CAAC,CAAGR,YAAY,CAACuB,YAAY,CAAC,CAExD,KAAM,CAAAjB,OAAgB,CAAG,EAAE,CAC3B,IAAK,GAAI,CAAAI,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGD,MAAM,CAACE,MAAM,CAAED,CAAC,EAAI,CAAC,CAAE,CACzC,KAAM,CAAAc,KAAK,CAAGf,MAAM,CAACC,CAAC,CAAC,CACvB,OAAQc,KAAK,CAACX,IAAI,EAChB,IAAK,CAAAV,aAAa,CAAE,CAClBG,OAAO,CAACS,IAAI,CAAC,CACXF,IAAI,CAAEX,eAAe,CAACY,QAAQ,CAC9BR,OAAO,CAAEkB,KAAK,CAACP,IACjB,CAAC,CAAC,CACF,MACF,CAEA,QACF,CACF,CAEA;AACA,KAAM,CAAAQ,IAAI,CAAGnB,OAAO,CAACA,OAAO,CAACK,MAAM,CAAG,CAAC,CAAC,CACxC,GAAIc,IAAI,CAACZ,IAAI,GAAKX,eAAe,CAACY,QAAQ,EAAI,CAACW,IAAI,CAACnB,OAAO,CAAE,CAC3DA,OAAO,CAACoB,GAAG,CAAC,CAAC,CACf,CAEA,MAAO,CAAApB,OAAO,CAChB","ignoreList":[]},"metadata":{},"sourceType":"module"}