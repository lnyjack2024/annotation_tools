{"ast":null,"code":"import _applyDecoratedDescriptor from\"/Users/qzheng/Documents/webroot/annotation_tools/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";var _class;import{observable,computed,makeObservable,action,toJS}from'mobx';import{v4 as uuidv4}from'uuid';import{ReviewResult,ValidationType}from'../types';import{ToolMode,isReviewEditable,isAnnotationReadonly}from'../../../utils/tool-mode';;;/**\n * reviews stores\n */let ReviewsStore=(_class=class ReviewsStore{/**\n   * qa qarnings\n   */get qaWarnings(){return[...this.reviews,...this.missingReviews].filter(review=>review.result===ReviewResult.REJECT).map(review=>{var _review$type;return{id:review.instanceId||review.id,groupName:review.groupName,shapeIds:review.shapeIds,data:review.data,frames:[review.frameIndex],message:((_review$type=review.type)===null||_review$type===void 0?void 0:_review$type.join(','))||'',comment:review.comment,warningType:ValidationType.QUALITY};});}/**\n   * warnings\n   */get warnings(){return this.customWarnings.length||this.qaWarnings.length?[...toJS(this.customWarnings),...this.qaWarnings]:[];}/**\n   * frame instance review mapping\n   */get frameReviewsMap(){const reviewsMap={};this.reviews.forEach(review=>{const{frameIndex,instanceId,groupName,shapeIds,result}=review;const results={};shapeIds.forEach(id=>{if(typeof id==='string'){results[id]=result;}else{results[id]=result;}});if(!reviewsMap[frameIndex]){reviewsMap[frameIndex]={[instanceId]:{[groupName]:{}}};}if(!reviewsMap[frameIndex][instanceId]){reviewsMap[frameIndex][instanceId]={[groupName]:{}};}if(!reviewsMap[frameIndex][instanceId][groupName]){reviewsMap[frameIndex][instanceId][groupName]={};}reviewsMap[frameIndex][instanceId][groupName]={...reviewsMap[frameIndex][instanceId][groupName],...results};});return reviewsMap;}constructor(rootStore){var _this=this;this.rootStore=void 0;/**\n   * current tool mode\n   */this.toolMode=ToolMode.LABELING;/**\n   * canvas draw\n   */this.drawMode=true;/**\n * missing name\n */this.missingName='Missing';/**\n   * issue types\n   */this.issueTypes=[];/**\n   * all reviews\n   */this.reviews=[];/**\n * all missing reviews\n */this.missingReviews=[];/**\n   * selected review\n   */this.selectedReview=void 0;/**\n * selected missing review\n */this.selectedMissingReview=void 0;/**\n   * is selected missing review modal visible\n   */this.selectedMissingReviewModalVisible=false;/**\n   * custom warnings\n   */this.customWarnings=[];/**\n   * has custom error\n   */this.hasCustomError=false;/**\n   * blockSubmitErrors\n   */this.blockSubmitErrors=[];/**\n   * errors\n   */this.errors=void 0;/**\n   * delete review\n   * @param instanceId\n   * @param frameIndex\n   */this.deleteReviewByInstance=function(){let currentReview=arguments.length>0&&arguments[0]!==undefined?arguments[0]:_this.selectedReview;if(_this.isEnabled&&currentReview){const{instanceId,frameIndex,groupName,shapeIds}=currentReview;const prevReviews=[..._this.reviews];const index=_this.reviews.findIndex(review=>review.frameIndex===frameIndex&&review.instanceId===instanceId&&review.groupName===groupName&&JSON.stringify(review.shapeIds)===JSON.stringify(shapeIds));if(index>=0){_this.reviews.splice(index,1);_this.changeUndo(prevReviews);}_this.setSelectedReview();}};makeObservable(this,{reviews:observable,missingReviews:observable,selectedReview:observable,selectedMissingReview:observable,selectedMissingReviewModalVisible:observable,errors:observable,customWarnings:observable,drawMode:observable,setInitialData:action,setSelectedReview:action,setReview:action,deleteReviewByInstance:action,addMissingReview:action,cancelUnfinishMissingReview:action,finishMissingReview:action,setSelectedMissingReview:action,closeMissingReviewModal:action,updateMissingReview:action,deleteMissingReview:action,setDrawMode:action});this.rootStore=rootStore;}/**\n   * is tool readonly (annotate not allowed)\n   */get readonly(){return isAnnotationReadonly(this.toolMode);}/**\n   * is review enabled\n   * @returns\n   */get isEnabled(){return isReviewEditable(this.toolMode);}/**\n   * is review editable\n   * @returns\n   */get isEditable(){return isReviewEditable(this.toolMode)&&!isAnnotationReadonly(this.toolMode);}/**\n * should show reviews\n */get showReviews(){return this.toolMode!==ToolMode.LABELING;}/**\n   * review result types\n   */get reviewResultTypes(){return this.toolMode===ToolMode.AUDIT?[ReviewResult.APPROVE,ReviewResult.REJECT,ReviewResult.SUSPEND]:[ReviewResult.APPROVE,ReviewResult.REJECT];}/**\n   * init tool mode\n   * @param toolMode\n   */init(toolMode){let issueTypes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';this.toolMode=toolMode;this.issueTypes=issueTypes.split(',').map(i=>i.trim()).filter(i=>!!i);if(this.isEnabled){this.drawMode=false;}}/**\n   * set initial data\n   * @param reviews\n   */setInitialData(reviews){if(reviews){this.reviews=[];Object.values({...reviews}).filter(v=>v&&v.result!==undefined&&(!this.isEnabled&&v.result===ReviewResult.REJECT||this.isEnabled)).forEach(_ref=>{let{instanceId,frameIndex,groupName,shapeIds,id,number,data,result,type,comment}=_ref;if(frameIndex!==undefined&&result!==undefined){if(instanceId!==undefined&&groupName!==undefined&&Array.isArray(shapeIds)&&shapeIds.length>0){this.reviews.push({instanceId,groupName,shapeIds,frameIndex,result,type,comment});}else if(data===null||data===void 0?void 0:data.position){this.missingReviews.push({id,number,frameIndex,data,result,type,comment});}}});}}/**\n   * select review\n   * @param instanceId\n   */setSelectedReview(review){if(review){const{frameIndex,instanceId,groupName,shapeIds,result}=review;const oldReview=this.getReview(frameIndex,instanceId,groupName,shapeIds);if(this.isEnabled){this.selectedReview=oldReview?{...oldReview,result}:review;}else if(oldReview){this.selectedReview=oldReview;}}else{this.selectedReview=undefined;}}/**\n   * get reviews for save\n   * @returns\n   */getReviewsForSave(){return this.reviews.map(review=>({...review}));}/**\n   * get review result\n   * @param frameIndex\n   * @param instanceId\n   * @returns\n   */getReview(frameIndex,instanceId,groupName,shapeIds){return this.reviews.find(review=>review.frameIndex===frameIndex&&review.instanceId===instanceId&&review.groupName===groupName&&JSON.stringify(review.shapeIds)===JSON.stringify(shapeIds));}/**\n   * set review\n   * @param results\n   */setReview(results){let selectedReview=arguments.length>1&&arguments[1]!==undefined?arguments[1]:toJS(this.selectedReview);if(!selectedReview||!this.isEnabled){this.selectedReview=undefined;return;}const{frameIndex,instanceId,groupName,shapeIds}=selectedReview;const prevReviews=toJS(this.reviews);const index=prevReviews.findIndex(review=>review.frameIndex===frameIndex&&review.instanceId===instanceId&&review.groupName===groupName&&JSON.stringify(review.shapeIds)===JSON.stringify(shapeIds));if(index>=0){const reviewItem=this.reviews[index];if(reviewItem.result!==results.result||reviewItem.type!==results.type||reviewItem.comment!==results.comment){reviewItem.result=results.result;reviewItem.type=results.type;reviewItem.comment=results.comment;}}else if(this.isEnabled){const currentIds=[...toJS(shapeIds)];shapeIds.forEach(shapeId=>{const itemIndex=this.reviews.findIndex(review=>review.frameIndex===frameIndex&&review.instanceId===instanceId&&review.groupName===groupName&&review.shapeIds.includes(shapeId));const item=this.reviews[itemIndex];if(item){if(item.result===results.result){const n=currentIds.findIndex(key=>key===shapeId);if(n>=0){currentIds.splice(n,1);}}else{const n=item.shapeIds.findIndex(key=>key===shapeId);if(n>=0){item.shapeIds.splice(n,1);}}if(item.shapeIds.length===0){this.reviews.splice(itemIndex,1);}}});if(currentIds.length){this.reviews.push({instanceId,groupName,shapeIds:currentIds,frameIndex,result:results.result,type:results.type,comment:results.comment});}}this.selectedReview=undefined;if(JSON.stringify(prevReviews)!==JSON.stringify(toJS(this.reviews))){this.changeUndo(prevReviews);}}addMissingReview(frameIndex){const maxNumber=Math.max(...this.missingReviews.map(r=>r.number),0);const missingReview={id:uuidv4(),number:maxNumber+1,frameIndex,result:ReviewResult.REJECT};this.missingReviews.push(missingReview);this.setSelectedMissingReview(missingReview);}cancelUnfinishMissingReview(){if(this.selectedMissingReview&&this.selectedMissingReview.data===undefined){// remove unfinished review\nconst index=this.missingReviews.findIndex(r=>{var _this$selectedMissing;return r.id===((_this$selectedMissing=this.selectedMissingReview)===null||_this$selectedMissing===void 0?void 0:_this$selectedMissing.id);});if(index>=0){this.missingReviews.splice(index,1);}}this.setSelectedMissingReview();this.closeMissingReviewModal();}finishMissingReview(p){const review=this.missingReviews.find(r=>{var _this$selectedMissing2;return r.id===((_this$selectedMissing2=this.selectedMissingReview)===null||_this$selectedMissing2===void 0?void 0:_this$selectedMissing2.id);});if(review){review.data={position:{x:p.x,y:p.y}};this.setSelectedMissingReview(review,true);}}setSelectedMissingReview(review){let openReviewModal=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.selectedMissingReview=review;if(review&&openReviewModal){this.selectedMissingReviewModalVisible=true;}}closeMissingReviewModal(){this.selectedMissingReviewModalVisible=false;}updateMissingReview(review){const index=this.missingReviews.findIndex(r=>r.id===review.id);if(index>=0){this.missingReviews.splice(index,1,review);}}deleteMissingReview(review){const index=this.missingReviews.findIndex(r=>r.id===review.id);if(index>=0){this.missingReviews.splice(index,1);}this.setSelectedMissingReview();this.closeMissingReviewModal();}changeUndo(prevReviews){const before=[];const after=[];before.push({type:'reviews',status:prevReviews});after.push({type:'reviews',status:this.reviews});this.rootStore.undo.saveStatus(before,after);}setDrawMode(mode){this.cancelUnfinishMissingReview();this.drawMode=mode;}},(_applyDecoratedDescriptor(_class.prototype,\"qaWarnings\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"qaWarnings\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"warnings\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"warnings\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"frameReviewsMap\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"frameReviewsMap\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"isEnabled\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"isEnabled\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"isEditable\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"isEditable\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"showReviews\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"showReviews\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"reviewResultTypes\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"reviewResultTypes\"),_class.prototype)),_class);export default ReviewsStore;","map":{"version":3,"names":["observable","computed","makeObservable","action","toJS","v4","uuidv4","ReviewResult","ValidationType","ToolMode","isReviewEditable","isAnnotationReadonly","ReviewsStore","_class","qaWarnings","reviews","missingReviews","filter","review","result","REJECT","map","_review$type","id","instanceId","groupName","shapeIds","data","frames","frameIndex","message","type","join","comment","warningType","QUALITY","warnings","customWarnings","length","frameReviewsMap","reviewsMap","forEach","results","constructor","rootStore","_this","toolMode","LABELING","drawMode","missingName","issueTypes","selectedReview","selectedMissingReview","selectedMissingReviewModalVisible","hasCustomError","blockSubmitErrors","errors","deleteReviewByInstance","currentReview","arguments","undefined","isEnabled","prevReviews","index","findIndex","JSON","stringify","splice","changeUndo","setSelectedReview","setInitialData","setReview","addMissingReview","cancelUnfinishMissingReview","finishMissingReview","setSelectedMissingReview","closeMissingReviewModal","updateMissingReview","deleteMissingReview","setDrawMode","readonly","isEditable","showReviews","reviewResultTypes","AUDIT","APPROVE","SUSPEND","init","split","i","trim","Object","values","v","_ref","number","Array","isArray","push","position","oldReview","getReview","getReviewsForSave","find","reviewItem","currentIds","shapeId","itemIndex","includes","item","n","key","maxNumber","Math","max","r","missingReview","_this$selectedMissing","p","_this$selectedMissing2","x","y","openReviewModal","before","after","status","undo","saveStatus","mode","_applyDecoratedDescriptor","prototype","getOwnPropertyDescriptor"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/keypoint/store/ReviewsStore.ts"],"sourcesContent":["import { observable, computed, makeObservable, action, toJS } from 'mobx';\nimport { v4 as uuidv4 } from 'uuid';\nimport { RootStoreType } from './RootStore';\nimport { Status } from './UndoStore';\nimport { Review, ReviewResult, ReviewData, ValidationType, MissingReview } from '../types';\nimport { IWarning } from '../../common/tabs-menu/Validator';\nimport { ToolMode, isReviewEditable, isAnnotationReadonly } from '../../../utils/tool-mode';\nimport formatMessage from '../locales';\n\nexport interface PointReviewResult { [id: number]: ReviewResult };\ninterface ShapeReviewResult { [id: string]: ReviewResult };\nexport interface GroupReviewsMap {\n  [groupName: string]: PointReviewResult | ShapeReviewResult;\n}\nexport interface InstanceReviewsMap {\n  [instanceId: string]: GroupReviewsMap\n}\n\nexport interface FrameReviewsMap {\n  [frameIndex: number]: InstanceReviewsMap\n}\n\n/**\n * reviews stores\n */\nclass ReviewsStore {\n  rootStore: RootStoreType;\n\n  /**\n   * current tool mode\n   */\n  toolMode: ToolMode = ToolMode.LABELING;\n\n  /**\n   * canvas draw\n   */\n  drawMode = true;\n\n  /**\n * missing name\n */\n  missingName = 'Missing';\n\n  /**\n   * issue types\n   */\n  issueTypes: string[] = [];\n\n  /**\n   * all reviews\n   */\n  reviews: Review[] = [];\n\n  /**\n * all missing reviews\n */\n  missingReviews: MissingReview[] = [];\n\n  /**\n   * selected review\n   */\n  selectedReview?: Review;\n\n  /**\n * selected missing review\n */\n  selectedMissingReview?: MissingReview;\n\n  /**\n   * is selected missing review modal visible\n   */\n  selectedMissingReviewModalVisible = false;\n\n  /**\n   * custom warnings\n   */\n  customWarnings: IWarning[] = [];\n\n  /**\n   * has custom error\n   */\n  hasCustomError = false;\n\n  /**\n   * blockSubmitErrors\n   */\n  blockSubmitErrors: IWarning[] = [];\n\n  /**\n   * errors\n   */\n  errors?: {\n    [type: string]: string;\n  };\n\n  /**\n   * qa qarnings\n   */\n  @computed get qaWarnings(): IWarning[] {\n    return [...this.reviews, ...this.missingReviews]\n      .filter((review) => review.result === ReviewResult.REJECT).map((review) => ({\n        id: (review as Review).instanceId || (review as MissingReview).id,\n        groupName: (review as Review).groupName,\n        shapeIds: (review as Review).shapeIds,\n        data: (review as MissingReview).data,\n        frames: [review.frameIndex],\n        message: review.type?.join(',') || '',\n        comment: review.comment,\n        warningType: ValidationType.QUALITY\n      }));\n  }\n\n  /**\n   * warnings\n   */\n  @computed get warnings() {\n    return (this.customWarnings.length || this.qaWarnings.length) ? [...toJS(this.customWarnings), ...this.qaWarnings] : [];\n  }\n\n  /**\n   * frame instance review mapping\n   */\n  @computed get frameReviewsMap() {\n    const reviewsMap: FrameReviewsMap = {};\n    this.reviews.forEach((review) => {\n      const { frameIndex, instanceId, groupName, shapeIds, result } = review;\n      const results: PointReviewResult | ShapeReviewResult = {};\n      shapeIds.forEach((id) => {\n        if (typeof id === 'string') {\n          (results as ShapeReviewResult)[(id as string)] = result;\n        } else {\n          (results as PointReviewResult)[(id as number)] = result;\n        }\n      });\n      if (!reviewsMap[frameIndex]) {\n        reviewsMap[frameIndex] = {\n          [instanceId]: {\n            [groupName]: {}\n          }\n        };\n      }\n      if (!reviewsMap[frameIndex][instanceId]) {\n        reviewsMap[frameIndex][instanceId] = {\n          [groupName]: {}\n        };\n      }\n      if (!reviewsMap[frameIndex][instanceId][groupName]) {\n        reviewsMap[frameIndex][instanceId][groupName] = {};\n      }\n      reviewsMap[frameIndex][instanceId][groupName] = {\n        ...reviewsMap[frameIndex][instanceId][groupName],\n        ...results\n      };\n    });\n    return reviewsMap;\n  }\n\n  constructor(rootStore: RootStoreType) {\n    makeObservable(this, {\n      reviews: observable,\n      missingReviews: observable,\n      selectedReview: observable,\n      selectedMissingReview: observable,\n      selectedMissingReviewModalVisible: observable,\n      errors: observable,\n      customWarnings: observable,\n      drawMode: observable,\n      setInitialData: action,\n      setSelectedReview: action,\n      setReview: action,\n      deleteReviewByInstance: action,\n      addMissingReview: action,\n      cancelUnfinishMissingReview: action,\n      finishMissingReview: action,\n      setSelectedMissingReview: action,\n      closeMissingReviewModal: action,\n      updateMissingReview: action,\n      deleteMissingReview: action,\n      setDrawMode: action,\n    });\n    this.rootStore = rootStore;\n  }\n\n  /**\n   * is tool readonly (annotate not allowed)\n   */\n  get readonly() {\n    return isAnnotationReadonly(this.toolMode);\n  }\n\n  /**\n   * is review enabled\n   * @returns\n   */\n  @computed get isEnabled() {\n    return isReviewEditable(this.toolMode);\n  }\n\n  /**\n   * is review editable\n   * @returns\n   */\n  @computed get isEditable() {\n    return isReviewEditable(this.toolMode) && !isAnnotationReadonly(this.toolMode);\n  }\n\n  /**\n * should show reviews\n */\n  @computed get showReviews() {\n    return this.toolMode !== ToolMode.LABELING;\n  }\n\n  /**\n   * review result types\n   */\n  @computed get reviewResultTypes() {\n    return this.toolMode === ToolMode.AUDIT ? [\n      ReviewResult.APPROVE,\n      ReviewResult.REJECT,\n      ReviewResult.SUSPEND,\n    ] : [\n      ReviewResult.APPROVE,\n      ReviewResult.REJECT,\n    ];\n  }\n\n  /**\n   * init tool mode\n   * @param toolMode\n   */\n  init(toolMode: ToolMode, issueTypes = '') {\n    this.toolMode = toolMode;\n    this.issueTypes = issueTypes.split(',').map((i) => i.trim()).filter((i) => !!i);\n    if (this.isEnabled) {\n      this.drawMode = false;\n    }\n  }\n\n  /**\n   * set initial data\n   * @param reviews\n   */\n  setInitialData(reviews: any) {\n    if (reviews) {\n      this.reviews = [];\n      Object.values({ ...reviews })\n        .filter((v: any) => v && v.result !== undefined && ((!this.isEnabled && v.result === ReviewResult.REJECT) || this.isEnabled))\n        .forEach(({ instanceId, frameIndex, groupName, shapeIds, id, number, data, result, type, comment }: any) => {\n          if (\n            frameIndex !== undefined &&\n            result !== undefined\n          ) {\n            if (\n              instanceId !== undefined &&\n              groupName !== undefined &&\n              Array.isArray(shapeIds) &&\n              shapeIds.length > 0\n            ) {\n              this.reviews.push({ instanceId, groupName, shapeIds, frameIndex, result, type, comment });\n            } else if (data?.position) {\n              this.missingReviews.push({ id, number, frameIndex, data, result, type, comment });\n            }\n          }\n        });\n    }\n  }\n\n  /**\n   * select review\n   * @param instanceId\n   */\n  setSelectedReview(review?: Review) {\n    if (review) {\n      const { frameIndex, instanceId, groupName, shapeIds, result } = review;\n      const oldReview = this.getReview(frameIndex, instanceId, groupName, shapeIds);\n      if (this.isEnabled) {\n        this.selectedReview = oldReview ? { ...oldReview, result } : review;\n      } else if (oldReview) {\n        this.selectedReview = oldReview;\n      }\n    } else {\n      this.selectedReview = undefined;\n    }\n  }\n\n  /**\n   * get reviews for save\n   * @returns\n   */\n  getReviewsForSave() {\n    return this.reviews.map((review) => ({ ...review }));\n  }\n\n  /**\n   * get review result\n   * @param frameIndex\n   * @param instanceId\n   * @returns\n   */\n  getReview(frameIndex: number, instanceId: string, groupName: string, shapeIds: (string | number)[]) {\n    return this.reviews.find((review) => review.frameIndex === frameIndex && review.instanceId === instanceId && review.groupName === groupName && JSON.stringify(review.shapeIds) === JSON.stringify(shapeIds));\n  }\n\n  /**\n   * set review\n   * @param results\n   */\n  setReview(results: ReviewData, selectedReview = toJS(this.selectedReview)) {\n    if (!selectedReview || !this.isEnabled) {\n      this.selectedReview = undefined;\n      return;\n    }\n    const { frameIndex, instanceId, groupName, shapeIds } = selectedReview;\n    const prevReviews = toJS(this.reviews);\n    const index = prevReviews.findIndex((review) => review.frameIndex === frameIndex && review.instanceId === instanceId && review.groupName === groupName && JSON.stringify(review.shapeIds) === JSON.stringify(shapeIds));\n    if (index >= 0) {\n      const reviewItem = this.reviews[index];\n      if (reviewItem.result !== results.result || reviewItem.type !== results.type || reviewItem.comment !== results.comment) {\n        reviewItem.result = results.result;\n        reviewItem.type = results.type;\n        reviewItem.comment = results.comment;\n      }\n    } else if (this.isEnabled) {\n      const currentIds = [...toJS(shapeIds)];\n      shapeIds.forEach((shapeId) => {\n        const itemIndex = this.reviews.findIndex((review) => review.frameIndex === frameIndex && review.instanceId === instanceId && review.groupName === groupName && review.shapeIds.includes(shapeId));\n        const item = this.reviews[itemIndex];\n        if (item) {\n          if (item.result === results.result) {\n            const n = currentIds.findIndex((key) => key === shapeId);\n            if (n >= 0) {\n              currentIds.splice(n, 1);\n            }\n          } else {\n            const n = item.shapeIds.findIndex((key) => key === shapeId);\n            if (n >= 0) {\n              item.shapeIds.splice(n, 1);\n            }\n          }\n          if (item.shapeIds.length === 0) {\n            this.reviews.splice(itemIndex, 1);\n          }\n        }\n      });\n      if (currentIds.length) {\n        this.reviews.push({ instanceId, groupName, shapeIds: currentIds, frameIndex, result: results.result, type: results.type, comment: results.comment });\n      }\n    }\n    this.selectedReview = undefined;\n    if (JSON.stringify(prevReviews) !== JSON.stringify(toJS(this.reviews))) {\n      this.changeUndo(prevReviews);\n    }\n  }\n\n  /**\n   * delete review\n   * @param instanceId\n   * @param frameIndex\n   */\n  deleteReviewByInstance = (currentReview = this.selectedReview) => {\n    if (this.isEnabled && currentReview) {\n      const { instanceId, frameIndex, groupName, shapeIds } = currentReview;\n      const prevReviews = [...this.reviews];\n      const index = this.reviews.findIndex((review) => review.frameIndex === frameIndex && review.instanceId === instanceId && review.groupName === groupName && JSON.stringify(review.shapeIds) === JSON.stringify(shapeIds));\n      if (index >= 0) {\n        this.reviews.splice(index, 1);\n        this.changeUndo(prevReviews);\n      }\n      this.setSelectedReview();\n    }\n  };\n\n  addMissingReview(frameIndex: number) {\n    const maxNumber = Math.max(...this.missingReviews.map((r) => r.number), 0);\n    const missingReview: MissingReview = {\n      id: uuidv4(),\n      number: maxNumber + 1,\n      frameIndex,\n      result: ReviewResult.REJECT,\n    };\n    this.missingReviews.push(missingReview);\n    this.setSelectedMissingReview(missingReview);\n  }\n\n  cancelUnfinishMissingReview() {\n    if (this.selectedMissingReview && this.selectedMissingReview.data === undefined) {\n      // remove unfinished review\n      const index = this.missingReviews.findIndex((r) => r.id === this.selectedMissingReview?.id);\n      if (index >= 0) {\n        this.missingReviews.splice(index, 1);\n      }\n    }\n    this.setSelectedMissingReview();\n    this.closeMissingReviewModal();\n  }\n\n  finishMissingReview(p: { x: number; y: number }) {\n    const review = this.missingReviews.find((r) => r.id === this.selectedMissingReview?.id);\n    if (review) {\n      review.data = {\n        position: { x: p.x, y: p.y },\n      };\n      this.setSelectedMissingReview(review, true);\n    }\n  }\n\n  setSelectedMissingReview(review?: MissingReview, openReviewModal = false) {\n    this.selectedMissingReview = review;\n    if (review && openReviewModal) {\n      this.selectedMissingReviewModalVisible = true;\n    }\n  }\n\n  closeMissingReviewModal() {\n    this.selectedMissingReviewModalVisible = false;\n  }\n\n  updateMissingReview(review: MissingReview) {\n    const index = this.missingReviews.findIndex((r) => r.id === review.id);\n    if (index >= 0) {\n      this.missingReviews.splice(index, 1, review);\n    }\n  }\n\n  deleteMissingReview(review: MissingReview) {\n    const index = this.missingReviews.findIndex((r) => r.id === review.id);\n    if (index >= 0) {\n      this.missingReviews.splice(index, 1);\n    }\n    this.setSelectedMissingReview();\n    this.closeMissingReviewModal();\n  }\n\n  changeUndo(prevReviews: Review[]) {\n    const before: Status[] = [];\n    const after: Status[] = [];\n    before.push({\n      type: 'reviews',\n      status: prevReviews\n    });\n    after.push({\n      type: 'reviews',\n      status: this.reviews\n    });\n    this.rootStore.undo.saveStatus(before, after);\n  }\n\n  setDrawMode(mode: boolean) {\n    this.cancelUnfinishMissingReview();\n    this.drawMode = mode;\n  }\n}\n\nexport default ReviewsStore;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}