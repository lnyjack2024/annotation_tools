{"ast":null,"code":"import React,{useRef,useState}from'react';import{observer}from'mobx-react';import{Collapse}from'antd';import{CaretRightOutlined}from'@ant-design/icons';import Modal from'src/components/common/modal/Modal';import{Warning}from'../../../common/icons';import ImagePreview from'../../../common/modal/ImagePreview';import store from'../../store/RootStore';import i18n from'../../locales';import{ReviewResult,ReviewMode}from'../../types';import ValidationPanelReviews from'./ValidationPanelReviews';const ValidationPanel=observer(()=>{const reviews=store.review.allReviews.filter(r=>r.result===ReviewResult.REJECT);const[previewImg,setPreviewImg]=useState('');const[deleteType,setDeleteType]=useState('');const[deleteItemsAmount,setDeleteItemsAmount]=useState(null);const[activeKey,setActiveKey]=useState([]);const[isModalVisibile,setIsModalVisibile]=useState(false);const ValidationPanelReviewsRef=useRef(null);const showConfirmModal=(amount,type)=>{setIsModalVisibile(true);setDeleteItemsAmount(amount);setDeleteType(type||'');};const handleDeleteOk=()=>{if(ValidationPanelReviewsRef&&ValidationPanelReviewsRef.current){if(!deleteType){ValidationPanelReviewsRef.current.deleteAllByCollapsePanel();}else if(deleteType==='deleteItemsBySelected'){ValidationPanelReviewsRef.current.deleteItemsBySelected();}}setIsModalVisibile(false);};const handleDeleteCancel=()=>{setIsModalVisibile(false);setDeleteType('');};return/*#__PURE__*/React.createElement(\"div\",{className:\"scroller\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-validation-header\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Warning,null),/*#__PURE__*/React.createElement(\"span\",{style:{paddingLeft:8}},i18n.translate('VALIDATION_TITLE',{values:{count:store.review.warningCount}})))),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-validation-content\"},/*#__PURE__*/React.createElement(Collapse,{activeKey:activeKey,onChange:activeKeys=>setActiveKey(activeKeys),ghost:true,expandIcon:_ref=>{let{isActive}=_ref;return/*#__PURE__*/React.createElement(CaretRightOutlined,{style:{...(isActive?{top:11,transform:'rotate(90deg)'}:{color:'rgba(255, 255, 255, 0.6)'})}});}},!store.isLabeling&&reviews&&reviews.length>0&&/*#__PURE__*/React.createElement(Collapse.Panel,{forceRender:true,key:\"reviews\",className:\"collapse-panel-reviews\",header:/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-header-customer-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-header-customer\"},i18n.translate('VALIDATION_REVIEWS'),/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-title-extra\"},/*#__PURE__*/React.createElement(\"span\",{className:\"result-count\"},reviews.length))))},/*#__PURE__*/React.createElement(ValidationPanelReviews,{ref:ValidationPanelReviewsRef,setPreviewImg:setPreviewImg,showConfirmModal:showConfirmModal})))),previewImg&&/*#__PURE__*/React.createElement(ImagePreview,{maskClosable:true,src:previewImg,onClose:()=>setPreviewImg('')}),store.config.reviewMode===ReviewMode.REVIEW&&store.reviewable&&/*#__PURE__*/React.createElement(Modal,{title:i18n.translate('VALIDATION_REVIEW_DELETE_TITLE'),maskClosable:false,visible:isModalVisibile,className:\"reviews-delete-modal\",draggable:false,onClose:handleDeleteCancel},/*#__PURE__*/React.createElement(\"p\",{style:{padding:12}},deleteType==='deleteItemsBySelected'?/*#__PURE__*/React.createElement(\"span\",null,i18n.translate('VALIDATION_REVIEW_DELETE_SELECTED_ITEMS'),i18n.translate('VALIDATION_REVIEW_DELETE_AMOUNT',{values:{deleteItemsAmount}})):/*#__PURE__*/React.createElement(\"span\",null,i18n.translate('VALIDATION_REVIEW_DELETE_ALL_BELONG'),i18n.translate('VALIDATION_REVIEW_DELETE_AMOUNT',{values:{deleteItemsAmount}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"review-action\"},/*#__PURE__*/React.createElement(\"div\",{className:\"review-btn cancel\",onClick:handleDeleteCancel},i18n.translate('COMMON_CANCEL')),/*#__PURE__*/React.createElement(\"div\",{className:\"review-btn confirm\",onClick:handleDeleteOk},i18n.translate('COMMON_OK')))));});export default ValidationPanel;","map":{"version":3,"names":["React","useRef","useState","observer","Collapse","CaretRightOutlined","Modal","Warning","ImagePreview","store","i18n","ReviewResult","ReviewMode","ValidationPanelReviews","ValidationPanel","reviews","review","allReviews","filter","r","result","REJECT","previewImg","setPreviewImg","deleteType","setDeleteType","deleteItemsAmount","setDeleteItemsAmount","activeKey","setActiveKey","isModalVisibile","setIsModalVisibile","ValidationPanelReviewsRef","showConfirmModal","amount","type","handleDeleteOk","current","deleteAllByCollapsePanel","deleteItemsBySelected","handleDeleteCancel","createElement","className","style","paddingLeft","translate","values","count","warningCount","onChange","activeKeys","ghost","expandIcon","_ref","isActive","top","transform","color","isLabeling","length","Panel","forceRender","key","header","ref","maskClosable","src","onClose","config","reviewMode","REVIEW","reviewable","title","visible","draggable","padding","onClick"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/ValidationPanel.tsx"],"sourcesContent":["import React, { useRef, useState } from 'react';\nimport { observer } from 'mobx-react';\nimport { Collapse } from 'antd';\nimport { CaretRightOutlined } from '@ant-design/icons';\nimport Modal from 'src/components/common/modal/Modal';\nimport { Warning } from '../../../common/icons';\nimport ImagePreview from '../../../common/modal/ImagePreview';\nimport store from '../../store/RootStore';\nimport i18n from '../../locales';\nimport { ReviewResult, ReviewMode } from '../../types';\nimport ValidationPanelReviews, { ValidationPanelReviewsHandle } from './ValidationPanelReviews';\n\nconst ValidationPanel = observer(() => {\n  const reviews = store.review.allReviews.filter((r) => r.result === ReviewResult.REJECT);\n  const [previewImg, setPreviewImg] = useState('');\n  const [deleteType, setDeleteType] = useState('');\n  const [deleteItemsAmount, setDeleteItemsAmount] = useState<number | null>(null);\n  const [activeKey, setActiveKey] = useState<string | string[]>([]);\n  const [isModalVisibile, setIsModalVisibile] = useState(false);\n  const ValidationPanelReviewsRef = useRef<ValidationPanelReviewsHandle>(null);\n\n  const showConfirmModal = (amount: number, type?: string) => {\n    setIsModalVisibile(true);\n    setDeleteItemsAmount(amount);\n    setDeleteType(type || '');\n  };\n\n  const handleDeleteOk = () => {\n    if (ValidationPanelReviewsRef && ValidationPanelReviewsRef.current) {\n      if (!deleteType) {\n        ValidationPanelReviewsRef.current.deleteAllByCollapsePanel();\n      } else if (deleteType === 'deleteItemsBySelected') {\n        ValidationPanelReviewsRef.current.deleteItemsBySelected();\n      }\n    }\n    setIsModalVisibile(false);\n  };\n\n  const handleDeleteCancel = () => {\n    setIsModalVisibile(false);\n    setDeleteType('');\n  };\n\n  return (\n    <div className=\"scroller\">\n      <div className=\"sidebar-validation-header\">\n        <div>\n          <Warning />\n          <span style={{ paddingLeft: 8 }}>\n            {i18n.translate('VALIDATION_TITLE', { values: { count: store.review.warningCount } })}\n          </span>\n        </div>\n      </div>\n      <div className=\"sidebar-validation-content\">\n        <Collapse\n          activeKey={activeKey}\n          onChange={(activeKeys) => setActiveKey(activeKeys)}\n          ghost\n          expandIcon={({ isActive }) => (\n            <CaretRightOutlined\n              style={{\n                ...isActive ? {\n                  top: 11,\n                  transform: 'rotate(90deg)',\n                } : {\n                  color: 'rgba(255, 255, 255, 0.6)',\n                },\n              }}\n            />\n          )}\n        >\n          {!store.isLabeling && reviews && reviews.length > 0 && (\n            <Collapse.Panel\n              forceRender\n              key=\"reviews\"\n              className=\"collapse-panel-reviews\"\n              header={(\n                <div className=\"collapse-header-customer-wrapper\">\n                  <div\n                    className=\"collapse-header-customer\"\n                  >\n                    {i18n.translate('VALIDATION_REVIEWS')}\n                    <div className=\"collapse-title-extra\">\n                      <span className=\"result-count\">\n                        {reviews.length}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              )}\n            >\n              <ValidationPanelReviews\n                ref={ValidationPanelReviewsRef}\n                setPreviewImg={setPreviewImg}\n                showConfirmModal={showConfirmModal}\n              />\n            </Collapse.Panel>\n          )}\n        </Collapse>\n      </div>\n      {previewImg && <ImagePreview maskClosable src={previewImg} onClose={() => setPreviewImg('')} />}\n      {store.config.reviewMode === ReviewMode.REVIEW && store.reviewable && (\n        <Modal\n          title={i18n.translate('VALIDATION_REVIEW_DELETE_TITLE')}\n          maskClosable={false}\n          visible={isModalVisibile}\n          className=\"reviews-delete-modal\"\n          draggable={false}\n          onClose={handleDeleteCancel}\n        >\n          <p style={{ padding: 12 }}>\n            {deleteType === 'deleteItemsBySelected' ? (\n              <span>\n                {i18n.translate('VALIDATION_REVIEW_DELETE_SELECTED_ITEMS')}\n                {i18n.translate('VALIDATION_REVIEW_DELETE_AMOUNT', { values: { deleteItemsAmount } })}\n              </span>\n            ) : (\n              <span>\n                {i18n.translate('VALIDATION_REVIEW_DELETE_ALL_BELONG')}\n                {i18n.translate('VALIDATION_REVIEW_DELETE_AMOUNT', { values: { deleteItemsAmount } })}\n              </span>\n            )}\n          </p>\n\n          <div className=\"review-action\">\n            <div\n              className=\"review-btn cancel\"\n              onClick={handleDeleteCancel}\n            >\n              {i18n.translate('COMMON_CANCEL')}\n            </div>\n            <div\n              className=\"review-btn confirm\"\n              onClick={handleDeleteOk}\n            >\n              {i18n.translate('COMMON_OK')}\n            </div>\n          </div>\n        </Modal>\n      )}\n    </div>\n  );\n});\n\nexport default ValidationPanel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}