{"ast":null,"code":"import React,{useState,useEffect}from'react';import cx from'classnames';import{Empty}from'antd';import Sidebar from'./Sidebar';import{LandmarkEditType}from'../types';import RectangleFillIcon from'../../common/icons/RectangleFill';import KeypointsIcon from'../../common/icons/Keypoints';import DownArrow from'../../common/icons/DownArrow';import formatMessage from'../locales';import'./Board.scss';const Board=_ref=>{var _instanceReviewsMap$s;let{categories=[],categoryPathShapes={},points={},selectedShapeStatus,ontologyGroup,annotated,total,drawMode,frameControlHeight,readonly,instanceReviewsMap,setSelectedShape}=_ref;const[sampleUnfold,setSampleUnfold]=useState(false);const[reference,setReference]=useState('');const[isPoint,setIsPoint]=useState(false);useEffect(()=>{if(ontologyGroup&&selectedShapeStatus){if(selectedShapeStatus.shapeType===LandmarkEditType.RECTANGLE){setReference(ontologyGroup.reference||'');}else if(selectedShapeStatus.shapeType===LandmarkEditType.KEYPOINT){const{id}=selectedShapeStatus;const pointCategory=categories.find(v=>id>=v.range[0]&&id<=v.range[1]);setReference((pointCategory===null||pointCategory===void 0?void 0:pointCategory.reference)||'');}setIsPoint(ontologyGroup.type===LandmarkEditType.KEYPOINT);}},[ontologyGroup,selectedShapeStatus,categories]);return/*#__PURE__*/React.createElement(\"div\",{className:\"board-container\"},/*#__PURE__*/React.createElement(\"div\",{className:cx('sample',{unfold:sampleUnfold})},/*#__PURE__*/React.createElement(\"div\",{className:\"sample-label\",onClick:()=>{setSampleUnfold(!sampleUnfold);}},/*#__PURE__*/React.createElement(\"span\",null,\"Sample\"),/*#__PURE__*/React.createElement(\"span\",{className:cx('sample-label-arrow',{unfold:sampleUnfold})},/*#__PURE__*/React.createElement(DownArrow,null))),/*#__PURE__*/React.createElement(\"div\",{className:\"reference-box\",style:{height:sampleUnfold?\"calc(30vh - \".concat(frameControlHeight/3,\"px)\"):0}},reference?/*#__PURE__*/React.createElement(\"img\",{src:reference,className:\"reference\",alt:\"\"}):/*#__PURE__*/React.createElement(Empty,{style:{marginTop:'100px'},description:\"\",image:Empty.PRESENTED_IMAGE_SIMPLE}),/*#__PURE__*/React.createElement(\"p\",{className:\"hint\"},isPoint&&(selectedShapeStatus===null||selectedShapeStatus===void 0?void 0:selectedShapeStatus.id)!==undefined?\"\".concat(formatMessage('IS_DRAWING_POINT'),\":  \").concat(selectedShapeStatus===null||selectedShapeStatus===void 0?void 0:selectedShapeStatus.id):''))),/*#__PURE__*/React.createElement(\"div\",{className:\"mark\"},/*#__PURE__*/React.createElement(\"div\",{className:\"group-label\"},/*#__PURE__*/React.createElement(\"div\",{className:\"left\"},/*#__PURE__*/React.createElement(\"span\",{className:cx('group-icon',{active:drawMode})},isPoint?/*#__PURE__*/React.createElement(KeypointsIcon,null):/*#__PURE__*/React.createElement(RectangleFillIcon,null)),/*#__PURE__*/React.createElement(\"span\",null,ontologyGroup===null||ontologyGroup===void 0?void 0:ontologyGroup.name)),/*#__PURE__*/React.createElement(\"div\",{className:\"right\"},annotated,\"/\",total)),isPoint&&selectedShapeStatus&&/*#__PURE__*/React.createElement(\"div\",{className:\"group-mark\",style:{height:\"calc(60vh - \".concat(frameControlHeight,\"px)\")}},/*#__PURE__*/React.createElement(Sidebar,{categories:categories,selectedShapeStatus:selectedShapeStatus,categoryPathShapes:categoryPathShapes,points:points,selectedPoint:selectedShapeStatus.id,readonly:readonly,groupReviewsMap:instanceReviewsMap===null||instanceReviewsMap===void 0?void 0:(_instanceReviewsMap$s=instanceReviewsMap[selectedShapeStatus.instanceId])===null||_instanceReviewsMap$s===void 0?void 0:_instanceReviewsMap$s[selectedShapeStatus.groupName],setSelectedPoint:setSelectedShape}))));};export default Board;","map":{"version":3,"names":["React","useState","useEffect","cx","Empty","Sidebar","LandmarkEditType","RectangleFillIcon","KeypointsIcon","DownArrow","formatMessage","Board","_ref","_instanceReviewsMap$s","categories","categoryPathShapes","points","selectedShapeStatus","ontologyGroup","annotated","total","drawMode","frameControlHeight","readonly","instanceReviewsMap","setSelectedShape","sampleUnfold","setSampleUnfold","reference","setReference","isPoint","setIsPoint","shapeType","RECTANGLE","KEYPOINT","id","pointCategory","find","v","range","type","createElement","className","unfold","onClick","style","height","concat","src","alt","marginTop","description","image","PRESENTED_IMAGE_SIMPLE","undefined","active","name","selectedPoint","groupReviewsMap","instanceId","groupName","setSelectedPoint"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/keypoint/components/Board.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport cx from 'classnames';\nimport { Empty } from 'antd';\nimport Sidebar from './Sidebar';\nimport { CategoryItem, CategoryPathShape, Point, LandmarkEditType, ShapeInfo } from '../types';\nimport { OntologyChild } from '../store/OntologyStore';\nimport { InstanceReviewsMap, PointReviewResult } from '../store/ReviewsStore';\nimport RectangleFillIcon from '../../common/icons/RectangleFill';\nimport KeypointsIcon from '../../common/icons/Keypoints';\nimport DownArrow from '../../common/icons/DownArrow';\nimport formatMessage from '../locales';\nimport './Board.scss';\n\ninterface Props {\n  categories: CategoryItem[];\n  categoryPathShapes: {[categoryKey: string]: CategoryPathShape};\n  points: {\n    [index: number]: Point;\n  };\n  selectedShapeStatus: ShapeInfo | undefined;\n  ontologyGroup?: OntologyChild;\n  annotated: number | null;\n  total: number | null;\n  drawMode: boolean;\n  frameControlHeight: number;\n  readonly: boolean;\n  instanceReviewsMap?: InstanceReviewsMap;\n  setSelectedShape: (point: number) => void;\n}\n\nconst Board = ({\n  categories = [],\n  categoryPathShapes = {},\n  points = {},\n  selectedShapeStatus,\n  ontologyGroup,\n  annotated,\n  total,\n  drawMode,\n  frameControlHeight,\n  readonly,\n  instanceReviewsMap,\n  setSelectedShape,\n}: Props) => {\n  const [sampleUnfold, setSampleUnfold] = useState(false);\n  const [reference, setReference] = useState<string|undefined>('');\n  const [isPoint, setIsPoint] = useState<boolean>(false);\n  useEffect(() => {\n    if (ontologyGroup && selectedShapeStatus) {\n      if (selectedShapeStatus.shapeType === LandmarkEditType.RECTANGLE) {\n        setReference(ontologyGroup.reference || '');\n      } else if (selectedShapeStatus.shapeType === LandmarkEditType.KEYPOINT) {\n        const { id } = selectedShapeStatus;\n        const pointCategory = categories.find((v) => (id as number) >= v.range[0] && (id as number) <= v.range[1]);\n        setReference(pointCategory?.reference || '');\n      }\n      setIsPoint(ontologyGroup.type === LandmarkEditType.KEYPOINT);\n    }\n  }, [ontologyGroup, selectedShapeStatus, categories]);\n\n  return (\n    <div className=\"board-container\">\n      <div className={cx('sample', { unfold: sampleUnfold })}>\n        <div className=\"sample-label\" onClick={() => { setSampleUnfold(!sampleUnfold); }}>\n          <span>Sample</span>\n          <span className={cx('sample-label-arrow', { unfold: sampleUnfold })}>\n            <DownArrow />\n          </span>\n        </div>\n        <div\n          className=\"reference-box\"\n          style={{\n            height: sampleUnfold ? `calc(30vh - ${frameControlHeight / 3}px)` : 0\n          }}\n        >\n          {reference ? <img src={reference} className=\"reference\" alt=\"\" /> : <Empty style={{ marginTop: '100px' }} description=\"\" image={Empty.PRESENTED_IMAGE_SIMPLE} />}\n          <p className=\"hint\">\n            {\n              isPoint && selectedShapeStatus?.id !== undefined ?\n                `${formatMessage('IS_DRAWING_POINT')}:  ${selectedShapeStatus?.id}` :\n                ''\n            }\n          </p>\n        </div>\n      </div>\n      <div className=\"mark\">\n        <div className=\"group-label\">\n          <div className=\"left\">\n            <span className={cx('group-icon', { active: drawMode })}>\n              {isPoint ? <KeypointsIcon /> : <RectangleFillIcon /> }\n            </span>\n            <span>{ontologyGroup?.name}</span>\n          </div>\n          <div className=\"right\">\n            {annotated}\n            /\n            {total}\n          </div>\n        </div>\n        {isPoint && selectedShapeStatus && (\n          <div\n            className=\"group-mark\"\n            style={{\n              height: `calc(60vh - ${frameControlHeight}px)`\n            }}\n          >\n            <Sidebar\n              categories={categories}\n              selectedShapeStatus={selectedShapeStatus}\n              categoryPathShapes={categoryPathShapes}\n              points={points}\n              selectedPoint={selectedShapeStatus.id as number}\n              readonly={readonly}\n              groupReviewsMap={instanceReviewsMap?.[selectedShapeStatus.instanceId]?.[selectedShapeStatus.groupName] as PointReviewResult | undefined}\n              setSelectedPoint={setSelectedShape}\n            />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Board;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,EAAE,KAAM,YAAY,CAC3B,OAASC,KAAK,KAAQ,MAAM,CAC5B,MAAO,CAAAC,OAAO,KAAM,WAAW,CAC/B,OAAiDC,gBAAgB,KAAmB,UAAU,CAG9F,MAAO,CAAAC,iBAAiB,KAAM,kCAAkC,CAChE,MAAO,CAAAC,aAAa,KAAM,8BAA8B,CACxD,MAAO,CAAAC,SAAS,KAAM,8BAA8B,CACpD,MAAO,CAAAC,aAAa,KAAM,YAAY,CACtC,MAAO,cAAc,CAmBrB,KAAM,CAAAC,KAAK,CAAGC,IAAA,EAaD,KAAAC,qBAAA,IAbE,CACbC,UAAU,CAAG,EAAE,CACfC,kBAAkB,CAAG,CAAC,CAAC,CACvBC,MAAM,CAAG,CAAC,CAAC,CACXC,mBAAmB,CACnBC,aAAa,CACbC,SAAS,CACTC,KAAK,CACLC,QAAQ,CACRC,kBAAkB,CAClBC,QAAQ,CACRC,kBAAkB,CAClBC,gBACK,CAAC,CAAAb,IAAA,CACN,KAAM,CAACc,YAAY,CAAEC,eAAe,CAAC,CAAG1B,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAAC2B,SAAS,CAAEC,YAAY,CAAC,CAAG5B,QAAQ,CAAmB,EAAE,CAAC,CAChE,KAAM,CAAC6B,OAAO,CAAEC,UAAU,CAAC,CAAG9B,QAAQ,CAAU,KAAK,CAAC,CACtDC,SAAS,CAAC,IAAM,CACd,GAAIgB,aAAa,EAAID,mBAAmB,CAAE,CACxC,GAAIA,mBAAmB,CAACe,SAAS,GAAK1B,gBAAgB,CAAC2B,SAAS,CAAE,CAChEJ,YAAY,CAACX,aAAa,CAACU,SAAS,EAAI,EAAE,CAAC,CAC7C,CAAC,IAAM,IAAIX,mBAAmB,CAACe,SAAS,GAAK1B,gBAAgB,CAAC4B,QAAQ,CAAE,CACtE,KAAM,CAAEC,EAAG,CAAC,CAAGlB,mBAAmB,CAClC,KAAM,CAAAmB,aAAa,CAAGtB,UAAU,CAACuB,IAAI,CAAEC,CAAC,EAAMH,EAAE,EAAeG,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAKJ,EAAE,EAAeG,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC1GV,YAAY,CAAC,CAAAO,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAER,SAAS,GAAI,EAAE,CAAC,CAC9C,CACAG,UAAU,CAACb,aAAa,CAACsB,IAAI,GAAKlC,gBAAgB,CAAC4B,QAAQ,CAAC,CAC9D,CACF,CAAC,CAAE,CAAChB,aAAa,CAAED,mBAAmB,CAAEH,UAAU,CAAC,CAAC,CAEpD,mBACEd,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAC,iBAAiB,eAC9B1C,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAEvC,EAAE,CAAC,QAAQ,CAAE,CAAEwC,MAAM,CAAEjB,YAAa,CAAC,CAAE,eACrD1B,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAC,cAAc,CAACE,OAAO,CAAEA,CAAA,GAAM,CAAEjB,eAAe,CAAC,CAACD,YAAY,CAAC,CAAE,CAAE,eAC/E1B,KAAA,CAAAyC,aAAA,aAAM,QAAY,CAAC,cACnBzC,KAAA,CAAAyC,aAAA,SAAMC,SAAS,CAAEvC,EAAE,CAAC,oBAAoB,CAAE,CAAEwC,MAAM,CAAEjB,YAAa,CAAC,CAAE,eAClE1B,KAAA,CAAAyC,aAAA,CAAChC,SAAS,KAAE,CACR,CACH,CAAC,cACNT,KAAA,CAAAyC,aAAA,QACEC,SAAS,CAAC,eAAe,CACzBG,KAAK,CAAE,CACLC,MAAM,CAAEpB,YAAY,gBAAAqB,MAAA,CAAkBzB,kBAAkB,CAAG,CAAC,QAAQ,CACtE,CAAE,EAEDM,SAAS,cAAG5B,KAAA,CAAAyC,aAAA,QAAKO,GAAG,CAAEpB,SAAU,CAACc,SAAS,CAAC,WAAW,CAACO,GAAG,CAAC,EAAE,CAAE,CAAC,cAAGjD,KAAA,CAAAyC,aAAA,CAACrC,KAAK,EAACyC,KAAK,CAAE,CAAEK,SAAS,CAAE,OAAQ,CAAE,CAACC,WAAW,CAAC,EAAE,CAACC,KAAK,CAAEhD,KAAK,CAACiD,sBAAuB,CAAE,CAAC,cAChKrD,KAAA,CAAAyC,aAAA,MAAGC,SAAS,CAAC,MAAM,EAEfZ,OAAO,EAAI,CAAAb,mBAAmB,SAAnBA,mBAAmB,iBAAnBA,mBAAmB,CAAEkB,EAAE,IAAKmB,SAAS,IAAAP,MAAA,CAC3CrC,aAAa,CAAC,kBAAkB,CAAC,QAAAqC,MAAA,CAAM9B,mBAAmB,SAAnBA,mBAAmB,iBAAnBA,mBAAmB,CAAEkB,EAAE,EACjE,EAEH,CACA,CACF,CAAC,cACNnC,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAC,MAAM,eACnB1C,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAC,aAAa,eAC1B1C,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAC,MAAM,eACnB1C,KAAA,CAAAyC,aAAA,SAAMC,SAAS,CAAEvC,EAAE,CAAC,YAAY,CAAE,CAAEoD,MAAM,CAAElC,QAAS,CAAC,CAAE,EACrDS,OAAO,cAAG9B,KAAA,CAAAyC,aAAA,CAACjC,aAAa,KAAE,CAAC,cAAGR,KAAA,CAAAyC,aAAA,CAAClC,iBAAiB,KAAE,CAC/C,CAAC,cACPP,KAAA,CAAAyC,aAAA,aAAOvB,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAEsC,IAAW,CAC9B,CAAC,cACNxD,KAAA,CAAAyC,aAAA,QAAKC,SAAS,CAAC,OAAO,EACnBvB,SAAS,CAAC,GAEX,CAACC,KACE,CACF,CAAC,CACLU,OAAO,EAAIb,mBAAmB,eAC7BjB,KAAA,CAAAyC,aAAA,QACEC,SAAS,CAAC,YAAY,CACtBG,KAAK,CAAE,CACLC,MAAM,gBAAAC,MAAA,CAAiBzB,kBAAkB,OAC3C,CAAE,eAEFtB,KAAA,CAAAyC,aAAA,CAACpC,OAAO,EACNS,UAAU,CAAEA,UAAW,CACvBG,mBAAmB,CAAEA,mBAAoB,CACzCF,kBAAkB,CAAEA,kBAAmB,CACvCC,MAAM,CAAEA,MAAO,CACfyC,aAAa,CAAExC,mBAAmB,CAACkB,EAAa,CAChDZ,QAAQ,CAAEA,QAAS,CACnBmC,eAAe,CAAElC,kBAAkB,SAAlBA,kBAAkB,kBAAAX,qBAAA,CAAlBW,kBAAkB,CAAGP,mBAAmB,CAAC0C,UAAU,CAAC,UAAA9C,qBAAA,iBAApDA,qBAAA,CAAuDI,mBAAmB,CAAC2C,SAAS,CAAmC,CACxIC,gBAAgB,CAAEpC,gBAAiB,CACpC,CACE,CAEJ,CACF,CAAC,CAEV,CAAC,CAED,cAAe,CAAAd,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module"}