{"ast":null,"code":"import React from'react';import cx from'classnames';import{isEqual}from'lodash';import FrameActions from'./FrameActions';import FramesRenderer,{EventAction}from'../../../../libs/FramesRenderer';import{Up,SortAsc}from'../../../common/icons';import formatMessage from'../../locales';import rootStore from'../../store/RootStore';import{getRGBAColor,getInstanceFrames}from'../../utils';import{ReviewResult}from'../../types';import'antd/es/slider/style/index.css';import'./index.scss';const frameLabelHeight=20;const frameLabelColor='#343846';const frameLabelSelectedColor='#292C38';const actionsContainerHeight=48;export default class FrameControl extends React.Component{constructor(){super(...arguments);this.framesRenderer=null;this.framesContainer=React.createRef();this.itemsContainer=React.createRef();this.state={framesCollapsed:true,framesHeight:64,visibleFramesIndex:0,visibleFramesIndexArr:[]};this.changeFrame=(frameIndex,instanceIndex)=>{this.props.setFrame(frameIndex);if(instanceIndex!==undefined&&instanceIndex>-1&&!this.state.framesCollapsed){const selectedInstence=this.props.instances[this.allInstanceIds[instanceIndex]];this.props.selectGroup(selectedInstence.id,selectedInstence.children[0].name);}};this.updateHeight=height=>{this.setState({framesHeight:height});this.props.onHeightChange(height+actionsContainerHeight);};this.updateVisibleFrames=(currentIndex,indexArr)=>{this.setState(stat=>({...stat,visibleFramesIndex:currentIndex,...(indexArr&&{visibleFramesIndexArr:indexArr})}));};this.updateItemsScroll=top=>{if(this.itemsContainer.current){this.itemsContainer.current.scroll({top});}};this.onItemsScroll=e=>{if(this.framesRenderer){this.framesRenderer.itemsOffset=e.target.scrollTop;}};this.toggleCollapse=()=>{if(!this.isEmpty){this.setState(stat=>({framesCollapsed:!stat.framesCollapsed}),()=>{// update renderer\nif(this.framesRenderer){this.framesRenderer.scrollable=!this.state.framesCollapsed;this.framesRenderer.items=this.getItems();}});}};}get isEmpty(){const{categoryInstancesMap}=this.props;return Object.values(categoryInstancesMap).every(categoryInstances=>Object.keys(categoryInstances).length===0);}get allInstanceIds(){const{categoryInstancesMap,instances}=this.props;const categories=Object.keys(categoryInstancesMap);return Object.values(categoryInstancesMap).flatMap(categoryInstances=>Object.keys(categoryInstances)).sort((a,b)=>{var _instanceA$children$,_instanceB$children$;const instanceA=instances[a];const instanceB=instances[b];const instanceAFirstFrame=Number(Object.keys(instanceA===null||instanceA===void 0?void 0:(_instanceA$children$=instanceA.children[0])===null||_instanceA$children$===void 0?void 0:_instanceA$children$.frames)[0]||0);const instanceBFirstFrame=Number(Object.keys(instanceB===null||instanceB===void 0?void 0:(_instanceB$children$=instanceB.children[0])===null||_instanceB$children$===void 0?void 0:_instanceB$children$.frames)[0]||0);if(instanceAFirstFrame>instanceBFirstFrame){return 1;}if(instanceAFirstFrame<instanceBFirstFrame){return-1;}const instanceACategoryIndex=categories.indexOf((instanceA===null||instanceA===void 0?void 0:instanceA.category)||'');const instanceBCategoryIndex=categories.indexOf((instanceB===null||instanceB===void 0?void 0:instanceB.category)||'');if(instanceACategoryIndex>instanceBCategoryIndex){return 1;}if(instanceACategoryIndex<instanceBCategoryIndex){return-1;}return((instanceA===null||instanceA===void 0?void 0:instanceA.number)||0)>((instanceB===null||instanceB===void 0?void 0:instanceB.number)||0)?1:-1;});}componentDidMount(){if(this.framesContainer.current){this.framesRenderer=new FramesRenderer(this.framesContainer.current,this.props.frames.length);this.framesRenderer.on(EventAction.HEIGHT_CHANGE,this.updateHeight);this.framesRenderer.on(EventAction.VISIBLE_FRAMES_UPDATE,this.updateVisibleFrames);this.framesRenderer.on(EventAction.CURRENT_FRAME_CHANGE,this.changeFrame);this.framesRenderer.on(EventAction.ITEMS_OFFSET_CHANGE,this.updateItemsScroll);this.framesRenderer.items=this.getItems();this.framesRenderer.invalidFrames=this.props.frames.filter(v=>v.valid===false).map(v=>v.index);}}componentDidUpdate(prevProps){var _prevProps$selectedIn,_this$props$selectedI;if(prevProps.currentFrame!==this.props.currentFrame){// current frame changes\nif(this.framesRenderer){this.framesRenderer.currentFrame=this.props.currentFrame;}}if(!isEqual(prevProps.instances,this.props.instances)||!isEqual(prevProps.instancesReviewsMap,this.props.instancesReviewsMap)){// selected instance frame status changes\nif(this.framesRenderer){this.framesRenderer.items=this.getItems();}}else if(((_prevProps$selectedIn=prevProps.selectedInstance)===null||_prevProps$selectedIn===void 0?void 0:_prevProps$selectedIn.id)!==((_this$props$selectedI=this.props.selectedInstance)===null||_this$props$selectedI===void 0?void 0:_this$props$selectedI.id)){// selected instance changes, or instances changes\nif(this.framesRenderer){this.framesRenderer.items=this.getItems();}}if(!isEqual(prevProps.frames,this.props.frames)&&this.framesRenderer){this.framesRenderer.invalidFrames=this.props.frames.filter(v=>v.valid===false).map(v=>v.index);}}componentWillUnmount(){if(this.framesRenderer){this.framesRenderer.removeEventListeners();this.framesRenderer.off(EventAction.HEIGHT_CHANGE,this.updateHeight);this.framesRenderer.off(EventAction.VISIBLE_FRAMES_UPDATE,this.updateVisibleFrames);this.framesRenderer.off(EventAction.CURRENT_FRAME_CHANGE,this.changeFrame);this.framesRenderer.off(EventAction.ITEMS_OFFSET_CHANGE,this.updateItemsScroll);}}getItems(){const{selectedInstance,instancesReviewsMap,instances}=this.props;const frameColor={};if(selectedInstance){const instanceReviewsMap=instancesReviewsMap[selectedInstance.id];if(instanceReviewsMap){Object.keys(instanceReviewsMap).forEach(f=>{var _instanceReviewsMap$f;const frameIndex=Number(f);const reviewResult=(_instanceReviewsMap$f=instanceReviewsMap[frameIndex])===null||_instanceReviewsMap$f===void 0?void 0:_instanceReviewsMap$f.result;if(reviewResult===ReviewResult.APPROVE){frameColor[frameIndex]='#3E6F45';}else if(reviewResult===ReviewResult.REJECT){frameColor[frameIndex]='#9C4434';}else if(reviewResult===ReviewResult.SUSPEND){frameColor[frameIndex]='#A28900';}});}}if(this.state.framesCollapsed){const frameStatus=getInstanceFrames(selectedInstance);if(selectedInstance){return{[selectedInstance.id]:{frameStatus,frameColor,color:getRGBAColor(selectedInstance.displayColor),showCards:true,selected:true}};}return{global:{frameStatus,color:'#5C5F6B',showCards:true,selected:true}};}const items={};this.allInstanceIds.forEach(instanceId=>{const instance=instances[instanceId];items[instanceId]={frameStatus:{},color:getRGBAColor(instance===null||instance===void 0?void 0:instance.displayColor)};});Object.values(instances).forEach(instance=>{if(instance){items[instance.id].frameStatus=getInstanceFrames(instance);}});if(selectedInstance){items[selectedInstance.id].frameColor=frameColor;items[selectedInstance.id].showCards=true;items[selectedInstance.id].selected=true;}return items;}renderItemLabels(){const{instances,selectedInstance,selectGroup}=this.props;const{framesCollapsed}=this.state;if(framesCollapsed){const ontologyItem=rootStore.ontology.getOntologyInfo((selectedInstance===null||selectedInstance===void 0?void 0:selectedInstance.category)||'');let isReject=false;let isPending=false;let isApproved=false;if(selectedInstance){const allFrameReviews=Object.values(this.props.instancesReviewsMap[selectedInstance.id]||{});if(allFrameReviews.length>0){isReject=allFrameReviews.some(i=>i.result===ReviewResult.REJECT);if(!isReject){isPending=allFrameReviews.some(i=>i.result===ReviewResult.SUSPEND);}if(!isPending){isApproved=allFrameReviews.length===this.props.frames.length&&allFrameReviews.every(i=>i.result===ReviewResult.APPROVE);}}}return/*#__PURE__*/React.createElement(\"div\",{className:\"frame-item-label\",style:{height:frameLabelHeight,background:framesCollapsed?frameLabelSelectedColor:frameLabelColor}},selectedInstance?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"frame-item-label-dot\",style:{backgroundColor:getRGBAColor(ontologyItem===null||ontologyItem===void 0?void 0:ontologyItem.display_color,1)}}),(ontologyItem===null||ontologyItem===void 0?void 0:ontologyItem.display_name)||(ontologyItem===null||ontologyItem===void 0?void 0:ontologyItem.class_name),selectedInstance.number),(isApproved||isReject||isPending)&&/*#__PURE__*/React.createElement(\"div\",{className:cx('frame-item-label-review',{approved:isApproved,rejected:isReject,pending:isPending})})):formatMessage('PROGRESS_GLOBAL_LABEL'));}return/*#__PURE__*/React.createElement(React.Fragment,null,this.allInstanceIds.map(instanceId=>{const instance=instances[instanceId];const selected=selectedInstance&&selectedInstance.id===instanceId;const ontologyItem=rootStore.ontology.getOntologyInfo((instance===null||instance===void 0?void 0:instance.category)||'');const allFrameReviews=Object.values(this.props.instancesReviewsMap[instanceId]||{});const isReject=allFrameReviews.some(i=>i.result===ReviewResult.REJECT);let isPending=false;let isApproved=false;if(allFrameReviews.length>0){if(!isReject){isPending=allFrameReviews.some(i=>i.result===ReviewResult.SUSPEND);}if(!isPending){isApproved=allFrameReviews.every(i=>i.result===ReviewResult.APPROVE);}}return instance?/*#__PURE__*/React.createElement(\"div\",{key:instanceId,className:\"frame-item-label\",style:{height:frameLabelHeight,background:selected?frameLabelSelectedColor:frameLabelColor},onClick:()=>selectGroup(instanceId,instance.children[0].name)},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"frame-item-label-dot\",style:{backgroundColor:getRGBAColor(instance.displayColor,1)}}),(ontologyItem===null||ontologyItem===void 0?void 0:ontologyItem.display_name)||(ontologyItem===null||ontologyItem===void 0?void 0:ontologyItem.class_name),instance===null||instance===void 0?void 0:instance.number),(isApproved||isReject||isPending)&&/*#__PURE__*/React.createElement(\"div\",{className:cx('frame-item-label-review',{approved:isApproved,rejected:isReject,pending:isPending})})):null;}));}render(){var _frames$currentFrame;const{frames,frameLoading,currentFrame}=this.props;const{framesCollapsed,framesHeight}=this.state;return/*#__PURE__*/React.createElement(\"div\",{className:\"frame-control\",style:{height:framesHeight+actionsContainerHeight,transition:'height 0.15s'}},/*#__PURE__*/React.createElement(\"div\",{className:\"frame-actions\"},/*#__PURE__*/React.createElement(\"div\",{className:\"frame-items-sort\"},/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(SortAsc,null)),formatMessage('PROGRESS_SORT_LABEL')),/*#__PURE__*/React.createElement(FrameActions,{currentFrameValid:((_frames$currentFrame=frames[currentFrame])===null||_frames$currentFrame===void 0?void 0:_frames$currentFrame.valid)!==false,frameCount:frames.length,frameLoading:frameLoading,currentFrame:currentFrame,setFrame:this.changeFrame}),/*#__PURE__*/React.createElement(\"div\",{className:cx('frame-collapse',{disabled:this.isEmpty,transform:!framesCollapsed}),onClick:this.toggleCollapse},/*#__PURE__*/React.createElement(Up,null))),/*#__PURE__*/React.createElement(\"div\",{className:\"frames\"},/*#__PURE__*/React.createElement(\"div\",{className:\"frame-items-container\"},/*#__PURE__*/React.createElement(\"div\",{ref:this.itemsContainer,className:\"frame-items\",style:{height:framesHeight-44},onScroll:this.onItemsScroll},this.renderItemLabels())),/*#__PURE__*/React.createElement(\"div\",{className:\"frame-steps\"},/*#__PURE__*/React.createElement(\"div\",{ref:this.framesContainer}))));}}","map":{"version":3,"names":["React","cx","isEqual","FrameActions","FramesRenderer","EventAction","Up","SortAsc","formatMessage","rootStore","getRGBAColor","getInstanceFrames","ReviewResult","frameLabelHeight","frameLabelColor","frameLabelSelectedColor","actionsContainerHeight","FrameControl","Component","constructor","arguments","framesRenderer","framesContainer","createRef","itemsContainer","state","framesCollapsed","framesHeight","visibleFramesIndex","visibleFramesIndexArr","changeFrame","frameIndex","instanceIndex","props","setFrame","undefined","selectedInstence","instances","allInstanceIds","selectGroup","id","children","name","updateHeight","height","setState","onHeightChange","updateVisibleFrames","currentIndex","indexArr","stat","updateItemsScroll","top","current","scroll","onItemsScroll","e","itemsOffset","target","scrollTop","toggleCollapse","isEmpty","scrollable","items","getItems","categoryInstancesMap","Object","values","every","categoryInstances","keys","length","categories","flatMap","sort","a","b","_instanceA$children$","_instanceB$children$","instanceA","instanceB","instanceAFirstFrame","Number","frames","instanceBFirstFrame","instanceACategoryIndex","indexOf","category","instanceBCategoryIndex","number","componentDidMount","on","HEIGHT_CHANGE","VISIBLE_FRAMES_UPDATE","CURRENT_FRAME_CHANGE","ITEMS_OFFSET_CHANGE","invalidFrames","filter","v","valid","map","index","componentDidUpdate","prevProps","_prevProps$selectedIn","_this$props$selectedI","currentFrame","instancesReviewsMap","selectedInstance","componentWillUnmount","removeEventListeners","off","frameColor","instanceReviewsMap","forEach","f","_instanceReviewsMap$f","reviewResult","result","APPROVE","REJECT","SUSPEND","frameStatus","color","displayColor","showCards","selected","global","instanceId","instance","renderItemLabels","ontologyItem","ontology","getOntologyInfo","isReject","isPending","isApproved","allFrameReviews","some","i","createElement","className","style","background","Fragment","backgroundColor","display_color","display_name","class_name","approved","rejected","pending","key","onClick","render","_frames$currentFrame","frameLoading","transition","currentFrameValid","frameCount","disabled","transform","ref","onScroll"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/keypoint/components/FrameContorl/index.tsx"],"sourcesContent":["import React from 'react';\nimport cx from 'classnames';\nimport { isEqual } from 'lodash';\nimport FrameActions from './FrameActions';\nimport FramesRenderer, { FrameItem, EventAction } from '../../../../libs/FramesRenderer';\nimport { Up, SortAsc } from '../../../common/icons';\nimport formatMessage from '../../locales';\nimport rootStore from '../../store/RootStore';\nimport { getRGBAColor, getInstanceFrames } from '../../utils';\nimport { InstanceAct, CategoryInstancesMap, ReviewResult, Image } from '../../types';\nimport { InstancesReviewsMap } from '../../index';\nimport 'antd/es/slider/style/index.css';\nimport './index.scss';\n\ninterface FrameControlProps {\n  frames: Image[];\n  frameLoading: boolean;\n  currentFrame: number;\n  categoryInstancesMap: CategoryInstancesMap;\n  instances: {[id: string] :InstanceAct};\n  selectedInstance: InstanceAct | undefined;\n  selectedInstanceGroup: string;\n  instancesReviewsMap: InstancesReviewsMap;\n  selectGroup: (instanceId: string, name: string) => void;\n  setFrame: (frame: number) => void;\n  onHeightChange: (height: number) => void;\n}\n\ninterface FrameControlState {\n  framesCollapsed: boolean;\n  framesHeight: number;\n  visibleFramesIndex: number;\n  visibleFramesIndexArr: number[];\n}\n\nconst frameLabelHeight = 20;\nconst frameLabelColor = '#343846';\nconst frameLabelSelectedColor = '#292C38';\nconst actionsContainerHeight = 48;\n\nexport default class FrameControl extends React.Component<FrameControlProps, FrameControlState> {\n  framesRenderer: FramesRenderer | null = null;\n\n  framesContainer = React.createRef<HTMLDivElement>();\n\n  itemsContainer = React.createRef<HTMLDivElement>();\n\n  state = {\n    framesCollapsed: true,\n    framesHeight: 64,\n    visibleFramesIndex: 0,\n    visibleFramesIndexArr: [],\n  };\n\n  get isEmpty() {\n    const { categoryInstancesMap } = this.props;\n    return Object.values(categoryInstancesMap).every((categoryInstances) => Object.keys(categoryInstances).length === 0);\n  }\n\n  get allInstanceIds() {\n    const { categoryInstancesMap, instances } = this.props;\n    const categories = Object.keys(categoryInstancesMap);\n    return Object.values(categoryInstancesMap)\n      .flatMap((categoryInstances) => Object.keys(categoryInstances))\n      .sort((a, b) => {\n        const instanceA = instances[a];\n        const instanceB = instances[b];\n        const instanceAFirstFrame = Number(Object.keys(instanceA?.children[0]?.frames)[0] || 0);\n        const instanceBFirstFrame = Number(Object.keys(instanceB?.children[0]?.frames)[0] || 0);\n        if (instanceAFirstFrame > instanceBFirstFrame) {\n          return 1;\n        }\n        if (instanceAFirstFrame < instanceBFirstFrame) {\n          return -1;\n        }\n        const instanceACategoryIndex = categories.indexOf(instanceA?.category || '');\n        const instanceBCategoryIndex = categories.indexOf(instanceB?.category || '');\n        if (instanceACategoryIndex > instanceBCategoryIndex) {\n          return 1;\n        }\n        if (instanceACategoryIndex < instanceBCategoryIndex) {\n          return -1;\n        }\n        return (instanceA?.number || 0) > (instanceB?.number || 0) ? 1 : -1;\n      });\n  }\n\n  componentDidMount() {\n    if (this.framesContainer.current) {\n      this.framesRenderer = new FramesRenderer(this.framesContainer.current, this.props.frames.length);\n      this.framesRenderer.on(EventAction.HEIGHT_CHANGE, this.updateHeight);\n      this.framesRenderer.on(EventAction.VISIBLE_FRAMES_UPDATE, this.updateVisibleFrames);\n      this.framesRenderer.on(EventAction.CURRENT_FRAME_CHANGE, this.changeFrame);\n      this.framesRenderer.on(EventAction.ITEMS_OFFSET_CHANGE, this.updateItemsScroll);\n      this.framesRenderer.items = this.getItems();\n      this.framesRenderer.invalidFrames = this.props.frames.filter((v) => v.valid === false).map((v) => v.index);\n    }\n  }\n\n  componentDidUpdate(prevProps: FrameControlProps) {\n    if (prevProps.currentFrame !== this.props.currentFrame) {\n      // current frame changes\n      if (this.framesRenderer) {\n        this.framesRenderer.currentFrame = this.props.currentFrame;\n      }\n    }\n    if (!isEqual(prevProps.instances, this.props.instances) || !isEqual(prevProps.instancesReviewsMap, this.props.instancesReviewsMap)) {\n      // selected instance frame status changes\n      if (this.framesRenderer) {\n        this.framesRenderer.items = this.getItems();\n      }\n    } else if (prevProps.selectedInstance?.id !== this.props.selectedInstance?.id) {\n      // selected instance changes, or instances changes\n      if (this.framesRenderer) {\n        this.framesRenderer.items = this.getItems();\n      }\n    }\n\n    if (!isEqual(prevProps.frames, this.props.frames) && this.framesRenderer) {\n      this.framesRenderer.invalidFrames = this.props.frames.filter((v) => v.valid === false).map((v) => v.index);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.framesRenderer) {\n      this.framesRenderer.removeEventListeners();\n      this.framesRenderer.off(EventAction.HEIGHT_CHANGE, this.updateHeight);\n      this.framesRenderer.off(EventAction.VISIBLE_FRAMES_UPDATE, this.updateVisibleFrames);\n      this.framesRenderer.off(EventAction.CURRENT_FRAME_CHANGE, this.changeFrame);\n      this.framesRenderer.off(EventAction.ITEMS_OFFSET_CHANGE, this.updateItemsScroll);\n    }\n  }\n\n  changeFrame = (frameIndex: number, instanceIndex?: number) => {\n    this.props.setFrame(frameIndex);\n    if (instanceIndex !== undefined && instanceIndex > -1 && !this.state.framesCollapsed) {\n      const selectedInstence = this.props.instances[this.allInstanceIds[instanceIndex]];\n      this.props.selectGroup(selectedInstence.id, selectedInstence.children[0].name);\n    }\n  };\n\n  getItems(): { [id: string]: FrameItem } {\n    const { selectedInstance, instancesReviewsMap, instances } = this.props;\n    const frameColor: { [frameIndex: number]: string } = {};\n    if (selectedInstance) {\n      const instanceReviewsMap = instancesReviewsMap[selectedInstance.id];\n      if (instanceReviewsMap) {\n        Object.keys(instanceReviewsMap).forEach((f) => {\n          const frameIndex = Number(f);\n          const reviewResult = instanceReviewsMap[frameIndex]?.result;\n          if (reviewResult === ReviewResult.APPROVE) {\n            frameColor[frameIndex] = '#3E6F45';\n          } else if (reviewResult === ReviewResult.REJECT) {\n            frameColor[frameIndex] = '#9C4434';\n          } else if (reviewResult === ReviewResult.SUSPEND) {\n            frameColor[frameIndex] = '#A28900';\n          }\n        });\n      }\n    }\n\n    if (this.state.framesCollapsed) {\n      const frameStatus = getInstanceFrames(selectedInstance);\n      if (selectedInstance) {\n        return {\n          [selectedInstance.id]: {\n            frameStatus,\n            frameColor,\n            color: getRGBAColor(selectedInstance.displayColor),\n            showCards: true,\n            selected: true,\n          },\n        };\n      }\n      return {\n        global: {\n          frameStatus,\n          color: '#5C5F6B',\n          showCards: true,\n          selected: true,\n        },\n      };\n    }\n\n    const items: { [id: string]: FrameItem } = {};\n    this.allInstanceIds.forEach((instanceId) => {\n      const instance = instances[instanceId];\n      items[instanceId] = {\n        frameStatus: {},\n        color: getRGBAColor(instance?.displayColor),\n      };\n    });\n    Object.values(instances).forEach((instance) => {\n      if (instance) {\n        items[instance.id].frameStatus = getInstanceFrames(instance);\n      }\n    });\n    if (selectedInstance) {\n      items[selectedInstance.id].frameColor = frameColor;\n      items[selectedInstance.id].showCards = true;\n      items[selectedInstance.id].selected = true;\n    }\n    return items;\n  }\n\n  updateHeight = (height: number) => {\n    this.setState({ framesHeight: height });\n    this.props.onHeightChange(height + actionsContainerHeight);\n  };\n\n  updateVisibleFrames = (currentIndex: number, indexArr?: number[]) => {\n    this.setState((stat) => ({\n      ...stat,\n      visibleFramesIndex: currentIndex,\n      ...indexArr && { visibleFramesIndexArr: indexArr },\n    }));\n  };\n\n  updateItemsScroll = (top: number) => {\n    if (this.itemsContainer.current) {\n      this.itemsContainer.current.scroll({ top });\n    }\n  };\n\n  onItemsScroll: React.UIEventHandler<HTMLDivElement> = (e) => {\n    if (this.framesRenderer) {\n      this.framesRenderer.itemsOffset = (e.target as HTMLDivElement).scrollTop;\n    }\n  };\n\n  toggleCollapse = () => {\n    if (!this.isEmpty) {\n      this.setState((stat) => ({\n        framesCollapsed: !stat.framesCollapsed,\n      }), () => {\n        // update renderer\n        if (this.framesRenderer) {\n          this.framesRenderer.scrollable = !this.state.framesCollapsed;\n          this.framesRenderer.items = this.getItems();\n        }\n      });\n    }\n  };\n\n  renderItemLabels() {\n    const { instances, selectedInstance, selectGroup } = this.props;\n    const { framesCollapsed } = this.state;\n    if (framesCollapsed) {\n      const ontologyItem = rootStore.ontology.getOntologyInfo(selectedInstance?.category || '');\n      let isReject = false;\n      let isPending = false;\n      let isApproved = false;\n      if (selectedInstance) {\n        const allFrameReviews = Object.values(this.props.instancesReviewsMap[selectedInstance.id] || {});\n        if (allFrameReviews.length > 0) {\n          isReject = allFrameReviews.some((i) => i.result === ReviewResult.REJECT);\n          if (!isReject) {\n            isPending = allFrameReviews.some((i) => i.result === ReviewResult.SUSPEND);\n          }\n          if (!isPending) {\n            isApproved = allFrameReviews.length === this.props.frames.length && allFrameReviews.every((i) => i.result === ReviewResult.APPROVE);\n          }\n        }\n      }\n      return (\n        <div\n          className=\"frame-item-label\"\n          style={{\n            height: frameLabelHeight,\n            background: framesCollapsed ? frameLabelSelectedColor : frameLabelColor,\n          }}\n        >\n          {selectedInstance ? (\n            <>\n              <div>\n                <div\n                  className=\"frame-item-label-dot\"\n                  style={{ backgroundColor: getRGBAColor(ontologyItem?.display_color, 1) }}\n                />\n                { ontologyItem?.display_name || ontologyItem?.class_name }\n                { selectedInstance.number }\n              </div>\n              {(isApproved || isReject || isPending) && (\n                <div\n                  className={cx('frame-item-label-review', {\n                    approved: isApproved,\n                    rejected: isReject,\n                    pending: isPending,\n                  })}\n                />\n              )}\n            </>\n          ) : formatMessage('PROGRESS_GLOBAL_LABEL')}\n        </div>\n      );\n    }\n\n    return (\n      <>\n        {this.allInstanceIds.map((instanceId) => {\n          const instance = instances[instanceId];\n          const selected = selectedInstance && selectedInstance.id === instanceId;\n          const ontologyItem = rootStore.ontology.getOntologyInfo(instance?.category || '');\n          const allFrameReviews = Object.values(this.props.instancesReviewsMap[instanceId] || {});\n          const isReject = allFrameReviews.some((i) => i.result === ReviewResult.REJECT);\n          let isPending = false;\n          let isApproved = false;\n          if (allFrameReviews.length > 0) {\n            if (!isReject) {\n              isPending = allFrameReviews.some((i) => i.result === ReviewResult.SUSPEND);\n            }\n            if (!isPending) {\n              isApproved = allFrameReviews.every((i) => i.result === ReviewResult.APPROVE);\n            }\n          }\n\n          return instance ? (\n            <div\n              key={instanceId}\n              className=\"frame-item-label\"\n              style={{\n                height: frameLabelHeight,\n                background: selected ? frameLabelSelectedColor : frameLabelColor,\n              }}\n              onClick={() => selectGroup(instanceId, instance.children[0].name)}\n            >\n              <div>\n                <div\n                  className=\"frame-item-label-dot\"\n                  style={{ backgroundColor: getRGBAColor(instance.displayColor, 1) }}\n                />\n                { ontologyItem?.display_name || ontologyItem?.class_name }\n                { instance?.number }\n              </div>\n              {(isApproved || isReject || isPending) && (\n                <div\n                  className={cx('frame-item-label-review', {\n                    approved: isApproved,\n                    rejected: isReject,\n                    pending: isPending,\n                  })}\n                />\n              )}\n            </div>\n          ) : null;\n        })}\n      </>\n    );\n  }\n\n  render() {\n    const { frames, frameLoading, currentFrame } = this.props;\n    const { framesCollapsed, framesHeight } = this.state;\n    return (\n      <div\n        className=\"frame-control\"\n        style={{\n          height: framesHeight + actionsContainerHeight,\n          transition: 'height 0.15s',\n        }}\n      >\n        <div className=\"frame-actions\">\n          <div className=\"frame-items-sort\">\n            <span><SortAsc /></span>\n            {formatMessage('PROGRESS_SORT_LABEL')}\n          </div>\n          <FrameActions\n            currentFrameValid={frames[currentFrame]?.valid !== false}\n            frameCount={frames.length}\n            frameLoading={frameLoading}\n            currentFrame={currentFrame}\n            setFrame={this.changeFrame}\n          />\n          <div\n            className={cx('frame-collapse', {\n              disabled: this.isEmpty,\n              transform: !framesCollapsed,\n            })}\n            onClick={this.toggleCollapse}\n          >\n            <Up />\n          </div>\n        </div>\n        <div className=\"frames\">\n          <div className=\"frame-items-container\">\n            <div\n              ref={this.itemsContainer}\n              className=\"frame-items\"\n              style={{ height: framesHeight - 44 }}\n              onScroll={this.onItemsScroll}\n            >\n              {this.renderItemLabels()}\n            </div>\n          </div>\n          <div className=\"frame-steps\">\n            <div ref={this.framesContainer} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}