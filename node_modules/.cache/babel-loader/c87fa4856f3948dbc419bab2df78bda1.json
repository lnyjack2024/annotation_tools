{"ast":null,"code":"/* eslint-disable jsx-a11y/label-has-associated-control */ /* eslint-disable no-nested-ternary */import React from'react';import{Card,Radio,Cascader,Button,Tag,Input}from'antd';import{formatTime,simpleClone,parseTime}from'./util';import AdvertisementNameSelect from'./AdvertisementNameSelect';import{getDeltaTime}from'./AnnotationCanvas';import'./index.scss';import{isAnnotationReadonly}from'../../utils/tool-mode';export const MIN_SEGMENT_LENGTH=0.1;export const UNDEFINED_COLOR='#dddddd';export const FOCUS_COLOR='#f5f5f5';export const FPS=20;class AnnotationForm extends React.Component{constructor(){super();this.state={tempOption:null,historySelect:[],currentFocus:null,currentFocusValue:'',currentTimestampType:null};this.snapshotPlaceholder=null;}handleSelectChange(e,type,key){const{results,currentMode,currentIndex,canvas,advertisementNameMap}=this.props;const{historySelect}=this.state;const resultsCopy=simpleClone(results);const item=this.getResult(resultsCopy,key);const hisotryCopy=simpleClone(historySelect);// let currStorage;\nswitch(type){case'name':{this.setState({tempOption:null});if(currentMode!=='edit')break;if(!advertisementNameMap.has(e)){break;//this.props.addAdvertisementName(e);\n}item.name=e;// resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\nthis.props.handleResultsChange(resultsCopy);const eIndex=hisotryCopy.indexOf(e);if(eIndex!==-1)hisotryCopy.splice(hisotryCopy.indexOf(e),1);if(hisotryCopy.length===5)hisotryCopy.pop();hisotryCopy.unshift(e);this.setState({historySelect:hisotryCopy});break;}case'type':if(currentMode!=='edit')break;item.type=e;this.props.handleResultsChange(resultsCopy);break;default:break;}}handleSelectBlur(){this.setState({tempOption:null});}handleSelectSearch(e){this.setState({tempOption:e});}handleTimestampFocus(e,key,type){window.disableAdvertisementHotKeys=true;this.setState({currentFocus:key,currentTimestampType:type,currentFocusValue:e.target.value});}getResult(results,key){return results.find(r=>r.key===key);}async handleTimestampBlur(e,key,type){const{results,canvas,toolMode}=this.props;if(isAnnotationReadonly(toolMode))return;const resultsCopy=simpleClone(results);const item=this.getResult(resultsCopy,key);let start=item===null||item===void 0?void 0:item.start;let end=item===null||item===void 0?void 0:item.end;let startChanged=false;let endChanged=false;if(type==='start'){const newStart=parseTime(e.target.value);if(newStart&&(!end||newStart<end)){start=newStart;startChanged=true;}}else if(type==='end'){const newEnd=parseTime(e.target.value);if(newEnd&&(!start||newEnd>start)){end=newEnd;endChanged=true;}}if(startChanged||endChanged){this.pauseVideo();if(startChanged){canvas.video.currentTime=start;}else if(endChanged){canvas.video.currentTime=end;}item.start=start;item.end=end;this.props.handleResultsChange(resultsCopy);}this.setState({currentFocus:null,currentTimestampType:null,currentFocusValue:''});window.disableAdvertisementHotKeys=false;}getMaxKey(results){const keys=(results||[]).map(r=>r.key);const maxKey=keys.reduce((a,b)=>Math.max(a,b),0);return maxKey;}async handleButtonClick(e,type,key){e.stopPropagation();e.preventDefault();const{results,currentTime,canvas,currentMode,toolMode,setCurrentIndex,currentIndex}=this.props;if(isAnnotationReadonly(toolMode))return;const resultsCopy=simpleClone(results)||[];const item=this.getResult(resultsCopy,key);const maxKey=this.getMaxKey(resultsCopy);switch(type){case'delete':if(currentMode==='edit'){// resultsCopy.splice(index, 1);\nfor(let i=0;i<resultsCopy.length;i+=1){if(resultsCopy[i].key===key){resultsCopy.splice(i,1);break;}}this.pauseVideo();this.props.setCurrentIndex();}else{this.props.disableSVG();item.position=null;// resultsCopy[index].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\nsetCurrentIndex(null);}this.props.handleResultsChange(resultsCopy);break;case'add':if(currentMode!=='edit')break;const newKey=maxKey+1;resultsCopy.push({key:newKey,name:undefined,type:[],position:[],start:null,end:null,qaState:'unchecked',qaComment:null,qaReason:null});this.pauseVideo();this.props.handleResultsChange(resultsCopy).then(()=>{this.props.setCurrentIndex(newKey);});break;case'currentStart':if(currentMode!=='edit')break;if(item.end!=null&&item.end<=currentTime+MIN_SEGMENT_LENGTH)break;if(currentTime==null)break;if(item.start!==currentTime){item.start=currentTime;this.pauseVideo();const imageUrl=await this.props.canvas.generateImageUrl(currentTime);item.snapshot=imageUrl;this.props.handleResultsChange(resultsCopy);}break;case'currentEnd':if(currentMode!=='edit')break;if(currentTime==null)break;if(item.start!=null&&item.start>=currentTime-MIN_SEGMENT_LENGTH)break;item.end=currentTime;this.props.handleResultsChange(resultsCopy);this.pauseVideo();break;case'removeStart':if(currentMode!=='edit')break;if(currentTime==null)break;item.start=null;item.snapshot=null;this.props.handleResultsChange(resultsCopy);break;case'removeEnd':if(currentMode!=='edit')break;if(currentTime==null)break;item.end=null;this.props.handleResultsChange(resultsCopy);break;case'paint':if(currentMode==='edit'){this.props.enableSVG(item.key);this.pauseVideo();}else{// resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\nthis.props.handleResultsChange(resultsCopy);this.props.disableSVG();}break;case'copy':{const newItem=JSON.parse(JSON.stringify(item));newItem.key=this.getMaxKey(results)+1;newItem.position=[];resultsCopy.push(newItem);this.props.handleResultsChange(resultsCopy).then(resolve=>{this.pauseVideo();this.props.enableSVG(newItem.key);});break;}default:break;}}handleCardClick(e,key){this.props.setCurrentIndex(key);}pauseVideo(){const{canvas}=this.props;if(canvas&&canvas.video)canvas.video.pause();}render(){const{tempOption,historySelect}=this.state;const{results,advertisementName,advertisementType,currentTime,currentMode,currentIndex,canvas,currentPlayBackRate,advertisementNameMap,toolMode}=this.props;const currentItem=this.getResult(results,currentIndex);return/*#__PURE__*/React.createElement(\"div\",{className:\"annotation-form-wrapper\"},/*#__PURE__*/React.createElement(Card,{className:\"annotation-form-card\"},/*#__PURE__*/React.createElement(Card,{className:\"video-currentTime\",size:\"small\"},formatTime(currentTime)),/*#__PURE__*/React.createElement(Radio.Group,{className:\"video-playBackRate\",onChange:e=>this.props.setCurrentPlayBackRate(e.target.value),defaultValue:1},/*#__PURE__*/React.createElement(Radio.Button,{value:0.25},\"X0.25\"),/*#__PURE__*/React.createElement(Radio.Button,{value:0.5},\"X0.5\"),/*#__PURE__*/React.createElement(Radio.Button,{value:1},\"X1\"),/*#__PURE__*/React.createElement(Radio.Button,{value:2},\"X2\"),/*#__PURE__*/React.createElement(Radio.Button,{value:4},\"X4\")),/*#__PURE__*/React.createElement(Button,{className:\"annotation-form-button\",onClick:e=>this.handleButtonClick(e,'add'),type:\"primary\",block:true,disabled:isAnnotationReadonly(toolMode)},\"\\u65B0\\u589E\\u6807\\u6CE8\")),/*#__PURE__*/React.createElement(\"div\",{className:\"annotation-form-container\"},results.reduceRight((arr,item,index)=>{var _item$type,_item$position;arr.push(item.start==null||item.end==null||item.start<=currentTime+getDeltaTime(currentPlayBackRate)&&item.end>=currentTime-getDeltaTime(currentPlayBackRate)?/*#__PURE__*/React.createElement(Card// eslint-disable-next-line react/no-array-index-key\n,{key:item.key,className:\"annotation-form-card annotation-form-card-\".concat(item.key),style:{border:currentIndex===item.key?'1px solid #1890ff':null},onClick:e=>this.handleCardClick(e,item.key)},/*#__PURE__*/React.createElement(\"div\",{className:\"advertisement-attribute-wrapper\"},/*#__PURE__*/React.createElement(\"label\",{className:\"advertisement-attribute-label\"},\"\\u8BC6\\u522B\\u7ED3\\u679C\"),/*#__PURE__*/React.createElement(AdvertisementNameSelect,{index:item.key,historySelect:historySelect,handleSelectChange:this.handleSelectChange.bind(this),handleSelectSearch:this.handleSelectSearch.bind(this),handleSelectBlur:this.handleSelectBlur.bind(this),item:item,advertisementName:advertisementName,advertisementNameMap:advertisementNameMap,tempOption:tempOption,disabled:isAnnotationReadonly(toolMode)})),/*#__PURE__*/React.createElement(\"div\",{className:\"advertisement-attribute-wrapper\"},/*#__PURE__*/React.createElement(\"label\",{className:\"advertisement-attribute-label\"},\"\\u5E7F\\u544A\\u5F62\\u5F0F\"),/*#__PURE__*/React.createElement(Cascader,{showSearch:true,className:\"advertisement-attribute-select\",options:advertisementType,placeholder:\"\\u9009\\u62E9\\u5E7F\\u544A\\u5F62\\u5F0F\",onChange:e=>this.handleSelectChange(e,'type',item.key),defaultValue:item.type,getPopupContainer:()=>document.getElementById('root'),disabled:isAnnotationReadonly(toolMode),onFocus:()=>window.disableAdvertisementHotKeys=true,onBlur:()=>window.disableAdvertisementHotKeys=false})),/*#__PURE__*/React.createElement(\"div\",{className:\"advertisement-attribute-wrapper\"},/*#__PURE__*/React.createElement(\"label\",{className:\"advertisement-attribute-label\"},\"\\u5F00\\u59CB\\u65F6\\u95F4\"),/*#__PURE__*/React.createElement(\"input\",{disabled:isAnnotationReadonly(toolMode),className:\"advertisement-timestamp\",value:this.state.currentFocus===item.key&&this.state.currentTimestampType==='start'?this.state.currentFocusValue:formatTime(item.start),onFocus:e=>this.handleTimestampFocus(e,item.key,'start'),onBlur:e=>this.handleTimestampBlur(e,item.key,'start'),onChange:e=>{this.setState({currentFocusValue:e.target.value});}}),/*#__PURE__*/React.createElement(Button,{className:\"advertisement-timestamp-reset\",onClick:e=>this.handleButtonClick(e,'currentStart',item.key),disabled:isAnnotationReadonly(toolMode)},\"\\u221A\"),/*#__PURE__*/React.createElement(Button,{className:\"advertisement-timestamp-reset\",onClick:e=>this.handleButtonClick(e,'removeStart',item.key),disabled:isAnnotationReadonly(toolMode)},\"x\")),/*#__PURE__*/React.createElement(\"div\",{className:\"advertisement-attribute-wrapper\"},/*#__PURE__*/React.createElement(\"label\",{className:\"advertisement-attribute-label\"},\"\\u7ED3\\u675F\\u65F6\\u95F4\"),/*#__PURE__*/React.createElement(\"input\",{/*readOnly*/disabled:isAnnotationReadonly(toolMode),className:\"advertisement-timestamp\"/*value={formatTime(item.end)}*/,value:this.state.currentFocus===item.key&&this.state.currentTimestampType==='end'?this.state.currentFocusValue:formatTime(item.end),onFocus:e=>this.handleTimestampFocus(e,item.key,'end'),onBlur:e=>this.handleTimestampBlur(e,item.key,'end'),onChange:e=>{this.setState({currentFocusValue:e.target.value});}}),/*#__PURE__*/React.createElement(Button,{className:\"advertisement-timestamp-reset\",onClick:e=>this.handleButtonClick(e,'currentEnd',item.key),disabled:isAnnotationReadonly(toolMode)},\"\\u221A\"),/*#__PURE__*/React.createElement(Button,{className:\"advertisement-timestamp-reset\",onClick:e=>this.handleButtonClick(e,'removeEnd',item.key),disabled:isAnnotationReadonly(toolMode)},\"x\")),/*#__PURE__*/React.createElement(\"div\",{className:\"advertisement-attribute-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"advertisement-index\"},item.name==null||!((_item$type=item.type)===null||_item$type===void 0?void 0:_item$type.length)||item.end==null||item.start==null||!((_item$position=item.position)===null||_item$position===void 0?void 0:_item$position.length)?/*#__PURE__*/React.createElement(Tag,{style:{backgroundColor:\"\".concat(UNDEFINED_COLOR,\"40\"),borderColor:UNDEFINED_COLOR}},\"ID: \".concat(item.key,\"\\u672A\\u5B8C\\u6210\")):item.qaState==='unchecked'?/*#__PURE__*/React.createElement(Tag,{color:\"gold\"},\"ID: \".concat(item.key,\"\\u5F85\\u8D28\\u68C0\")):item.qaState==='accepted'?/*#__PURE__*/React.createElement(Tag,{color:\"green\"},\"ID: \".concat(item.key,\"\\u5DF2\\u901A\\u8FC7\")):/*#__PURE__*/React.createElement(Tag,{color:\"red\"},\"ID: \".concat(item.key,\"\\u88AB\\u9A73\\u56DE\"))),/*#__PURE__*/React.createElement(Button,{className:\"annotation-form-button-right\",onClick:e=>this.handleButtonClick(e,'delete',item.key),disabled:isAnnotationReadonly(toolMode)},\"\\u5220\\u9664\"),/*#__PURE__*/React.createElement(Button,{className:\"annotation-form-button-right\",onClick:e=>this.handleButtonClick(e,'copy',item.key),disabled:isAnnotationReadonly(toolMode)},\"\\u590D\\u5236\"),/*#__PURE__*/React.createElement(Button,{className:\"annotation-form-button-right\",onClick:e=>this.handleButtonClick(e,'paint',item.key),disabled:isAnnotationReadonly(toolMode)},\"\\u6807\\u8BB0\\u4F4D\\u7F6E\"))):null);return arr;},[]),currentMode!=='edit'&&currentIndex!=null&&(currentItem===null||currentItem===void 0?void 0:currentItem.position)!=null?/*#__PURE__*/React.createElement(\"div\",{className:\"annotation-form-buttons-float\",style:{left:\"\".concat((Math.max(currentItem===null||currentItem===void 0?void 0:currentItem.position[0],currentItem===null||currentItem===void 0?void 0:currentItem.position[2])*(canvas?canvas.width:0)||-5)+(canvas?canvas.container.offsetLeft:0)+5,\"px\"),top:\"\".concat((Math.max(currentItem===null||currentItem===void 0?void 0:currentItem.position[1],currentItem===null||currentItem===void 0?void 0:currentItem.position[3])*(canvas?canvas.height:0)||60)+(canvas?canvas.container.offsetTop:0)-60,\"px\")}},/*#__PURE__*/React.createElement(Button,{className:\"annotation-form-button-float\",onClick:e=>this.handleButtonClick(e,'paint',currentIndex),size:\"small\"},currentMode==='edit'?'标记位置':'确定'),/*#__PURE__*/React.createElement(Button,{className:\"annotation-form-button-float\",onClick:e=>this.handleButtonClick(e,'copy',currentIndex),size:\"small\"},\"\\u590D\\u5236\")):null));}}export default AnnotationForm;","map":{"version":3,"names":["React","Card","Radio","Cascader","Button","Tag","Input","formatTime","simpleClone","parseTime","AdvertisementNameSelect","getDeltaTime","isAnnotationReadonly","MIN_SEGMENT_LENGTH","UNDEFINED_COLOR","FOCUS_COLOR","FPS","AnnotationForm","Component","constructor","state","tempOption","historySelect","currentFocus","currentFocusValue","currentTimestampType","snapshotPlaceholder","handleSelectChange","e","type","key","results","currentMode","currentIndex","canvas","advertisementNameMap","props","resultsCopy","item","getResult","hisotryCopy","setState","has","name","handleResultsChange","eIndex","indexOf","splice","length","pop","unshift","handleSelectBlur","handleSelectSearch","handleTimestampFocus","window","disableAdvertisementHotKeys","target","value","find","r","handleTimestampBlur","toolMode","start","end","startChanged","endChanged","newStart","newEnd","pauseVideo","video","currentTime","getMaxKey","keys","map","maxKey","reduce","a","b","Math","max","handleButtonClick","stopPropagation","preventDefault","setCurrentIndex","i","disableSVG","position","newKey","push","undefined","qaState","qaComment","qaReason","then","imageUrl","generateImageUrl","snapshot","enableSVG","newItem","JSON","parse","stringify","resolve","handleCardClick","pause","render","advertisementName","advertisementType","currentPlayBackRate","currentItem","createElement","className","size","Group","onChange","setCurrentPlayBackRate","defaultValue","onClick","block","disabled","reduceRight","arr","index","_item$type","_item$position","concat","style","border","bind","showSearch","options","placeholder","getPopupContainer","document","getElementById","onFocus","onBlur","backgroundColor","borderColor","color","left","width","container","offsetLeft","top","height","offsetTop"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/advertisement-annotation/AnnotationForm.jsx"],"sourcesContent":["/* eslint-disable jsx-a11y/label-has-associated-control */\n/* eslint-disable no-nested-ternary */\nimport React from 'react';\nimport {Card, Radio, Cascader, Button, Tag, Input} from 'antd';\nimport { formatTime, simpleClone, parseTime } from './util';\nimport AdvertisementNameSelect from './AdvertisementNameSelect';\nimport { getDeltaTime } from './AnnotationCanvas';\nimport './index.scss';\nimport { isAnnotationReadonly } from '../../utils/tool-mode';\n\nexport const MIN_SEGMENT_LENGTH = 0.1;\nexport const UNDEFINED_COLOR = '#dddddd';\nexport const FOCUS_COLOR = '#f5f5f5';\nexport const FPS = 20;\n\nclass AnnotationForm extends React.Component {\n  constructor() {\n    super();\n    this.state = ({\n      tempOption: null,\n      historySelect: [],\n      currentFocus: null,\n      currentFocusValue: '',\n      currentTimestampType: null,\n    });\n    this.snapshotPlaceholder = null;\n  }\n\n  handleSelectChange(e, type, key) {\n    const { results, currentMode, currentIndex, canvas, advertisementNameMap } = this.props;\n    const { historySelect } = this.state;\n    const resultsCopy = simpleClone(results);\n    const item = this.getResult(resultsCopy, key);\n    const hisotryCopy = simpleClone(historySelect);\n    // let currStorage;\n    switch (type) {\n      case 'name': {\n        this.setState({ tempOption: null });\n        if (currentMode !== 'edit') break;\n        if (!advertisementNameMap.has(e)) {\n          break;\n          //this.props.addAdvertisementName(e);\n        }\n        item.name = e;\n        // resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n        this.props.handleResultsChange(resultsCopy);\n\n        const eIndex = hisotryCopy.indexOf(e);\n        if (eIndex !== -1) hisotryCopy.splice(hisotryCopy.indexOf(e), 1);\n        if (hisotryCopy.length === 5) hisotryCopy.pop();\n        hisotryCopy.unshift(e);\n        this.setState({\n          historySelect: hisotryCopy,\n        });\n        break;\n      }\n      case 'type':\n        if (currentMode !== 'edit') break;\n        item.type = e;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      default:\n        break;\n    }\n  }\n\n  handleSelectBlur() {\n    this.setState({ tempOption: null });\n  }\n\n  handleSelectSearch(e) {\n    this.setState({ tempOption: e });\n  }\n\n  handleTimestampFocus(e, key, type) {\n    window.disableAdvertisementHotKeys = true;\n    this.setState({ currentFocus: key, currentTimestampType: type, currentFocusValue: e.target.value });\n  }\n\n  getResult(results, key) {\n    return results.find(r => r.key === key);\n  }\n\n  async handleTimestampBlur(e, key, type) {\n    const { results, canvas, toolMode } = this.props;\n    if (isAnnotationReadonly(toolMode)) return;\n    const resultsCopy = simpleClone(results);\n    const item = this.getResult(resultsCopy, key);\n    let start = item?.start;\n    let end = item?.end;\n    let startChanged = false;\n    let endChanged = false;\n    if (type === 'start') {\n      const newStart = parseTime(e.target.value);\n      if (newStart && (!end || newStart < end)) {\n        start = newStart;\n        startChanged = true;\n      }\n    } else if (type === 'end') {\n      const newEnd = parseTime(e.target.value);\n      if (newEnd && (!start || newEnd > start)) {\n        end = newEnd;\n        endChanged = true;\n      }\n    }\n    if (startChanged || endChanged) {\n      this.pauseVideo();\n      if (startChanged) {\n        canvas.video.currentTime = start;\n      } else if (endChanged) {\n        canvas.video.currentTime = end;\n      }\n      item.start = start;\n      item.end = end;\n      this.props.handleResultsChange(resultsCopy);\n    }\n    this.setState({ currentFocus: null, currentTimestampType: null, currentFocusValue: '' });\n    window.disableAdvertisementHotKeys = false;\n  }\n\n  getMaxKey(results) {\n    const keys = (results || []).map(r => r.key);\n    const maxKey = keys.reduce((a, b) => Math.max(a, b), 0);\n    return maxKey;\n  }\n\n  async handleButtonClick(e, type, key) {\n    e.stopPropagation();\n    e.preventDefault();\n    const { results, currentTime, canvas, currentMode, toolMode, setCurrentIndex, currentIndex } = this.props;\n    if (isAnnotationReadonly(toolMode)) return;\n    const resultsCopy = simpleClone(results) || [];\n    const item = this.getResult(resultsCopy, key);\n    const maxKey = this.getMaxKey(resultsCopy);\n    switch (type) {\n      case 'delete':\n        if (currentMode === 'edit') {\n          // resultsCopy.splice(index, 1);\n          for (let i = 0; i < resultsCopy.length; i += 1) {\n            if (resultsCopy[i].key === key)  {\n              resultsCopy.splice(i, 1);\n              break;\n            }\n          }\n          this.pauseVideo();\n          this.props.setCurrentIndex();\n        } else {\n          this.props.disableSVG();\n          item.position = null;\n          // resultsCopy[index].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          setCurrentIndex(null);\n        }\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'add':\n        if (currentMode !== 'edit') break;\n        const newKey = maxKey + 1;\n        resultsCopy.push({\n          key: newKey,\n          name: undefined,\n          type: [],\n          position: [],\n          start: null,\n          end: null,\n          qaState: 'unchecked',\n          qaComment: null,\n          qaReason: null,\n        });\n        this.pauseVideo();\n        this.props.handleResultsChange(resultsCopy).then(() => {\n          this.props.setCurrentIndex(newKey);\n        });\n        break;\n      case 'currentStart':\n        if (currentMode !== 'edit') break;\n        if (item.end != null && item.end <= currentTime + MIN_SEGMENT_LENGTH) break;\n        if (currentTime == null) break;\n        if (item.start !== currentTime) {\n          item.start = currentTime;\n          this.pauseVideo();\n          const imageUrl = await this.props.canvas.generateImageUrl(currentTime);\n          item.snapshot = imageUrl;\n          this.props.handleResultsChange(resultsCopy);\n        }\n        break;\n      case 'currentEnd':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        if (item.start != null && item.start >= currentTime - MIN_SEGMENT_LENGTH) break;\n        item.end = currentTime;\n        this.props.handleResultsChange(resultsCopy);\n        this.pauseVideo();\n        break;\n      case 'removeStart':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        item.start = null;\n        item.snapshot = null;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'removeEnd':\n        if (currentMode !== 'edit') break;\n        if (currentTime == null) break;\n        item.end = null;\n        this.props.handleResultsChange(resultsCopy);\n        break;\n      case 'paint':\n        if (currentMode === 'edit') {\n          this.props.enableSVG(item.key);\n          this.pauseVideo();\n        } else {\n          // resultsCopy[currentIndex].snapshot = canvas.genSnapshot(currentIndex, resultsCopy);\n          this.props.handleResultsChange(resultsCopy);\n          this.props.disableSVG();\n        }\n        break;\n      case 'copy': {\n        const newItem = JSON.parse(JSON.stringify(item));\n        newItem.key = this.getMaxKey(results) + 1;\n        newItem.position = [];\n        resultsCopy.push(newItem);\n        this.props.handleResultsChange(resultsCopy).then((resolve) => {\n          this.pauseVideo();\n          this.props.enableSVG(newItem.key);\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  handleCardClick(e, key) {\n    this.props.setCurrentIndex(key);\n  }\n\n  pauseVideo() {\n    const { canvas } = this.props;\n    if (canvas && canvas.video) canvas.video.pause();\n  }\n\n  render() {\n    const { tempOption, historySelect } = this.state;\n    const {\n      results,\n      advertisementName,\n      advertisementType,\n      currentTime,\n      currentMode,\n      currentIndex,\n      canvas,\n      currentPlayBackRate,\n      advertisementNameMap,\n      toolMode,\n    } = this.props;\n    const currentItem = this.getResult(results, currentIndex);\n    return (\n      <div className=\"annotation-form-wrapper\">\n        <Card className=\"annotation-form-card\">\n          <Card className=\"video-currentTime\" size=\"small\">\n            {formatTime(currentTime)}\n          </Card>\n          <Radio.Group\n            className=\"video-playBackRate\"\n            onChange={(e) => this.props.setCurrentPlayBackRate(e.target.value)}\n            defaultValue={1}\n          >\n            <Radio.Button value={0.25}>\n              X0.25\n            </Radio.Button>\n            <Radio.Button value={0.5}>\n              X0.5\n            </Radio.Button>\n            <Radio.Button value={1}>\n              X1\n            </Radio.Button>\n            <Radio.Button value={2}>\n              X2\n            </Radio.Button>\n            <Radio.Button value={4}>\n              X4\n            </Radio.Button>\n          </Radio.Group>\n          <Button\n            className=\"annotation-form-button\"\n            onClick={(e) => this.handleButtonClick(e, 'add')}\n            type=\"primary\"\n            block\n            disabled={isAnnotationReadonly(toolMode)}\n          >\n            新增标注\n          </Button>\n        </Card>\n        <div className=\"annotation-form-container\">\n          {results.reduceRight((arr, item, index) => {\n            arr.push(\n              ((item.start == null || item.end == null) || (item.start <= currentTime + getDeltaTime(currentPlayBackRate) && item.end >= currentTime - getDeltaTime(currentPlayBackRate)))\n                ? (\n                  <Card\n                    // eslint-disable-next-line react/no-array-index-key\n                    key={item.key}\n                    className={`annotation-form-card annotation-form-card-${item.key}`}\n                    style={{ border: currentIndex === item.key ? '1px solid #1890ff' : null }}\n                    onClick={(e) => this.handleCardClick(e, item.key)}\n                  >\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        识别结果\n                      </label>\n                      <AdvertisementNameSelect\n                        index={item.key}\n                        historySelect={historySelect}\n                        handleSelectChange={this.handleSelectChange.bind(this)}\n                        handleSelectSearch={this.handleSelectSearch.bind(this)}\n                        handleSelectBlur={this.handleSelectBlur.bind(this)}\n                        item={item}\n                        advertisementName={advertisementName}\n                        advertisementNameMap={advertisementNameMap}\n                        tempOption={tempOption}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      />\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        广告形式\n                      </label>\n                      <Cascader\n                        showSearch\n                        className=\"advertisement-attribute-select\"\n                        options={advertisementType}\n                        placeholder=\"选择广告形式\"\n                        onChange={(e) => this.handleSelectChange(e, 'type', item.key)}\n                        defaultValue={item.type}\n                        getPopupContainer={() => document.getElementById('root')}\n                        disabled={isAnnotationReadonly(toolMode)}\n                        onFocus={() => window.disableAdvertisementHotKeys = true}\n                        onBlur={() => window.disableAdvertisementHotKeys = false}\n                      />\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        开始时间\n                      </label>\n                      <input\n                        disabled={isAnnotationReadonly(toolMode)}\n                        className=\"advertisement-timestamp\"\n                        value={ this.state.currentFocus === item.key && this.state.currentTimestampType === 'start' ? this.state.currentFocusValue : formatTime(item.start)}\n                        onFocus={ (e) => this.handleTimestampFocus(e, item.key, 'start') }\n                        onBlur={ (e) => this.handleTimestampBlur(e, item.key, 'start') }\n                        onChange={(e) => { this.setState({currentFocusValue: e.target.value})}}\n                      />\n                      {/*<input\n                        readOnly\n                        className=\"advertisement-timestamp\"\n                        value={formatTime(item.start)}\n                        onChange={(e) => {\n                          console.log('start time', e.target.value, formatTime(e.target.value));\n                          item.start = 123;\n                        }}\n                      />*/}\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'currentStart', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        √\n                      </Button>\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'removeStart', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        x\n                      </Button>\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <label className=\"advertisement-attribute-label\">\n                        结束时间\n                      </label>\n                      <input\n                        /*readOnly*/\n                        disabled={isAnnotationReadonly(toolMode)}\n                        className=\"advertisement-timestamp\"\n                        /*value={formatTime(item.end)}*/\n                        value={ this.state.currentFocus === item.key && this.state.currentTimestampType === 'end' ? this.state.currentFocusValue : formatTime(item.end)}\n                        onFocus={ (e) => this.handleTimestampFocus(e, item.key, 'end') }\n                        onBlur={ (e) => this.handleTimestampBlur(e, item.key, 'end') }\n                        onChange={(e) => { this.setState({currentFocusValue: e.target.value})}}\n                      />\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'currentEnd', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        √\n                      </Button>\n                      <Button\n                        className=\"advertisement-timestamp-reset\"\n                        onClick={(e) => this.handleButtonClick(e, 'removeEnd', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        x\n                      </Button>\n                    </div>\n                    <div className=\"advertisement-attribute-wrapper\">\n                      <div className=\"advertisement-index\">\n                        {(item.name == null || !item.type?.length || item.end == null || item.start == null || !item.position?.length)\n                          ? (\n                            <Tag style={{ backgroundColor: `${UNDEFINED_COLOR}40`, borderColor: UNDEFINED_COLOR }}>\n                              {`ID: ${item.key}未完成`}\n                            </Tag>\n                          )\n                          : (item.qaState === 'unchecked')\n                            ? (\n                              <Tag color=\"gold\">\n                                {`ID: ${item.key}待质检`}\n                              </Tag>\n                            )\n                            : (item.qaState === 'accepted')\n                              ? <Tag color=\"green\">{`ID: ${item.key}已通过`}</Tag>\n                              : <Tag color=\"red\">{`ID: ${item.key}被驳回`}</Tag>}\n                      </div>\n                      <Button\n                        className=\"annotation-form-button-right\"\n                        onClick={(e) => this.handleButtonClick(e, 'delete', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        删除\n                      </Button>\n                      <Button\n                        className=\"annotation-form-button-right\"\n                        onClick={(e) => this.handleButtonClick(e, 'copy', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        复制\n                      </Button>\n                      <Button\n                        className=\"annotation-form-button-right\"\n                        onClick={(e) => this.handleButtonClick(e, 'paint', item.key)}\n                        disabled={isAnnotationReadonly(toolMode)}\n                      >\n                        标记位置\n                      </Button>\n                    </div>\n                  </Card>\n                )\n                : null\n            );\n            return arr;\n          }, [])}\n          {\n            currentMode !== 'edit' && currentIndex != null && currentItem?.position != null\n              ? (\n                <div\n                  className=\"annotation-form-buttons-float\"\n                  style={{\n                    left: `${(Math.max(currentItem?.position[0], currentItem?.position[2]) * (canvas ? canvas.width : 0) || -5) + (canvas ? canvas.container.offsetLeft : 0) + 5}px`,\n                    top: `${(Math.max(currentItem?.position[1], currentItem?.position[3]) * (canvas ? canvas.height : 0) || 60) + (canvas ? canvas.container.offsetTop : 0) - 60}px`,\n                  }}\n                >\n                  <Button\n                    className=\"annotation-form-button-float\"\n                    onClick={(e) => this.handleButtonClick(e, 'paint', currentIndex)}\n                    size=\"small\"\n                  >\n                    {currentMode === 'edit' ? '标记位置' : '确定'}\n                  </Button>\n                  <Button\n                    className=\"annotation-form-button-float\"\n                    onClick={(e) => this.handleButtonClick(e, 'copy', currentIndex)}\n                    size=\"small\"\n                  >\n                    复制\n                  </Button>\n                  {/*<Button\n                    className=\"annotation-form-button-float\"\n                    onClick={(e) => this.handleButtonClick(e, 'delete', currentIndex)}\n                    size=\"small\"\n                  >\n                    删除\n                  </Button>*/}\n                </div>\n              )\n              : null\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AnnotationForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}