{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{observer}from'mobx-react';import{DownOutlined}from'@ant-design/icons';import SidebarCategory from'./SidebarCategory';import store from'../../store/RootStore';import i18n from'../../locales';const InstancePanel=observer(()=>{const scroller=useRef(null);const[activeCategories,setActiveCategories]=useState([]);useEffect(()=>{setActiveCategories([store.ontology.selectedCategoryName]);},[store.ontology.selectedCategoryName]);const toggleCollapse=()=>{if(activeCategories.length>0){// collapse all\nsetActiveCategories([]);}else{const{categories}=store.ontology;const firstCategory=categories[0];if(firstCategory){setActiveCategories([firstCategory.className]);if(categories.length>1){// delay to set state to update layout\ncategories.slice(1).forEach(c=>{setTimeout(()=>{setActiveCategories(cs=>[...cs,c.className]);},0);});}}}};const allCollapsed=activeCategories.length===0;return/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexDirection:'column',height:'100%'}},/*#__PURE__*/React.createElement(\"div\",{className:\"collapse-all\",onClick:toggleCollapse},/*#__PURE__*/React.createElement(\"span\",{style:{fontSize:12,paddingRight:4}},i18n.translate(allCollapsed?'SIDEBAR_EXPAND_ALL':'SIDEBAR_COLLAPSE_ALL')),/*#__PURE__*/React.createElement(DownOutlined,{style:{transform:allCollapsed?'rotate(-90deg)':'',transition:'transform 0.2s'}})),/*#__PURE__*/React.createElement(\"div\",{ref:scroller,className:\"scroller\",style:{flex:1}},store.ontology.categories.map(category=>/*#__PURE__*/React.createElement(SidebarCategory,{key:category.className,category:category,collapsed:!activeCategories.includes(category.className),onCollapseChange:collapsed=>{const{className}=category;setActiveCategories(currActiveCategories=>{if(collapsed){const newActiveCategories=[...currActiveCategories];const index=newActiveCategories.indexOf(className);if(index>=0){newActiveCategories.splice(index,1);}return newActiveCategories;}return[...currActiveCategories,className];});}}))));});export default InstancePanel;","map":{"version":3,"names":["React","useState","useEffect","useRef","observer","DownOutlined","SidebarCategory","store","i18n","InstancePanel","scroller","activeCategories","setActiveCategories","ontology","selectedCategoryName","toggleCollapse","length","categories","firstCategory","className","slice","forEach","c","setTimeout","cs","allCollapsed","createElement","style","display","flexDirection","height","onClick","fontSize","paddingRight","translate","transform","transition","ref","flex","map","category","key","collapsed","includes","onCollapseChange","currActiveCategories","newActiveCategories","index","indexOf","splice"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/InstancePanel.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { observer } from 'mobx-react';\nimport { DownOutlined } from '@ant-design/icons';\nimport SidebarCategory from './SidebarCategory';\nimport store from '../../store/RootStore';\nimport i18n from '../../locales';\n\nconst InstancePanel = observer(() => {\n  const scroller = useRef<HTMLDivElement>(null);\n  const [activeCategories, setActiveCategories] = useState<string[]>([]);\n\n  useEffect(() => {\n    setActiveCategories([store.ontology.selectedCategoryName]);\n  }, [store.ontology.selectedCategoryName]);\n\n  const toggleCollapse = () => {\n    if (activeCategories.length > 0) {\n      // collapse all\n      setActiveCategories([]);\n    } else {\n      const { categories } = store.ontology;\n      const firstCategory = categories[0];\n      if (firstCategory) {\n        setActiveCategories([firstCategory.className]);\n        if (categories.length > 1) {\n          // delay to set state to update layout\n          categories.slice(1).forEach((c) => {\n            setTimeout(() => {\n              setActiveCategories((cs) => [...cs, c.className]);\n            }, 0);\n          });\n        }\n      }\n    }\n  };\n\n  const allCollapsed = activeCategories.length === 0;\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        height: '100%',\n      }}\n    >\n      <div className=\"collapse-all\" onClick={toggleCollapse}>\n        <span style={{ fontSize: 12, paddingRight: 4 }}>\n          {i18n.translate(allCollapsed ? 'SIDEBAR_EXPAND_ALL' : 'SIDEBAR_COLLAPSE_ALL')}\n        </span>\n        <DownOutlined\n          style={{\n            transform: allCollapsed ? 'rotate(-90deg)' : '',\n            transition: 'transform 0.2s',\n          }}\n        />\n      </div>\n      <div ref={scroller} className=\"scroller\" style={{ flex: 1 }}>\n        {store.ontology.categories.map((category) => (\n          <SidebarCategory\n            key={category.className}\n            category={category}\n            collapsed={!activeCategories.includes(category.className)}\n            onCollapseChange={(collapsed) => {\n              const { className } = category;\n              setActiveCategories((currActiveCategories) => {\n                if (collapsed) {\n                  const newActiveCategories = [...currActiveCategories];\n                  const index = newActiveCategories.indexOf(className);\n                  if (index >= 0) {\n                    newActiveCategories.splice(index, 1);\n                  }\n                  return newActiveCategories;\n                }\n                return [...currActiveCategories, className];\n              });\n            }}\n          />\n        ))}\n      </div>\n    </div>\n  );\n});\n\nexport default InstancePanel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}