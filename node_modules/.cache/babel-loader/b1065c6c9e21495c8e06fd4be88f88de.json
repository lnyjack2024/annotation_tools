{"ast":null,"code":"import React,{useState}from'react';import{observer}from'mobx-react';import cx from'classnames';import{CaretDownOutlined,PlusCircleFilled}from'@ant-design/icons';import CameraInstanceItemList from'./CameraInstanceItemList';import InstanceItemMenu from'./InstanceItemMenu';import InstanceItemReviewIcon from'./InstanceItemReviewIcon';import ShapeLabel from'./ShapeLabel';import store from'../../store/RootStore';const SidebarInstance=observer(_ref=>{let{instance}=_ref;const[hovered,setHovered]=useState(false);const[menuVisible,setMenuVisible]=useState(false);const[menuPosition,setMenuPosition]=useState({x:-1,y:-1});const collapse=e=>{e.stopPropagation();instance.setCollapsed(!instance.collapsed);};const{currentCamera,currentFrame,isSingleCamera,cameraNames}=store.frame;const isSingle=instance.isSingle&&isSingleCamera;const isHidden=instance.frameStatus[currentFrame]===undefined;const isSelected=isSingle?instance.selected:instance.selected&&store.instance.selectedInstanceItems.filter(item=>item.instance).length<=0;return/*#__PURE__*/React.createElement(\"div\",{id:\"sidebar-category-instance-\".concat(instance.id),className:\"sidebar-category-instance\",onMouseEnter:()=>setHovered(true),onMouseLeave:()=>setHovered(false)},/*#__PURE__*/React.createElement(\"div\",{className:cx('sidebar-category-instance__label',{single:isSingle,hidden:isHidden,selected:isSelected}),onMouseDown:()=>{if(!isSingle){store.instance.selectInstanceItem(null);}store.instance.selectInstance(instance,true);},onContextMenu:e=>{e.preventDefault();store.instance.selectInstance(instance);if(isSingle&&!isHidden){setMenuPosition({x:e.clientX,y:e.clientY});setMenuVisible(true);}}},isSingle?/*#__PURE__*/React.createElement(ShapeLabel,{item:Object.values(instance.items)[0],camera:currentCamera,label:instance.label}):/*#__PURE__*/React.createElement(\"div\",null,instance.label),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-category-action\"},!isSingle&&/*#__PURE__*/React.createElement(CaretDownOutlined,{className:\"sidebar-category-icon\",style:{transform:instance.collapsed?'rotate(270deg)':''},onClick:collapse}),!store.readonly&&isSingle&&isHidden&&hovered&&/*#__PURE__*/React.createElement(PlusCircleFilled,{style:{cursor:'pointer'},onClick:()=>store.addToCurrentFrame(Object.values(instance.items)[0])}),!store.isLabeling&&isSingle&&!isHidden&&/*#__PURE__*/React.createElement(InstanceItemReviewIcon,{item:Object.values(instance.items)[0],camera:currentCamera}))),!instance.collapsed&&!isSingle&&/*#__PURE__*/React.createElement(\"div\",null,cameraNames.map((c,i)=>/*#__PURE__*/React.createElement(CameraInstanceItemList,{key:c,instance:instance,camera:c,cameraIndex:i}))),isSingle&&/*#__PURE__*/React.createElement(InstanceItemMenu,{instanceItem:Object.values(instance.items)[0],camera:currentCamera,position:menuPosition,visible:menuVisible,onClose:()=>setMenuVisible(false)}));});export default SidebarInstance;","map":{"version":3,"names":["React","useState","observer","cx","CaretDownOutlined","PlusCircleFilled","CameraInstanceItemList","InstanceItemMenu","InstanceItemReviewIcon","ShapeLabel","store","SidebarInstance","_ref","instance","hovered","setHovered","menuVisible","setMenuVisible","menuPosition","setMenuPosition","x","y","collapse","e","stopPropagation","setCollapsed","collapsed","currentCamera","currentFrame","isSingleCamera","cameraNames","frame","isSingle","isHidden","frameStatus","undefined","isSelected","selected","selectedInstanceItems","filter","item","length","createElement","id","concat","className","onMouseEnter","onMouseLeave","single","hidden","onMouseDown","selectInstanceItem","selectInstance","onContextMenu","preventDefault","clientX","clientY","Object","values","items","camera","label","style","transform","onClick","readonly","cursor","addToCurrentFrame","isLabeling","map","c","i","key","cameraIndex","instanceItem","position","visible","onClose"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/SidebarInstance.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport cx from 'classnames';\nimport { CaretDownOutlined, PlusCircleFilled } from '@ant-design/icons';\nimport CameraInstanceItemList from './CameraInstanceItemList';\nimport InstanceItemMenu from './InstanceItemMenu';\nimport InstanceItemReviewIcon from './InstanceItemReviewIcon';\nimport ShapeLabel from './ShapeLabel';\nimport Instance from '../../model/Instance';\nimport store from '../../store/RootStore';\n\ninterface SidebarInstanceProps {\n  instance: Instance;\n}\n\nconst SidebarInstance = observer(({ instance }: SidebarInstanceProps) => {\n  const [hovered, setHovered] = useState(false);\n  const [menuVisible, setMenuVisible] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({ x: -1, y: -1 });\n\n  const collapse = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    instance.setCollapsed(!instance.collapsed);\n  };\n\n  const { currentCamera, currentFrame, isSingleCamera, cameraNames } = store.frame;\n  const isSingle = instance.isSingle && isSingleCamera;\n  const isHidden = instance.frameStatus[currentFrame] === undefined;\n  const isSelected = isSingle ? instance.selected : instance.selected && store.instance.selectedInstanceItems.filter((item) => item.instance).length <= 0;\n  return (\n    <div\n      id={`sidebar-category-instance-${instance.id}`}\n      className=\"sidebar-category-instance\"\n      onMouseEnter={() => setHovered(true)}\n      onMouseLeave={() => setHovered(false)}\n    >\n      <div\n        className={cx('sidebar-category-instance__label', {\n          single: isSingle,\n          hidden: isHidden,\n          selected: isSelected,\n        })}\n        onMouseDown={() => {\n          if (!isSingle) {\n            store.instance.selectInstanceItem(null);\n          }\n          store.instance.selectInstance(instance, true);\n        }}\n        onContextMenu={(e) => {\n          e.preventDefault();\n          store.instance.selectInstance(instance);\n          if (isSingle && !isHidden) {\n            setMenuPosition({ x: e.clientX, y: e.clientY });\n            setMenuVisible(true);\n          }\n        }}\n      >\n        {isSingle ? (\n          <ShapeLabel item={Object.values(instance.items)[0]} camera={currentCamera} label={instance.label} />\n        ) : <div>{instance.label}</div>}\n        <div className=\"sidebar-category-action\">\n          {!isSingle && (\n            <CaretDownOutlined\n              className=\"sidebar-category-icon\"\n              style={{\n                transform: instance.collapsed ? 'rotate(270deg)' : '',\n              }}\n              onClick={collapse}\n            />\n          )}\n          {!store.readonly && isSingle && isHidden && hovered && (\n            <PlusCircleFilled\n              style={{ cursor: 'pointer' }}\n              onClick={() => store.addToCurrentFrame(Object.values(instance.items)[0])}\n            />\n          )}\n          {!store.isLabeling && isSingle && !isHidden && (\n            <InstanceItemReviewIcon item={Object.values(instance.items)[0]} camera={currentCamera} />\n          )}\n        </div>\n      </div>\n      {!instance.collapsed && !isSingle && (\n        <div>\n          {cameraNames.map((c, i) => (\n            <CameraInstanceItemList key={c} instance={instance} camera={c} cameraIndex={i} />\n          ))}\n        </div>\n      )}\n      {isSingle && (\n        <InstanceItemMenu\n          instanceItem={Object.values(instance.items)[0]}\n          camera={currentCamera}\n          position={menuPosition}\n          visible={menuVisible}\n          onClose={() => setMenuVisible(false)}\n        />\n      )}\n    </div>\n  );\n});\n\nexport default SidebarInstance;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}