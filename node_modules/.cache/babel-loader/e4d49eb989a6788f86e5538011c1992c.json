{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-segment/index.js\";\nimport React from 'react';\nimport WaveSurfer from 'wavesurfer.js';\nimport TimelinePlugin from 'wavesurfer.js/dist/plugin/wavesurfer.timeline.min.js';\nimport RegionsPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.regions.min.js';\nimport hexToRgba from 'hex-to-rgba';\nimport { IoMdPlay, IoMdRewind, IoMdFastforward, IoMdPause, IoMdInformationCircleOutline } from 'react-icons/io';\nimport { InputNumber } from 'antd';\nimport { store } from '../../utils';\nimport './audio.css';\nconst toolName = 'video-segment';\nconst defaultColor = '#5ceee4';\nconst defaultAlpha = 0.45;\nexport default class AudioAnnotationApp extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      isPlaying: false,\n      isEditing: false,\n      summary: '',\n      category: 'speech',\n      start: '',\n      end: '',\n      note: '',\n      unitId: '',\n      textEditing: false,\n      showHotkey: false\n    };\n    this.newRegion = undefined;\n    this.wavesurfer = null;\n    this.workingRegion = null;\n    this.ontologyColors = new Map([...(this.props.ontology && Array.isArray(this.props.ontology) && this.props.ontology.map(i => [i.class_name, i.display_color]))]);\n    this.playPause = e => {\n      e.preventDefault();\n      this.setState({\n        isPlaying: !this.state.isPlaying\n      });\n      this.wavesurfer.playPause();\n    };\n    this.skipBackward = e => {\n      e.preventDefault();\n      this.wavesurfer.skipBackward();\n    };\n    this.skipForward = e => {\n      e.preventDefault();\n      this.wavesurfer.skipForward();\n    };\n    this.showSummary = region => {\n      this.setState({\n        summary: `[${this.roundTime(region.start)} - ${this.roundTime(region.end)}] [${region.data.category || ''}]: ${region.data.note || ''}`\n      });\n    };\n    this.hideSummary = () => {\n      this.setState({\n        summary: ''\n      });\n    };\n    this.onRegionClick = (region, e) => {\n      e.stopPropagation();\n      // Play on click, loop on shift click\n      e.shiftKey ? region.playLoop() : region.play();\n      this.onRegionEdit(region);\n    };\n    this.hideForm = () => {\n      // this.workingRegion = null;\n      // this.setState({\n      //   isEditing: false\n      // });\n    };\n    this.showForm = region => {\n      this.workingRegion = region;\n      this.setState({\n        isEditing: true,\n        category: (region.data || {}).category || 'speech',\n        start: this.roundTime(region.start),\n        //Math.round(region.start * 10) / 10,\n        end: this.roundTime(region.end),\n        // Math.round(region.end * 10) / 10,\n        note: (region.data || {}).note || ''\n      });\n    };\n    this.onRegionEdit = region => {\n      this.workingRegion = region;\n      this.setState({\n        isEditing: true,\n        category: (region.data || {}).category || 'speech',\n        start: this.roundTime(region.start),\n        //Math.round(region.start * 10) / 10,\n        end: this.roundTime(region.end),\n        // Math.round(region.end * 10) / 10,\n        note: (region.data || {}).note || ''\n      });\n\n      // save to region\n      this.workingRegion.update({\n        data: {\n          note: this.state.note,\n          category: this.state.category\n        }\n      });\n      this.saveRegions();\n    };\n    this.onRegionUpdate = region => {\n      this.saveRegions();\n      if (this.workingRegion) {\n        this.setState({\n          start: this.roundTime(region.start),\n          //Math.round(region.start * 10) / 10,\n          end: this.roundTime(region.end) // Math.round(region.end * 10) / 10,\n        });\n      }\n    };\n    this.handleCategorySelect = (category, e) => {\n      e.preventDefault();\n      this.setState({\n        category: category.class_name\n      });\n\n      // save to region\n      this.workingRegion.update({\n        color: hexToRgba(category.display_color, defaultAlpha),\n        data: {\n          note: this.state.note,\n          category: category.class_name\n        }\n      });\n      this.saveRegions();\n    };\n    this.handleRegionDelete = e => {\n      e.preventDefault();\n      if (!this.workingRegion) {\n        return;\n      }\n      this.workingRegion.remove();\n      this.workingRegion = null;\n      this.saveRegions();\n      this.setState({\n        isEditing: false\n      });\n    };\n    this.handleRegionSave = e => {\n      e.preventDefault();\n      if (!this.workingRegion) {\n        return;\n      }\n      const {\n        category,\n        start,\n        end,\n        note\n      } = this.state;\n      this.workingRegion.update({\n        start,\n        end,\n        data: {\n          category,\n          note\n        }\n      });\n      this.workingRegion = null;\n      this.saveRegions();\n      this.setState({\n        isEditing: false\n      });\n    };\n    this.setSpeed = n => {\n      const rate = this.speedFormula(n);\n      this.wavesurfer.setPlaybackRate(rate);\n    };\n  }\n  componentDidMount() {\n    this.wavesurfer = WaveSurfer.create({\n      container: '#wave',\n      pixelRatio: 1,\n      scrollParent: true,\n      normalize: true,\n      minimap: true,\n      backend: 'MediaElement',\n      backgroundColor: '#504D66',\n      waveColor: '#27253c',\n      progressColor: '#F7963D',\n      cursorColor: '#F7963D',\n      plugins: [RegionsPlugin.create(), TimelinePlugin.create({\n        container: '#wave-timeline',\n        primaryColor: '#EDEDEF',\n        secondaryColor: '#DCDBE0',\n        primaryFontColor: '#EDEDEF',\n        secondaryFontColor: '#DCDBE0'\n      })]\n    });\n    const mediaElt = document.querySelector('video');\n    this.wavesurfer.load(mediaElt);\n    // this.wavesurfer.load(this.props.audio);\n\n    this.wavesurfer.on('ready', () => {\n      this.wavesurfer.enableDragSelection({\n        color: hexToRgba(defaultColor, defaultAlpha)\n      });\n      const {\n        mode,\n        unit_id\n      } = this.props;\n      const unitId = unit_id;\n      this.setState({\n        unitId: unitId\n      });\n      const {\n        jobId,\n        taskId\n      } = this.resolveUnitId(unitId);\n      const isCacheValid = this.isCacheValid(mode, jobId, taskId);\n      if (!isCacheValid) {\n        store.clear(toolName);\n      }\n      store.setStorage(toolName, 'baseInfo', {\n        mode,\n        jobId,\n        taskId\n      });\n      const storedRegions = store.getStorage(toolName, unitId);\n      if (storedRegions) {\n        this.loadRegions(storedRegions);\n      } else {\n        const annotation = this.props.review_from;\n        if (annotation && annotation.length > 0) {\n          this.loadRegions(annotation);\n          this.saveRegions();\n        }\n      }\n    });\n\n    // bind actions\n    this.wavesurfer.on('play', () => {\n      this.setState({\n        isPlaying: true\n      });\n    });\n    this.wavesurfer.on('pause', () => {\n      this.setState({\n        isPlaying: false\n      });\n    });\n    this.wavesurfer.on('audioprocess', () => {\n      if (this.newRegion) {\n        this.newRegion.update({\n          end: this.roundTime(this.wavesurfer.getCurrentTime())\n        });\n      }\n    });\n    this.wavesurfer.on('region-in', this.showForm);\n    this.wavesurfer.on('region-out', this.hideForm);\n    this.wavesurfer.on('region-click', this.onRegionClick);\n    this.wavesurfer.on('region-update-end', this.onRegionEdit);\n    this.wavesurfer.on('region-updated', this.onRegionUpdate);\n    document.addEventListener('keydown', e => {\n      const {\n        keyCode,\n        ctrlKey,\n        shiftKey\n      } = e;\n      switch (keyCode) {\n        case 9:\n          // TAB\n          e.preventDefault();\n          this.wavesurfer.playPause();\n          break;\n        case 13:\n          if (!shiftKey) {\n            e.preventDefault();\n            this.handleRegionSave(e);\n          }\n          break;\n        case 37:\n          // left arrow\n          this.skipBackward(e);\n          break;\n        case 39:\n          // right arrow\n          this.skipForward(e);\n          break;\n        case 67:\n          // c\n          if (ctrlKey && shiftKey) {\n            e.preventDefault();\n            this.wavesurfer.regions.clear();\n          }\n          break;\n        case 68:\n          // d\n          if (ctrlKey && shiftKey) {\n            e.preventDefault();\n            this.handleRegionDelete(e);\n          }\n          break;\n        // case 69: // e\n        //   if (!this.state.textEditing) {\n        //     e.preventDefault();\n        //     this.newRegion = undefined;\n        //   }\n        //   break;\n        // case 83: // s\n        //   if (ctrlKey && shiftKey) {\n        //     e.preventDefault();\n        //     this.handleRegionSave(e);\n        //   } else if (!this.state.textEditing) {\n        //     e.preventDefault();\n        //     // remove if it's already created\n        //     if (this.newRegion && this.newRegion.id) {\n        //       this.newRegion.remove();\n        //     }\n        //     this.newRegion = {start: this.roundTime(this.wavesurfer.getCurrentTime()), color: hexToRgba(defaultColor, defaultAlpha)};\n        //     this.newRegion = this.wavesurfer.addRegion(this.newRegion);\n        //   }\n        //   break;\n        default:\n      }\n    });\n  }\n  resolveUnitId(unitId) {\n    const units = unitId.split(\"_\");\n    let jobId, taskId, recordId;\n    if (units && units.length >= 3) {\n      jobId = units[0];\n      taskId = units[1];\n      recordId = units[2];\n    }\n    return {\n      jobId,\n      taskId,\n      recordId\n    };\n  }\n  exportResult() {\n    // return store.getStorage(toolName, 'regions');\n    // this.handleRegionSave({});\n    return Object.keys(this.wavesurfer.regions.list).map(id => {\n      const {\n        start,\n        end,\n        data\n      } = this.wavesurfer.regions.list[id];\n      return {\n        start: this.roundTime(start),\n        end: this.roundTime(end),\n        data\n      };\n    });\n  }\n  cleanData() {\n    store.clear(toolName);\n  }\n  isCacheValid(mode, jobId, taskId) {\n    try {\n      const baseInfo = store.getStorage(toolName, 'baseInfo');\n      if (baseInfo && jobId === baseInfo.jobId && taskId === baseInfo.taskId && mode === baseInfo.mode) {\n        return true;\n      }\n    } catch (e) {\n      // failed to parse baseInfo\n    }\n    return false;\n  }\n  loadRegions(regions) {\n    regions.forEach(region => {\n      const regionColor = this.ontologyColors.get(region.data.category) || defaultColor;\n      region.color = hexToRgba(regionColor, defaultAlpha);\n      this.wavesurfer.addRegion(region);\n    });\n  }\n  saveRegions() {\n    const regions = Object.keys(this.wavesurfer.regions.list).map(id => {\n      const {\n        start,\n        end,\n        data\n      } = this.wavesurfer.regions.list[id];\n      return {\n        start: this.roundTime(start),\n        end: this.roundTime(end),\n        data\n      };\n    });\n    store.setStorage(toolName, this.state.unitId, regions);\n  }\n  roundTime(time) {\n    return Math.round(time * 1000) / 1000;\n  }\n  speedFormula(n) {\n    const num = parseInt(n);\n    if (isNaN(num)) return 1.0;\n    let rate = (1 + 0.1 * num).toFixed(1);\n    if (rate > 2) return 2.0;\n    if (rate < 0.1) return 0.1;\n    return rate;\n  }\n  render() {\n    const {\n      isPlaying,\n      isEditing,\n      summary,\n      category,\n      start,\n      end,\n      note\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `${toolName}-container`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"wave\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"wave-timeline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: `${toolName}-btn-group`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: `${toolName}-audio-btn`,\n      onClick: this.skipBackward,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(IoMdRewind, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: `${toolName}-audio-btn`,\n      onClick: this.playPause,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 11\n      }\n    }, isPlaying ? /*#__PURE__*/React.createElement(IoMdPause, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 26\n      }\n    }) : /*#__PURE__*/React.createElement(IoMdPlay, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 42\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: `${toolName}-audio-btn`,\n      onClick: this.skipForward,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(IoMdFastforward, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: `${toolName}-hotkey-btn`,\n      onMouseOver: e => this.setState({\n        showHotkey: true\n      }),\n      onMouseLeave: e => this.setState({\n        showHotkey: false\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 11\n      }\n    }, \"Hot Key Explanation\", /*#__PURE__*/React.createElement(IoMdInformationCircleOutline, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 32\n      }\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: `${toolName}-speed-control`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 13\n      }\n    }, \"Playback Rate: \"), /*#__PURE__*/React.createElement(InputNumber, {\n      id: `${toolName}-speed-btn`,\n      defaultValue: 0,\n      min: -9,\n      max: 10,\n      step: 1,\n      type: \"number\",\n      size: \"small\",\n      formatter: value => this.speedFormula(value),\n      onChange: this.setSpeed,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"video\", {\n      className: `${toolName}-video`,\n      src: this.props.audio,\n      type: \"video/mpeg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }\n    }), this.state.showHotkey && /*#__PURE__*/React.createElement(\"div\", {\n      className: `${toolName}-hotkey`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 15\n      }\n    }, \"Hot Key\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 15\n      }\n    }, \"Features\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 15\n      }\n    }, \"TAB\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 15\n      }\n    }, \"Play or pause\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 15\n      }\n    }, \"Left and right arrow keys\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 15\n      }\n    }, \"Play backward or forward\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 15\n      }\n    }, \"ENTER\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 15\n      }\n    }, \"Save marked area\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 15\n      }\n    }, \"Crl+Shift+D\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 15\n      }\n    }, \"Delete selected area\")), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 15\n      }\n    }, \"Crl+Shift+C\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 15\n      }\n    }, \"Delete all areas\"))))), isEditing && /*#__PURE__*/React.createElement(\"form\", {\n      className: `${toolName}-form`,\n      onSubmit: this.handleRegionSave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: `${toolName}-form-group`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 15\n      }\n    }, \"Category\"), /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 446,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      value: \"speech\",\n      checked: category === \"speech\",\n      onChange: e => this.setState({\n        category: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 21\n      }\n    }, \"speech\")), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      value: \"discard\",\n      checked: category === \"discard\",\n      onChange: e => this.setState({\n        category: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 21\n      }\n    }, \"discard\"))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: `${toolName}-form-group`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 15\n      }\n    }, \"Start/End\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      value: start,\n      onChange: e => this.setState({\n        start: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 15\n      }\n    }, \" - \"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      value: end,\n      onChange: e => this.setState({\n        end: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 15\n      }\n    }, \" Duration: \", this.roundTime(end - start))), /*#__PURE__*/React.createElement(\"div\", {\n      className: `${toolName}-form-group`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 15\n      }\n    }, \"Text\"), /*#__PURE__*/React.createElement(\"textarea\", {\n      rows: \"5\",\n      value: note,\n      onChange: e => this.setState({\n        note: e.target.value\n      }),\n      onFocus: e => this.setState({\n        textEditing: true\n      }),\n      onBlur: e => {\n        this.setState({\n          textEditing: false\n        });\n        // this.handleRegionSave(e);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: `${toolName}-action-btn`,\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 13\n      }\n    }, \"Save\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: `${toolName}-action-btn danger`,\n      onClick: this.handleRegionDelete,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 13\n      }\n    }, \"Delete\")));\n  }\n}","map":{"version":3,"names":["React","WaveSurfer","TimelinePlugin","RegionsPlugin","hexToRgba","IoMdPlay","IoMdRewind","IoMdFastforward","IoMdPause","IoMdInformationCircleOutline","InputNumber","store","toolName","defaultColor","defaultAlpha","AudioAnnotationApp","Component","constructor","args","state","isPlaying","isEditing","summary","category","start","end","note","unitId","textEditing","showHotkey","newRegion","undefined","wavesurfer","workingRegion","ontologyColors","Map","props","ontology","Array","isArray","map","i","class_name","display_color","playPause","e","preventDefault","setState","skipBackward","skipForward","showSummary","region","roundTime","data","hideSummary","onRegionClick","stopPropagation","shiftKey","playLoop","play","onRegionEdit","hideForm","showForm","update","saveRegions","onRegionUpdate","handleCategorySelect","color","handleRegionDelete","remove","handleRegionSave","setSpeed","n","rate","speedFormula","setPlaybackRate","componentDidMount","create","container","pixelRatio","scrollParent","normalize","minimap","backend","backgroundColor","waveColor","progressColor","cursorColor","plugins","primaryColor","secondaryColor","primaryFontColor","secondaryFontColor","mediaElt","document","querySelector","load","on","enableDragSelection","mode","unit_id","jobId","taskId","resolveUnitId","isCacheValid","clear","setStorage","storedRegions","getStorage","loadRegions","annotation","review_from","length","getCurrentTime","addEventListener","keyCode","ctrlKey","regions","units","split","recordId","exportResult","Object","keys","list","id","cleanData","baseInfo","forEach","regionColor","get","addRegion","time","Math","round","num","parseInt","isNaN","toFixed","render","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onMouseOver","onMouseLeave","defaultValue","min","max","step","type","size","formatter","value","onChange","src","audio","onSubmit","checked","target","rows","onFocus","onBlur"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-segment/index.js"],"sourcesContent":["import React from 'react';\nimport WaveSurfer from 'wavesurfer.js';\nimport TimelinePlugin from 'wavesurfer.js/dist/plugin/wavesurfer.timeline.min.js';\nimport RegionsPlugin from 'wavesurfer.js/dist/plugin/wavesurfer.regions.min.js';\nimport hexToRgba from 'hex-to-rgba';\nimport { IoMdPlay, IoMdRewind, IoMdFastforward, IoMdPause, IoMdInformationCircleOutline } from 'react-icons/io';\nimport { InputNumber } from 'antd';\nimport { store } from '../../utils';\nimport './audio.css';\n\nconst toolName = 'video-segment';\nconst defaultColor = '#5ceee4';\nconst defaultAlpha = 0.45;\n\nexport default class AudioAnnotationApp extends React.Component {\n  state = {\n    isPlaying: false,\n    isEditing: false,\n    summary: '',\n    category: 'speech',\n    start: '',\n    end: '',\n    note: '',\n    unitId: '',\n    textEditing: false,\n    showHotkey: false,\n  };\n\n  newRegion = undefined;\n\n  wavesurfer = null;\n  workingRegion = null;\n  ontologyColors = new Map([\n    ...this.props.ontology && Array.isArray(this.props.ontology) &&\n    this.props.ontology.map(i => ([i.class_name, i.display_color])),\n  ]);\n\n  componentDidMount() {\n    this.wavesurfer = WaveSurfer.create({\n      container: '#wave',\n      pixelRatio: 1,\n      scrollParent: true,\n      normalize: true,\n      minimap: true,\n      backend: 'MediaElement',\n      backgroundColor: '#504D66',\n      waveColor: '#27253c',\n      progressColor: '#F7963D',\n      cursorColor: '#F7963D',\n      plugins: [\n        RegionsPlugin.create(),\n        TimelinePlugin.create({\n          container: '#wave-timeline',\n          primaryColor: '#EDEDEF',\n          secondaryColor: '#DCDBE0',\n          primaryFontColor: '#EDEDEF',\n          secondaryFontColor: '#DCDBE0',\n        })\n      ]\n    });\n    const mediaElt = document.querySelector('video');\n    this.wavesurfer.load(mediaElt);\n    // this.wavesurfer.load(this.props.audio);\n\n    this.wavesurfer.on('ready', () => {\n      this.wavesurfer.enableDragSelection({\n        color: hexToRgba(defaultColor, defaultAlpha)\n      });\n\n      const { mode, unit_id } = this.props;\n      const unitId = unit_id;\n      this.setState({ unitId: unitId });\n      const { jobId, taskId } = this.resolveUnitId(unitId);\n\n      const isCacheValid = this.isCacheValid(mode, jobId, taskId);\n      if (!isCacheValid) {\n        store.clear(toolName);\n      }\n      store.setStorage(toolName, 'baseInfo', { mode, jobId, taskId });\n\n      const storedRegions = store.getStorage(toolName, unitId);\n      if (storedRegions) {\n        this.loadRegions(storedRegions);\n      } else {\n        const annotation = this.props.review_from;\n        if (annotation && annotation.length > 0) {\n          this.loadRegions(annotation);\n          this.saveRegions();\n        }\n      }\n    });\n\n    // bind actions\n    this.wavesurfer.on('play', () => {\n      this.setState({ isPlaying: true });\n    });\n    this.wavesurfer.on('pause', () => {\n      this.setState({ isPlaying: false });\n    });\n\n    this.wavesurfer.on('audioprocess', () => {\n      if (this.newRegion) {\n        this.newRegion.update({end: this.roundTime(this.wavesurfer.getCurrentTime())});\n      }\n    });\n    this.wavesurfer.on('region-in', this.showForm);\n    this.wavesurfer.on('region-out', this.hideForm);\n    this.wavesurfer.on('region-click', this.onRegionClick);\n    this.wavesurfer.on('region-update-end', this.onRegionEdit);\n    this.wavesurfer.on('region-updated', this.onRegionUpdate);\n\n    document.addEventListener('keydown', (e) => {\n      const { keyCode, ctrlKey, shiftKey } = e;\n      switch (keyCode) {\n        case 9: // TAB\n          e.preventDefault();\n          this.wavesurfer.playPause();\n          break;\n        case 13:\n          if (!shiftKey) {\n            e.preventDefault();\n            this.handleRegionSave(e);\n          }\n          break;\n        case 37: // left arrow\n          this.skipBackward(e);\n          break;\n        case 39: // right arrow\n          this.skipForward(e);\n          break;\n        case 67: // c\n          if (ctrlKey && shiftKey) {\n            e.preventDefault();\n            this.wavesurfer.regions.clear();\n          }\n          break;\n        case 68: // d\n          if (ctrlKey && shiftKey) {\n            e.preventDefault();\n            this.handleRegionDelete(e);\n          }\n          break;\n        // case 69: // e\n        //   if (!this.state.textEditing) {\n        //     e.preventDefault();\n        //     this.newRegion = undefined;\n        //   }\n        //   break;\n        // case 83: // s\n        //   if (ctrlKey && shiftKey) {\n        //     e.preventDefault();\n        //     this.handleRegionSave(e);\n        //   } else if (!this.state.textEditing) {\n        //     e.preventDefault();\n        //     // remove if it's already created\n        //     if (this.newRegion && this.newRegion.id) {\n        //       this.newRegion.remove();\n        //     }\n        //     this.newRegion = {start: this.roundTime(this.wavesurfer.getCurrentTime()), color: hexToRgba(defaultColor, defaultAlpha)};\n        //     this.newRegion = this.wavesurfer.addRegion(this.newRegion);\n        //   }\n        //   break;\n        default:\n      }\n    });\n  }\n\n  resolveUnitId(unitId) {\n    const units = unitId.split(\"_\");\n    let jobId, taskId, recordId;\n    if (units && units.length >= 3) {\n      jobId = units[0];\n      taskId = units[1];\n      recordId = units[2];\n    }\n    return {\n      jobId,\n      taskId,\n      recordId,\n    }\n  }\n\n  exportResult() {\n    // return store.getStorage(toolName, 'regions');\n    // this.handleRegionSave({});\n    return Object.keys(this.wavesurfer.regions.list).map((id) => {\n      const { start, end, data } = this.wavesurfer.regions.list[id];\n      return { start: this.roundTime(start), end: this.roundTime(end), data };\n    });\n  }\n\n  cleanData() {\n    store.clear(toolName);\n  }\n\n  isCacheValid(mode, jobId, taskId) {\n    try {\n      const baseInfo = store.getStorage(toolName, 'baseInfo');\n      if (baseInfo && jobId === baseInfo.jobId && taskId === baseInfo.taskId && mode === baseInfo.mode) {\n        return true;\n      }\n    } catch (e) {\n      // failed to parse baseInfo\n    }\n    return false;\n  }\n\n  loadRegions(regions) {\n    regions.forEach((region) => {\n      const regionColor = this.ontologyColors.get(region.data.category) || defaultColor;\n      region.color = hexToRgba(regionColor, defaultAlpha);\n      this.wavesurfer.addRegion(region);\n    });\n  }\n\n  saveRegions() {\n    const regions = Object.keys(this.wavesurfer.regions.list).map((id) => {\n      const { start, end, data } = this.wavesurfer.regions.list[id];\n      return { start: this.roundTime(start), end: this.roundTime(end), data };\n    });\n    store.setStorage(toolName, this.state.unitId, regions);\n  }\n\n  roundTime(time) {\n    return Math.round(time * 1000) / 1000;\n  }\n\n  playPause = (e) => {\n    e.preventDefault();\n    this.setState({ isPlaying: !this.state.isPlaying });\n    this.wavesurfer.playPause();\n  }\n\n  skipBackward = (e) => {\n    e.preventDefault();\n    this.wavesurfer.skipBackward();\n  }\n\n  skipForward = (e) => {\n    e.preventDefault();\n    this.wavesurfer.skipForward();\n  }\n\n  showSummary = (region) => {\n    this.setState({ summary: `[${this.roundTime(region.start)} - ${this.roundTime(region.end)}] [${region.data.category||''}]: ${region.data.note||''}` });\n  }\n\n  hideSummary = () => {\n    this.setState({ summary: '' });\n  }\n\n  onRegionClick = (region, e) => {\n    e.stopPropagation();\n    // Play on click, loop on shift click\n    e.shiftKey ? region.playLoop() : region.play();\n\n    this.onRegionEdit(region);\n  }\n\n  hideForm = () => {\n    // this.workingRegion = null;\n    // this.setState({\n    //   isEditing: false\n    // });\n  }\n\n  showForm = (region) => {\n    this.workingRegion = region;\n    this.setState({\n      isEditing: true,\n      category: (region.data || {}).category || 'speech',\n      start: this.roundTime(region.start), //Math.round(region.start * 10) / 10,\n      end: this.roundTime(region.end), // Math.round(region.end * 10) / 10,\n      note: (region.data || {}).note || '',\n    });\n  }\n\n  onRegionEdit = (region) => {\n    this.workingRegion = region;\n    this.setState({\n      isEditing: true,\n      category: (region.data || {}).category || 'speech',\n      start: this.roundTime(region.start), //Math.round(region.start * 10) / 10,\n      end: this.roundTime(region.end), // Math.round(region.end * 10) / 10,\n      note: (region.data || {}).note || '',\n    });\n\n    // save to region\n    this.workingRegion.update({\n      data: {\n        note: this.state.note,\n        category: this.state.category,\n      }\n    });\n    this.saveRegions();\n  }\n\n  onRegionUpdate = (region) => {\n    this.saveRegions();\n\n    if (this.workingRegion) {\n      this.setState({\n        start: this.roundTime(region.start), //Math.round(region.start * 10) / 10,\n        end: this.roundTime(region.end), // Math.round(region.end * 10) / 10,\n      });\n    }\n  }\n\n  handleCategorySelect = (category, e) => {\n    e.preventDefault();\n    this.setState({ category: category.class_name });\n\n    // save to region\n    this.workingRegion.update({\n      color: hexToRgba(category.display_color, defaultAlpha),\n      data: {\n        note: this.state.note,\n        category: category.class_name,\n      }\n    });\n    this.saveRegions();\n  }\n\n  handleRegionDelete = (e) => {\n    e.preventDefault();\n    if (!this.workingRegion) {\n      return;\n    }\n    this.workingRegion.remove();\n    this.workingRegion = null;\n    this.saveRegions();\n    this.setState({ isEditing: false });\n  }\n\n  handleRegionSave = (e) => {\n    e.preventDefault();\n    if (!this.workingRegion) {\n      return;\n    }\n    const { category, start, end, note } = this.state;\n    this.workingRegion.update({\n      start,\n      end,\n      data: { category, note },\n    });\n    this.workingRegion = null;\n    this.saveRegions();\n    this.setState({ isEditing: false });\n  }\n\n  setSpeed = (n) => {\n    const rate = this.speedFormula(n);\n    this.wavesurfer.setPlaybackRate(rate);\n  }\n\n  speedFormula(n) {\n    const num = parseInt(n);\n    if (isNaN(num)) return 1.0;\n    let rate = (1 + 0.1 * num).toFixed(1);\n    if (rate > 2) return 2.0;\n    if (rate < 0.1) return 0.1;\n    return rate;\n  }\n\n  render() {\n    const { isPlaying, isEditing, summary, category, start, end, note } = this.state;\n\n    return (\n      <div className={`${toolName}-container`}>\n        <div id=\"wave\" />\n        <div id=\"wave-timeline\" />\n\n        <div className={`${toolName}-btn-group`}>\n          <button className={`${toolName}-audio-btn`} onClick={this.skipBackward}>\n            <IoMdRewind />\n          </button>\n          <button className={`${toolName}-audio-btn`} onClick={this.playPause}>\n            {isPlaying ? <IoMdPause /> : <IoMdPlay />}\n          </button>\n          <button className={`${toolName}-audio-btn`} onClick={this.skipForward}>\n            <IoMdFastforward />\n          </button>\n          <span className={`${toolName}-hotkey-btn`}\n                onMouseOver={e => this.setState({showHotkey: true})}\n                onMouseLeave={e => this.setState({showHotkey: false})}\n          >\n            Hot Key Explanation<IoMdInformationCircleOutline />\n          </span>\n          <span className={`${toolName}-speed-control`}>\n            <span>Playback Rate: </span>\n            <InputNumber\n              id={`${toolName}-speed-btn`}\n              defaultValue={0}\n              min={-9}\n              max={10}\n              step={1}\n              type={\"number\"}\n              size={\"small\"}\n              formatter={value => this.speedFormula(value)}\n              onChange={this.setSpeed}\n            />\n          </span>\n        </div>\n\n       {/* <div className={`${toolName}-summary`}>{summary}</div>*/}\n\n        <video className={`${toolName}-video`} src={this.props.audio} type=\"video/mpeg\">\n        </video>\n\n        { this.state.showHotkey && (<div className={`${toolName}-hotkey`}>\n          <table>\n            <tbody>\n            <tr>\n              <th>Hot Key</th>\n              <th>Features</th>\n            </tr>\n            <tr>\n              <td>TAB</td>\n              <td>Play or pause</td>\n            </tr>\n            <tr>\n              <td>Left and right arrow keys</td>\n              <td>Play backward or forward</td>\n            </tr>\n            <tr>\n              <td>ENTER</td>\n              <td>Save marked area</td>\n            </tr>\n            <tr>\n              <td>Crl+Shift+D</td>\n              <td>Delete selected area</td>\n            </tr>\n            <tr>\n              <td>Crl+Shift+C</td>\n              <td>Delete all areas</td>\n            </tr>\n            </tbody>\n          </table>\n        </div>\n        )}\n\n        { isEditing && (\n          <form className={`${toolName}-form`} onSubmit={this.handleRegionSave}>\n            <div className={`${toolName}-form-group`}>\n              <label>Category</label>\n              <ul>\n                <li>\n                  <label>\n                    <input type=\"radio\" value=\"speech\" checked={category === \"speech\"} onChange={e => this.setState({ category: e.target.value })}/>\n                    <span>speech</span>\n                  </label>\n                  <label>\n                    <input type=\"radio\" value=\"discard\" checked={category === \"discard\"} onChange={e => this.setState({ category: e.target.value })}/>\n                    <span>discard</span>\n                  </label>\n                </li>\n              </ul>\n            </div>\n\n            <div className={`${toolName}-form-group`}>\n              <label>Start/End</label>\n              <input type={\"text\"} value={start} onChange={e => this.setState({ start: e.target.value })} />\n              <span> - </span>\n              <input type={\"text\"} value={end} onChange={e => this.setState({ end: e.target.value })} />\n              <span> Duration: {this.roundTime(end - start)}</span>\n            </div>\n\n            <div className={`${toolName}-form-group`}>\n              <label>Text</label>\n              {/*<input type={\"text\"} value={note} onChange={e => this.setState({ note: e.target.value })} />*/}\n              <textarea rows=\"5\" value={note}\n                        onChange={e => this.setState({ note: e.target.value })}\n                        onFocus={e => this.setState({textEditing: true})}\n                        onBlur={e => {\n                          this.setState({textEditing: false});\n                          // this.handleRegionSave(e);\n                        }}/>\n            </div>\n\n            <button className={`${toolName}-action-btn`} type=\"submit\">\n              Save\n            </button>\n            <button className={`${toolName}-action-btn danger`} onClick={this.handleRegionDelete}>\n              Delete\n            </button>\n          </form>\n        )}\n      </div>\n    );\n  }\n}\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,UAAU,MAAM,eAAe;AACtC,OAAOC,cAAc,MAAM,sDAAsD;AACjF,OAAOC,aAAa,MAAM,qDAAqD;AAC/E,OAAOC,SAAS,MAAM,aAAa;AACnC,SAASC,QAAQ,EAAEC,UAAU,EAAEC,eAAe,EAAEC,SAAS,EAAEC,4BAA4B,QAAQ,gBAAgB;AAC/G,SAASC,WAAW,QAAQ,MAAM;AAClC,SAASC,KAAK,QAAQ,aAAa;AACnC,OAAO,aAAa;AAEpB,MAAMC,QAAQ,GAAG,eAAe;AAChC,MAAMC,YAAY,GAAG,SAAS;AAC9B,MAAMC,YAAY,GAAG,IAAI;AAEzB,eAAe,MAAMC,kBAAkB,SAASf,KAAK,CAACgB,SAAS,CAAC;EAAAC,YAAA,GAAAC,IAAA;IAAA,SAAAA,IAAA;IAAA,KAC9DC,KAAK,GAAG;MACNC,SAAS,EAAE,KAAK;MAChBC,SAAS,EAAE,KAAK;MAChBC,OAAO,EAAE,EAAE;MACXC,QAAQ,EAAE,QAAQ;MAClBC,KAAK,EAAE,EAAE;MACTC,GAAG,EAAE,EAAE;MACPC,IAAI,EAAE,EAAE;MACRC,MAAM,EAAE,EAAE;MACVC,WAAW,EAAE,KAAK;MAClBC,UAAU,EAAE;IACd,CAAC;IAAA,KAEDC,SAAS,GAAGC,SAAS;IAAA,KAErBC,UAAU,GAAG,IAAI;IAAA,KACjBC,aAAa,GAAG,IAAI;IAAA,KACpBC,cAAc,GAAG,IAAIC,GAAG,CAAC,CACvB,IAAG,IAAI,CAACC,KAAK,CAACC,QAAQ,IAAIC,KAAK,CAACC,OAAO,CAAC,IAAI,CAACH,KAAK,CAACC,QAAQ,CAAC,IAC5D,IAAI,CAACD,KAAK,CAACC,QAAQ,CAACG,GAAG,CAACC,CAAC,IAAK,CAACA,CAAC,CAACC,UAAU,EAAED,CAAC,CAACE,aAAa,CAAE,CAAC,EAChE,CAAC;IAAA,KAgMFC,SAAS,GAAIC,CAAC,IAAK;MACjBA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,IAAI,CAACC,QAAQ,CAAC;QAAE3B,SAAS,EAAE,CAAC,IAAI,CAACD,KAAK,CAACC;MAAU,CAAC,CAAC;MACnD,IAAI,CAACY,UAAU,CAACY,SAAS,CAAC,CAAC;IAC7B,CAAC;IAAA,KAEDI,YAAY,GAAIH,CAAC,IAAK;MACpBA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,IAAI,CAACd,UAAU,CAACgB,YAAY,CAAC,CAAC;IAChC,CAAC;IAAA,KAEDC,WAAW,GAAIJ,CAAC,IAAK;MACnBA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,IAAI,CAACd,UAAU,CAACiB,WAAW,CAAC,CAAC;IAC/B,CAAC;IAAA,KAEDC,WAAW,GAAIC,MAAM,IAAK;MACxB,IAAI,CAACJ,QAAQ,CAAC;QAAEzB,OAAO,EAAE,IAAI,IAAI,CAAC8B,SAAS,CAACD,MAAM,CAAC3B,KAAK,CAAC,MAAM,IAAI,CAAC4B,SAAS,CAACD,MAAM,CAAC1B,GAAG,CAAC,MAAM0B,MAAM,CAACE,IAAI,CAAC9B,QAAQ,IAAE,EAAE,MAAM4B,MAAM,CAACE,IAAI,CAAC3B,IAAI,IAAE,EAAE;MAAG,CAAC,CAAC;IACxJ,CAAC;IAAA,KAED4B,WAAW,GAAG,MAAM;MAClB,IAAI,CAACP,QAAQ,CAAC;QAAEzB,OAAO,EAAE;MAAG,CAAC,CAAC;IAChC,CAAC;IAAA,KAEDiC,aAAa,GAAG,CAACJ,MAAM,EAAEN,CAAC,KAAK;MAC7BA,CAAC,CAACW,eAAe,CAAC,CAAC;MACnB;MACAX,CAAC,CAACY,QAAQ,GAAGN,MAAM,CAACO,QAAQ,CAAC,CAAC,GAAGP,MAAM,CAACQ,IAAI,CAAC,CAAC;MAE9C,IAAI,CAACC,YAAY,CAACT,MAAM,CAAC;IAC3B,CAAC;IAAA,KAEDU,QAAQ,GAAG,MAAM;MACf;MACA;MACA;MACA;IAAA,CACD;IAAA,KAEDC,QAAQ,GAAIX,MAAM,IAAK;MACrB,IAAI,CAAClB,aAAa,GAAGkB,MAAM;MAC3B,IAAI,CAACJ,QAAQ,CAAC;QACZ1B,SAAS,EAAE,IAAI;QACfE,QAAQ,EAAE,CAAC4B,MAAM,CAACE,IAAI,IAAI,CAAC,CAAC,EAAE9B,QAAQ,IAAI,QAAQ;QAClDC,KAAK,EAAE,IAAI,CAAC4B,SAAS,CAACD,MAAM,CAAC3B,KAAK,CAAC;QAAE;QACrCC,GAAG,EAAE,IAAI,CAAC2B,SAAS,CAACD,MAAM,CAAC1B,GAAG,CAAC;QAAE;QACjCC,IAAI,EAAE,CAACyB,MAAM,CAACE,IAAI,IAAI,CAAC,CAAC,EAAE3B,IAAI,IAAI;MACpC,CAAC,CAAC;IACJ,CAAC;IAAA,KAEDkC,YAAY,GAAIT,MAAM,IAAK;MACzB,IAAI,CAAClB,aAAa,GAAGkB,MAAM;MAC3B,IAAI,CAACJ,QAAQ,CAAC;QACZ1B,SAAS,EAAE,IAAI;QACfE,QAAQ,EAAE,CAAC4B,MAAM,CAACE,IAAI,IAAI,CAAC,CAAC,EAAE9B,QAAQ,IAAI,QAAQ;QAClDC,KAAK,EAAE,IAAI,CAAC4B,SAAS,CAACD,MAAM,CAAC3B,KAAK,CAAC;QAAE;QACrCC,GAAG,EAAE,IAAI,CAAC2B,SAAS,CAACD,MAAM,CAAC1B,GAAG,CAAC;QAAE;QACjCC,IAAI,EAAE,CAACyB,MAAM,CAACE,IAAI,IAAI,CAAC,CAAC,EAAE3B,IAAI,IAAI;MACpC,CAAC,CAAC;;MAEF;MACA,IAAI,CAACO,aAAa,CAAC8B,MAAM,CAAC;QACxBV,IAAI,EAAE;UACJ3B,IAAI,EAAE,IAAI,CAACP,KAAK,CAACO,IAAI;UACrBH,QAAQ,EAAE,IAAI,CAACJ,KAAK,CAACI;QACvB;MACF,CAAC,CAAC;MACF,IAAI,CAACyC,WAAW,CAAC,CAAC;IACpB,CAAC;IAAA,KAEDC,cAAc,GAAId,MAAM,IAAK;MAC3B,IAAI,CAACa,WAAW,CAAC,CAAC;MAElB,IAAI,IAAI,CAAC/B,aAAa,EAAE;QACtB,IAAI,CAACc,QAAQ,CAAC;UACZvB,KAAK,EAAE,IAAI,CAAC4B,SAAS,CAACD,MAAM,CAAC3B,KAAK,CAAC;UAAE;UACrCC,GAAG,EAAE,IAAI,CAAC2B,SAAS,CAACD,MAAM,CAAC1B,GAAG,CAAC,CAAE;QACnC,CAAC,CAAC;MACJ;IACF,CAAC;IAAA,KAEDyC,oBAAoB,GAAG,CAAC3C,QAAQ,EAAEsB,CAAC,KAAK;MACtCA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,IAAI,CAACC,QAAQ,CAAC;QAAExB,QAAQ,EAAEA,QAAQ,CAACmB;MAAW,CAAC,CAAC;;MAEhD;MACA,IAAI,CAACT,aAAa,CAAC8B,MAAM,CAAC;QACxBI,KAAK,EAAE/D,SAAS,CAACmB,QAAQ,CAACoB,aAAa,EAAE7B,YAAY,CAAC;QACtDuC,IAAI,EAAE;UACJ3B,IAAI,EAAE,IAAI,CAACP,KAAK,CAACO,IAAI;UACrBH,QAAQ,EAAEA,QAAQ,CAACmB;QACrB;MACF,CAAC,CAAC;MACF,IAAI,CAACsB,WAAW,CAAC,CAAC;IACpB,CAAC;IAAA,KAEDI,kBAAkB,GAAIvB,CAAC,IAAK;MAC1BA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,IAAI,CAAC,IAAI,CAACb,aAAa,EAAE;QACvB;MACF;MACA,IAAI,CAACA,aAAa,CAACoC,MAAM,CAAC,CAAC;MAC3B,IAAI,CAACpC,aAAa,GAAG,IAAI;MACzB,IAAI,CAAC+B,WAAW,CAAC,CAAC;MAClB,IAAI,CAACjB,QAAQ,CAAC;QAAE1B,SAAS,EAAE;MAAM,CAAC,CAAC;IACrC,CAAC;IAAA,KAEDiD,gBAAgB,GAAIzB,CAAC,IAAK;MACxBA,CAAC,CAACC,cAAc,CAAC,CAAC;MAClB,IAAI,CAAC,IAAI,CAACb,aAAa,EAAE;QACvB;MACF;MACA,MAAM;QAAEV,QAAQ;QAAEC,KAAK;QAAEC,GAAG;QAAEC;MAAK,CAAC,GAAG,IAAI,CAACP,KAAK;MACjD,IAAI,CAACc,aAAa,CAAC8B,MAAM,CAAC;QACxBvC,KAAK;QACLC,GAAG;QACH4B,IAAI,EAAE;UAAE9B,QAAQ;UAAEG;QAAK;MACzB,CAAC,CAAC;MACF,IAAI,CAACO,aAAa,GAAG,IAAI;MACzB,IAAI,CAAC+B,WAAW,CAAC,CAAC;MAClB,IAAI,CAACjB,QAAQ,CAAC;QAAE1B,SAAS,EAAE;MAAM,CAAC,CAAC;IACrC,CAAC;IAAA,KAEDkD,QAAQ,GAAIC,CAAC,IAAK;MAChB,MAAMC,IAAI,GAAG,IAAI,CAACC,YAAY,CAACF,CAAC,CAAC;MACjC,IAAI,CAACxC,UAAU,CAAC2C,eAAe,CAACF,IAAI,CAAC;IACvC,CAAC;EAAA;EA5TDG,iBAAiBA,CAAA,EAAG;IAClB,IAAI,CAAC5C,UAAU,GAAG/B,UAAU,CAAC4E,MAAM,CAAC;MAClCC,SAAS,EAAE,OAAO;MAClBC,UAAU,EAAE,CAAC;MACbC,YAAY,EAAE,IAAI;MAClBC,SAAS,EAAE,IAAI;MACfC,OAAO,EAAE,IAAI;MACbC,OAAO,EAAE,cAAc;MACvBC,eAAe,EAAE,SAAS;MAC1BC,SAAS,EAAE,SAAS;MACpBC,aAAa,EAAE,SAAS;MACxBC,WAAW,EAAE,SAAS;MACtBC,OAAO,EAAE,CACPrF,aAAa,CAAC0E,MAAM,CAAC,CAAC,EACtB3E,cAAc,CAAC2E,MAAM,CAAC;QACpBC,SAAS,EAAE,gBAAgB;QAC3BW,YAAY,EAAE,SAAS;QACvBC,cAAc,EAAE,SAAS;QACzBC,gBAAgB,EAAE,SAAS;QAC3BC,kBAAkB,EAAE;MACtB,CAAC,CAAC;IAEN,CAAC,CAAC;IACF,MAAMC,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;IAChD,IAAI,CAAC/D,UAAU,CAACgE,IAAI,CAACH,QAAQ,CAAC;IAC9B;;IAEA,IAAI,CAAC7D,UAAU,CAACiE,EAAE,CAAC,OAAO,EAAE,MAAM;MAChC,IAAI,CAACjE,UAAU,CAACkE,mBAAmB,CAAC;QAClC/B,KAAK,EAAE/D,SAAS,CAACS,YAAY,EAAEC,YAAY;MAC7C,CAAC,CAAC;MAEF,MAAM;QAAEqF,IAAI;QAAEC;MAAQ,CAAC,GAAG,IAAI,CAAChE,KAAK;MACpC,MAAMT,MAAM,GAAGyE,OAAO;MACtB,IAAI,CAACrD,QAAQ,CAAC;QAAEpB,MAAM,EAAEA;MAAO,CAAC,CAAC;MACjC,MAAM;QAAE0E,KAAK;QAAEC;MAAO,CAAC,GAAG,IAAI,CAACC,aAAa,CAAC5E,MAAM,CAAC;MAEpD,MAAM6E,YAAY,GAAG,IAAI,CAACA,YAAY,CAACL,IAAI,EAAEE,KAAK,EAAEC,MAAM,CAAC;MAC3D,IAAI,CAACE,YAAY,EAAE;QACjB7F,KAAK,CAAC8F,KAAK,CAAC7F,QAAQ,CAAC;MACvB;MACAD,KAAK,CAAC+F,UAAU,CAAC9F,QAAQ,EAAE,UAAU,EAAE;QAAEuF,IAAI;QAAEE,KAAK;QAAEC;MAAO,CAAC,CAAC;MAE/D,MAAMK,aAAa,GAAGhG,KAAK,CAACiG,UAAU,CAAChG,QAAQ,EAAEe,MAAM,CAAC;MACxD,IAAIgF,aAAa,EAAE;QACjB,IAAI,CAACE,WAAW,CAACF,aAAa,CAAC;MACjC,CAAC,MAAM;QACL,MAAMG,UAAU,GAAG,IAAI,CAAC1E,KAAK,CAAC2E,WAAW;QACzC,IAAID,UAAU,IAAIA,UAAU,CAACE,MAAM,GAAG,CAAC,EAAE;UACvC,IAAI,CAACH,WAAW,CAACC,UAAU,CAAC;UAC5B,IAAI,CAAC9C,WAAW,CAAC,CAAC;QACpB;MACF;IACF,CAAC,CAAC;;IAEF;IACA,IAAI,CAAChC,UAAU,CAACiE,EAAE,CAAC,MAAM,EAAE,MAAM;MAC/B,IAAI,CAAClD,QAAQ,CAAC;QAAE3B,SAAS,EAAE;MAAK,CAAC,CAAC;IACpC,CAAC,CAAC;IACF,IAAI,CAACY,UAAU,CAACiE,EAAE,CAAC,OAAO,EAAE,MAAM;MAChC,IAAI,CAAClD,QAAQ,CAAC;QAAE3B,SAAS,EAAE;MAAM,CAAC,CAAC;IACrC,CAAC,CAAC;IAEF,IAAI,CAACY,UAAU,CAACiE,EAAE,CAAC,cAAc,EAAE,MAAM;MACvC,IAAI,IAAI,CAACnE,SAAS,EAAE;QAClB,IAAI,CAACA,SAAS,CAACiC,MAAM,CAAC;UAACtC,GAAG,EAAE,IAAI,CAAC2B,SAAS,CAAC,IAAI,CAACpB,UAAU,CAACiF,cAAc,CAAC,CAAC;QAAC,CAAC,CAAC;MAChF;IACF,CAAC,CAAC;IACF,IAAI,CAACjF,UAAU,CAACiE,EAAE,CAAC,WAAW,EAAE,IAAI,CAACnC,QAAQ,CAAC;IAC9C,IAAI,CAAC9B,UAAU,CAACiE,EAAE,CAAC,YAAY,EAAE,IAAI,CAACpC,QAAQ,CAAC;IAC/C,IAAI,CAAC7B,UAAU,CAACiE,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC1C,aAAa,CAAC;IACtD,IAAI,CAACvB,UAAU,CAACiE,EAAE,CAAC,mBAAmB,EAAE,IAAI,CAACrC,YAAY,CAAC;IAC1D,IAAI,CAAC5B,UAAU,CAACiE,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAChC,cAAc,CAAC;IAEzD6B,QAAQ,CAACoB,gBAAgB,CAAC,SAAS,EAAGrE,CAAC,IAAK;MAC1C,MAAM;QAAEsE,OAAO;QAAEC,OAAO;QAAE3D;MAAS,CAAC,GAAGZ,CAAC;MACxC,QAAQsE,OAAO;QACb,KAAK,CAAC;UAAE;UACNtE,CAAC,CAACC,cAAc,CAAC,CAAC;UAClB,IAAI,CAACd,UAAU,CAACY,SAAS,CAAC,CAAC;UAC3B;QACF,KAAK,EAAE;UACL,IAAI,CAACa,QAAQ,EAAE;YACbZ,CAAC,CAACC,cAAc,CAAC,CAAC;YAClB,IAAI,CAACwB,gBAAgB,CAACzB,CAAC,CAAC;UAC1B;UACA;QACF,KAAK,EAAE;UAAE;UACP,IAAI,CAACG,YAAY,CAACH,CAAC,CAAC;UACpB;QACF,KAAK,EAAE;UAAE;UACP,IAAI,CAACI,WAAW,CAACJ,CAAC,CAAC;UACnB;QACF,KAAK,EAAE;UAAE;UACP,IAAIuE,OAAO,IAAI3D,QAAQ,EAAE;YACvBZ,CAAC,CAACC,cAAc,CAAC,CAAC;YAClB,IAAI,CAACd,UAAU,CAACqF,OAAO,CAACZ,KAAK,CAAC,CAAC;UACjC;UACA;QACF,KAAK,EAAE;UAAE;UACP,IAAIW,OAAO,IAAI3D,QAAQ,EAAE;YACvBZ,CAAC,CAACC,cAAc,CAAC,CAAC;YAClB,IAAI,CAACsB,kBAAkB,CAACvB,CAAC,CAAC;UAC5B;UACA;QACF;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACF;IACF,CAAC,CAAC;EACJ;EAEA0D,aAAaA,CAAC5E,MAAM,EAAE;IACpB,MAAM2F,KAAK,GAAG3F,MAAM,CAAC4F,KAAK,CAAC,GAAG,CAAC;IAC/B,IAAIlB,KAAK,EAAEC,MAAM,EAAEkB,QAAQ;IAC3B,IAAIF,KAAK,IAAIA,KAAK,CAACN,MAAM,IAAI,CAAC,EAAE;MAC9BX,KAAK,GAAGiB,KAAK,CAAC,CAAC,CAAC;MAChBhB,MAAM,GAAGgB,KAAK,CAAC,CAAC,CAAC;MACjBE,QAAQ,GAAGF,KAAK,CAAC,CAAC,CAAC;IACrB;IACA,OAAO;MACLjB,KAAK;MACLC,MAAM;MACNkB;IACF,CAAC;EACH;EAEAC,YAAYA,CAAA,EAAG;IACb;IACA;IACA,OAAOC,MAAM,CAACC,IAAI,CAAC,IAAI,CAAC3F,UAAU,CAACqF,OAAO,CAACO,IAAI,CAAC,CAACpF,GAAG,CAAEqF,EAAE,IAAK;MAC3D,MAAM;QAAErG,KAAK;QAAEC,GAAG;QAAE4B;MAAK,CAAC,GAAG,IAAI,CAACrB,UAAU,CAACqF,OAAO,CAACO,IAAI,CAACC,EAAE,CAAC;MAC7D,OAAO;QAAErG,KAAK,EAAE,IAAI,CAAC4B,SAAS,CAAC5B,KAAK,CAAC;QAAEC,GAAG,EAAE,IAAI,CAAC2B,SAAS,CAAC3B,GAAG,CAAC;QAAE4B;MAAK,CAAC;IACzE,CAAC,CAAC;EACJ;EAEAyE,SAASA,CAAA,EAAG;IACVnH,KAAK,CAAC8F,KAAK,CAAC7F,QAAQ,CAAC;EACvB;EAEA4F,YAAYA,CAACL,IAAI,EAAEE,KAAK,EAAEC,MAAM,EAAE;IAChC,IAAI;MACF,MAAMyB,QAAQ,GAAGpH,KAAK,CAACiG,UAAU,CAAChG,QAAQ,EAAE,UAAU,CAAC;MACvD,IAAImH,QAAQ,IAAI1B,KAAK,KAAK0B,QAAQ,CAAC1B,KAAK,IAAIC,MAAM,KAAKyB,QAAQ,CAACzB,MAAM,IAAIH,IAAI,KAAK4B,QAAQ,CAAC5B,IAAI,EAAE;QAChG,OAAO,IAAI;MACb;IACF,CAAC,CAAC,OAAOtD,CAAC,EAAE;MACV;IAAA;IAEF,OAAO,KAAK;EACd;EAEAgE,WAAWA,CAACQ,OAAO,EAAE;IACnBA,OAAO,CAACW,OAAO,CAAE7E,MAAM,IAAK;MAC1B,MAAM8E,WAAW,GAAG,IAAI,CAAC/F,cAAc,CAACgG,GAAG,CAAC/E,MAAM,CAACE,IAAI,CAAC9B,QAAQ,CAAC,IAAIV,YAAY;MACjFsC,MAAM,CAACgB,KAAK,GAAG/D,SAAS,CAAC6H,WAAW,EAAEnH,YAAY,CAAC;MACnD,IAAI,CAACkB,UAAU,CAACmG,SAAS,CAAChF,MAAM,CAAC;IACnC,CAAC,CAAC;EACJ;EAEAa,WAAWA,CAAA,EAAG;IACZ,MAAMqD,OAAO,GAAGK,MAAM,CAACC,IAAI,CAAC,IAAI,CAAC3F,UAAU,CAACqF,OAAO,CAACO,IAAI,CAAC,CAACpF,GAAG,CAAEqF,EAAE,IAAK;MACpE,MAAM;QAAErG,KAAK;QAAEC,GAAG;QAAE4B;MAAK,CAAC,GAAG,IAAI,CAACrB,UAAU,CAACqF,OAAO,CAACO,IAAI,CAACC,EAAE,CAAC;MAC7D,OAAO;QAAErG,KAAK,EAAE,IAAI,CAAC4B,SAAS,CAAC5B,KAAK,CAAC;QAAEC,GAAG,EAAE,IAAI,CAAC2B,SAAS,CAAC3B,GAAG,CAAC;QAAE4B;MAAK,CAAC;IACzE,CAAC,CAAC;IACF1C,KAAK,CAAC+F,UAAU,CAAC9F,QAAQ,EAAE,IAAI,CAACO,KAAK,CAACQ,MAAM,EAAE0F,OAAO,CAAC;EACxD;EAEAjE,SAASA,CAACgF,IAAI,EAAE;IACd,OAAOC,IAAI,CAACC,KAAK,CAACF,IAAI,GAAG,IAAI,CAAC,GAAG,IAAI;EACvC;EAkIA1D,YAAYA,CAACF,CAAC,EAAE;IACd,MAAM+D,GAAG,GAAGC,QAAQ,CAAChE,CAAC,CAAC;IACvB,IAAIiE,KAAK,CAACF,GAAG,CAAC,EAAE,OAAO,GAAG;IAC1B,IAAI9D,IAAI,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG8D,GAAG,EAAEG,OAAO,CAAC,CAAC,CAAC;IACrC,IAAIjE,IAAI,GAAG,CAAC,EAAE,OAAO,GAAG;IACxB,IAAIA,IAAI,GAAG,GAAG,EAAE,OAAO,GAAG;IAC1B,OAAOA,IAAI;EACb;EAEAkE,MAAMA,CAAA,EAAG;IACP,MAAM;MAAEvH,SAAS;MAAEC,SAAS;MAAEC,OAAO;MAAEC,QAAQ;MAAEC,KAAK;MAAEC,GAAG;MAAEC;IAAK,CAAC,GAAG,IAAI,CAACP,KAAK;IAEhF,oBACEnB,KAAA,CAAA4I,aAAA;MAAKC,SAAS,EAAE,GAAGjI,QAAQ,YAAa;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACtCnJ,KAAA,CAAA4I,aAAA;MAAKf,EAAE,EAAC,MAAM;MAAAiB,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAAC,eACjBnJ,KAAA,CAAA4I,aAAA;MAAKf,EAAE,EAAC,eAAe;MAAAiB,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAAC,eAE1BnJ,KAAA,CAAA4I,aAAA;MAAKC,SAAS,EAAE,GAAGjI,QAAQ,YAAa;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACtCnJ,KAAA,CAAA4I,aAAA;MAAQC,SAAS,EAAE,GAAGjI,QAAQ,YAAa;MAACwI,OAAO,EAAE,IAAI,CAACpG,YAAa;MAAA8F,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACrEnJ,KAAA,CAAA4I,aAAA,CAACtI,UAAU;MAAAwI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CACP,CAAC,eACTnJ,KAAA,CAAA4I,aAAA;MAAQC,SAAS,EAAE,GAAGjI,QAAQ,YAAa;MAACwI,OAAO,EAAE,IAAI,CAACxG,SAAU;MAAAkG,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GACjE/H,SAAS,gBAAGpB,KAAA,CAAA4I,aAAA,CAACpI,SAAS;MAAAsI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAAC,gBAAGnJ,KAAA,CAAA4I,aAAA,CAACvI,QAAQ;MAAAyI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAClC,CAAC,eACTnJ,KAAA,CAAA4I,aAAA;MAAQC,SAAS,EAAE,GAAGjI,QAAQ,YAAa;MAACwI,OAAO,EAAE,IAAI,CAACnG,WAAY;MAAA6F,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACpEnJ,KAAA,CAAA4I,aAAA,CAACrI,eAAe;MAAAuI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CACZ,CAAC,eACTnJ,KAAA,CAAA4I,aAAA;MAAMC,SAAS,EAAE,GAAGjI,QAAQ,aAAc;MACpCyI,WAAW,EAAExG,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAClB,UAAU,EAAE;MAAI,CAAC,CAAE;MACpDyH,YAAY,EAAEzG,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAClB,UAAU,EAAE;MAAK,CAAC,CAAE;MAAAiH,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAC3D,qBACoB,eAAAnJ,KAAA,CAAA4I,aAAA,CAACnI,4BAA4B;MAAAqI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAC9C,CAAC,eACPnJ,KAAA,CAAA4I,aAAA;MAAMC,SAAS,EAAE,GAAGjI,QAAQ,gBAAiB;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBAC3CnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAM,iBAAqB,CAAC,eAC5BnJ,KAAA,CAAA4I,aAAA,CAAClI,WAAW;MACVmH,EAAE,EAAE,GAAGjH,QAAQ,YAAa;MAC5B2I,YAAY,EAAE,CAAE;MAChBC,GAAG,EAAE,CAAC,CAAE;MACRC,GAAG,EAAE,EAAG;MACRC,IAAI,EAAE,CAAE;MACRC,IAAI,EAAE,QAAS;MACfC,IAAI,EAAE,OAAQ;MACdC,SAAS,EAAEC,KAAK,IAAI,IAAI,CAACpF,YAAY,CAACoF,KAAK,CAAE;MAC7CC,QAAQ,EAAE,IAAI,CAACxF,QAAS;MAAAuE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CACzB,CACG,CACH,CAAC,eAINnJ,KAAA,CAAA4I,aAAA;MAAOC,SAAS,EAAE,GAAGjI,QAAQ,QAAS;MAACoJ,GAAG,EAAE,IAAI,CAAC5H,KAAK,CAAC6H,KAAM;MAACN,IAAI,EAAC,YAAY;MAAAb,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CACxE,CAAC,EAEN,IAAI,CAAChI,KAAK,CAACU,UAAU,iBAAK7B,KAAA,CAAA4I,aAAA;MAAKC,SAAS,EAAE,GAAGjI,QAAQ,SAAU;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBAC/DnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACAnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,SAAW,CAAC,eAChBnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,UAAY,CACd,CAAC,eACLnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,KAAO,CAAC,eACZnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,eAAiB,CACnB,CAAC,eACLnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,2BAA6B,CAAC,eAClCnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,0BAA4B,CAC9B,CAAC,eACLnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,OAAS,CAAC,eACdnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,kBAAoB,CACtB,CAAC,eACLnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,aAAe,CAAC,eACpBnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,sBAAwB,CAC1B,CAAC,eACLnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,aAAe,CAAC,eACpBnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAI,kBAAoB,CACtB,CACG,CACF,CACJ,CACJ,EAEC9H,SAAS,iBACTrB,KAAA,CAAA4I,aAAA;MAAMC,SAAS,EAAE,GAAGjI,QAAQ,OAAQ;MAACsJ,QAAQ,EAAE,IAAI,CAAC5F,gBAAiB;MAAAwE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACnEnJ,KAAA,CAAA4I,aAAA;MAAKC,SAAS,EAAE,GAAGjI,QAAQ,aAAc;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACvCnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAO,UAAe,CAAC,eACvBnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAOe,IAAI,EAAC,OAAO;MAACG,KAAK,EAAC,QAAQ;MAACK,OAAO,EAAE5I,QAAQ,KAAK,QAAS;MAACwI,QAAQ,EAAElH,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAExB,QAAQ,EAAEsB,CAAC,CAACuH,MAAM,CAACN;MAAM,CAAC,CAAE;MAAAhB,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAC,CAAC,eAChInJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAM,QAAY,CACb,CAAC,eACRnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACEnJ,KAAA,CAAA4I,aAAA;MAAOe,IAAI,EAAC,OAAO;MAACG,KAAK,EAAC,SAAS;MAACK,OAAO,EAAE5I,QAAQ,KAAK,SAAU;MAACwI,QAAQ,EAAElH,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAExB,QAAQ,EAAEsB,CAAC,CAACuH,MAAM,CAACN;MAAM,CAAC,CAAE;MAAAhB,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAC,CAAC,eAClInJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAM,SAAa,CACd,CACL,CACF,CACD,CAAC,eAENnJ,KAAA,CAAA4I,aAAA;MAAKC,SAAS,EAAE,GAAGjI,QAAQ,aAAc;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACvCnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAO,WAAgB,CAAC,eACxBnJ,KAAA,CAAA4I,aAAA;MAAOe,IAAI,EAAE,MAAO;MAACG,KAAK,EAAEtI,KAAM;MAACuI,QAAQ,EAAElH,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAEvB,KAAK,EAAEqB,CAAC,CAACuH,MAAM,CAACN;MAAM,CAAC,CAAE;MAAAhB,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAAC,eAC9FnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAM,KAAS,CAAC,eAChBnJ,KAAA,CAAA4I,aAAA;MAAOe,IAAI,EAAE,MAAO;MAACG,KAAK,EAAErI,GAAI;MAACsI,QAAQ,EAAElH,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAEtB,GAAG,EAAEoB,CAAC,CAACuH,MAAM,CAACN;MAAM,CAAC,CAAE;MAAAhB,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAE,CAAC,eAC1FnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAM,aAAW,EAAC,IAAI,CAAC/F,SAAS,CAAC3B,GAAG,GAAGD,KAAK,CAAQ,CACjD,CAAC,eAENxB,KAAA,CAAA4I,aAAA;MAAKC,SAAS,EAAE,GAAGjI,QAAQ,aAAc;MAAAkI,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,gBACvCnJ,KAAA,CAAA4I,aAAA;MAAAE,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAO,MAAW,CAAC,eAEnBnJ,KAAA,CAAA4I,aAAA;MAAUyB,IAAI,EAAC,GAAG;MAACP,KAAK,EAAEpI,IAAK;MACrBqI,QAAQ,EAAElH,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAAErB,IAAI,EAAEmB,CAAC,CAACuH,MAAM,CAACN;MAAM,CAAC,CAAE;MACvDQ,OAAO,EAAEzH,CAAC,IAAI,IAAI,CAACE,QAAQ,CAAC;QAACnB,WAAW,EAAE;MAAI,CAAC,CAAE;MACjD2I,MAAM,EAAE1H,CAAC,IAAI;QACX,IAAI,CAACE,QAAQ,CAAC;UAACnB,WAAW,EAAE;QAAK,CAAC,CAAC;QACnC;MACF,CAAE;MAAAkH,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,CAAC,CACV,CAAC,eAENnJ,KAAA,CAAA4I,aAAA;MAAQC,SAAS,EAAE,GAAGjI,QAAQ,aAAc;MAAC+I,IAAI,EAAC,QAAQ;MAAAb,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,MAEnD,CAAC,eACTnJ,KAAA,CAAA4I,aAAA;MAAQC,SAAS,EAAE,GAAGjI,QAAQ,oBAAqB;MAACwI,OAAO,EAAE,IAAI,CAAChF,kBAAmB;MAAA0E,MAAA;MAAAC,QAAA;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAA,GAAC,QAE9E,CACJ,CAEL,CAAC;EAEV;AACF","ignoreList":[]},"metadata":{},"sourceType":"module"}