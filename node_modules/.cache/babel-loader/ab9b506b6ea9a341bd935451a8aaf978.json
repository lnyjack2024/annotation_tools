{"ast":null,"code":"var _jsxFileName = \"/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/SidebarInstance.tsx\";\nimport React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport cx from 'classnames';\nimport { CaretDownOutlined, PlusCircleFilled } from '@ant-design/icons';\nimport CameraInstanceItemList from './CameraInstanceItemList';\nimport InstanceItemMenu from './InstanceItemMenu';\nimport InstanceItemReviewIcon from './InstanceItemReviewIcon';\nimport ShapeLabel from './ShapeLabel';\nimport store from '../../store/RootStore';\nconst SidebarInstance = observer(({\n  instance\n}) => {\n  const [hovered, setHovered] = useState(false);\n  const [menuVisible, setMenuVisible] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({\n    x: -1,\n    y: -1\n  });\n  const collapse = e => {\n    e.stopPropagation();\n    instance.setCollapsed(!instance.collapsed);\n  };\n  const {\n    currentCamera,\n    currentFrame,\n    isSingleCamera,\n    cameraNames\n  } = store.frame;\n  const isSingle = instance.isSingle && isSingleCamera;\n  const isHidden = instance.frameStatus[currentFrame] === undefined;\n  const isSelected = isSingle ? instance.selected : instance.selected && store.instance.selectedInstanceItems.filter(item => item.instance).length <= 0;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: `sidebar-category-instance-${instance.id}`,\n    className: \"sidebar-category-instance\",\n    onMouseEnter: () => setHovered(true),\n    onMouseLeave: () => setHovered(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx('sidebar-category-instance__label', {\n      single: isSingle,\n      hidden: isHidden,\n      selected: isSelected\n    }),\n    onMouseDown: () => {\n      if (!isSingle) {\n        store.instance.selectInstanceItem(null);\n      }\n      store.instance.selectInstance(instance, true);\n    },\n    onContextMenu: e => {\n      e.preventDefault();\n      store.instance.selectInstance(instance);\n      if (isSingle && !isHidden) {\n        setMenuPosition({\n          x: e.clientX,\n          y: e.clientY\n        });\n        setMenuVisible(true);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 7\n    }\n  }, isSingle ? /*#__PURE__*/React.createElement(ShapeLabel, {\n    item: Object.values(instance.items)[0],\n    camera: currentCamera,\n    label: instance.label,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }\n  }, instance.label), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar-category-action\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, !isSingle && /*#__PURE__*/React.createElement(CaretDownOutlined, {\n    className: \"sidebar-category-icon\",\n    style: {\n      transform: instance.collapsed ? 'rotate(270deg)' : ''\n    },\n    onClick: collapse,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }), !store.readonly && isSingle && isHidden && hovered && /*#__PURE__*/React.createElement(PlusCircleFilled, {\n    style: {\n      cursor: 'pointer'\n    },\n    onClick: () => store.addToCurrentFrame(Object.values(instance.items)[0]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }), !store.isLabeling && isSingle && !isHidden && /*#__PURE__*/React.createElement(InstanceItemReviewIcon, {\n    item: Object.values(instance.items)[0],\n    camera: currentCamera,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }))), !instance.collapsed && !isSingle && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, cameraNames.map((c, i) => /*#__PURE__*/React.createElement(CameraInstanceItemList, {\n    key: c,\n    instance: instance,\n    camera: c,\n    cameraIndex: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }))), isSingle && /*#__PURE__*/React.createElement(InstanceItemMenu, {\n    instanceItem: Object.values(instance.items)[0],\n    camera: currentCamera,\n    position: menuPosition,\n    visible: menuVisible,\n    onClose: () => setMenuVisible(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }));\n});\nexport default SidebarInstance;","map":{"version":3,"names":["React","useState","observer","cx","CaretDownOutlined","PlusCircleFilled","CameraInstanceItemList","InstanceItemMenu","InstanceItemReviewIcon","ShapeLabel","store","SidebarInstance","instance","hovered","setHovered","menuVisible","setMenuVisible","menuPosition","setMenuPosition","x","y","collapse","e","stopPropagation","setCollapsed","collapsed","currentCamera","currentFrame","isSingleCamera","cameraNames","frame","isSingle","isHidden","frameStatus","undefined","isSelected","selected","selectedInstanceItems","filter","item","length","createElement","id","className","onMouseEnter","onMouseLeave","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","single","hidden","onMouseDown","selectInstanceItem","selectInstance","onContextMenu","preventDefault","clientX","clientY","Object","values","items","camera","label","style","transform","onClick","readonly","cursor","addToCurrentFrame","isLabeling","map","c","i","key","cameraIndex","instanceItem","position","visible","onClose"],"sources":["/Users/qzheng/Documents/webroot/annotation_tools/src/components/video-tracking2/components/sidebar/SidebarInstance.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { observer } from 'mobx-react';\nimport cx from 'classnames';\nimport { CaretDownOutlined, PlusCircleFilled } from '@ant-design/icons';\nimport CameraInstanceItemList from './CameraInstanceItemList';\nimport InstanceItemMenu from './InstanceItemMenu';\nimport InstanceItemReviewIcon from './InstanceItemReviewIcon';\nimport ShapeLabel from './ShapeLabel';\nimport Instance from '../../model/Instance';\nimport store from '../../store/RootStore';\n\ninterface SidebarInstanceProps {\n  instance: Instance;\n}\n\nconst SidebarInstance = observer(({ instance }: SidebarInstanceProps) => {\n  const [hovered, setHovered] = useState(false);\n  const [menuVisible, setMenuVisible] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({ x: -1, y: -1 });\n\n  const collapse = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    instance.setCollapsed(!instance.collapsed);\n  };\n\n  const { currentCamera, currentFrame, isSingleCamera, cameraNames } = store.frame;\n  const isSingle = instance.isSingle && isSingleCamera;\n  const isHidden = instance.frameStatus[currentFrame] === undefined;\n  const isSelected = isSingle ? instance.selected : instance.selected && store.instance.selectedInstanceItems.filter((item) => item.instance).length <= 0;\n  return (\n    <div\n      id={`sidebar-category-instance-${instance.id}`}\n      className=\"sidebar-category-instance\"\n      onMouseEnter={() => setHovered(true)}\n      onMouseLeave={() => setHovered(false)}\n    >\n      <div\n        className={cx('sidebar-category-instance__label', {\n          single: isSingle,\n          hidden: isHidden,\n          selected: isSelected,\n        })}\n        onMouseDown={() => {\n          if (!isSingle) {\n            store.instance.selectInstanceItem(null);\n          }\n          store.instance.selectInstance(instance, true);\n        }}\n        onContextMenu={(e) => {\n          e.preventDefault();\n          store.instance.selectInstance(instance);\n          if (isSingle && !isHidden) {\n            setMenuPosition({ x: e.clientX, y: e.clientY });\n            setMenuVisible(true);\n          }\n        }}\n      >\n        {isSingle ? (\n          <ShapeLabel item={Object.values(instance.items)[0]} camera={currentCamera} label={instance.label} />\n        ) : <div>{instance.label}</div>}\n        <div className=\"sidebar-category-action\">\n          {!isSingle && (\n            <CaretDownOutlined\n              className=\"sidebar-category-icon\"\n              style={{\n                transform: instance.collapsed ? 'rotate(270deg)' : '',\n              }}\n              onClick={collapse}\n            />\n          )}\n          {!store.readonly && isSingle && isHidden && hovered && (\n            <PlusCircleFilled\n              style={{ cursor: 'pointer' }}\n              onClick={() => store.addToCurrentFrame(Object.values(instance.items)[0])}\n            />\n          )}\n          {!store.isLabeling && isSingle && !isHidden && (\n            <InstanceItemReviewIcon item={Object.values(instance.items)[0]} camera={currentCamera} />\n          )}\n        </div>\n      </div>\n      {!instance.collapsed && !isSingle && (\n        <div>\n          {cameraNames.map((c, i) => (\n            <CameraInstanceItemList key={c} instance={instance} camera={c} cameraIndex={i} />\n          ))}\n        </div>\n      )}\n      {isSingle && (\n        <InstanceItemMenu\n          instanceItem={Object.values(instance.items)[0]}\n          camera={currentCamera}\n          position={menuPosition}\n          visible={menuVisible}\n          onClose={() => setMenuVisible(false)}\n        />\n      )}\n    </div>\n  );\n});\n\nexport default SidebarInstance;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}